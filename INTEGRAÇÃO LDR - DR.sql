--- 1o
--- REGIOES DE VENDA
INSERT INTO [REGIOES_VENDA]
           ([REGIAO]
           ,[PESO_DA_REGIAO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[MACRO_REGIAO]
           ,[COD_REGIAO_VENDA]
           ,[NIVEL_REGIAO]
           ,[INATIVO]
           ,[COD_TIPO_REGIAO_VENDA])
SELECT [REGIAO]
      ,[PESO_DA_REGIAO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[MACRO_REGIAO]
      ,CAST('100069' AS INT)+ ROW_NUMBER() OVER(ORDER BY COD_REGIAO_VENDA) AS Row
      ,[NIVEL_REGIAO]
      ,[INATIVO]
      ,[COD_TIPO_REGIAO_VENDA]
FROM LDR.DRVAREJO.DBO.REGIOES_VENDA A
WHERE INATIVO=0 AND NOT EXISTS (SELECT * FROM REGIOES_VENDA WHERE REGIAO=A.REGIAO)           


--- 2o
--- CLIENTE_ATAC_BLOQ
INSERT INTO CLIENTE_ATAC_BLOQ
SELECT [TIPO_BLOQUEIO]
      ,[BLOQUEIA_CREDITO]
      ,[EXCLUSIVO_LINX]
      ,[DATA_PARA_TRANSFERENCIA]
FROM LDR.DRVAREJO.DBO.CLIENTE_ATAC_BLOQ A
WHERE NOT EXISTS(SELECT * FROM CLIENTE_ATAC_BLOQ WHERE TIPO_BLOQUEIO=A.TIPO_BLOQUEIO )


--- 3o 
--- CLIENTE_ATAC_PONT
INSERT INTO CLIENTE_ATAC_PONT
SELECT [PONTUALIDADE]
      ,[PESO_PONTUALIDADE]
      ,[MAIOR_ATRASO]
      ,[FREQUENCIA]
      ,[DATA_PARA_TRANSFERENCIA]
FROM LDR.DRVAREJO.DBO.CLIENTE_ATAC_PONT A
WHERE NOT EXISTS (SELECT * FROM CLIENTE_ATAC_PONT WHERE PONTUALIDADE=A.PONTUALIDADE)

--- 4o
--- CLIENTE_CONCEITOS
INSERT INTO CLIENTE_CONCEITOS
SELECT [CONCEITO]
      ,[PESO_DO_CONCEITO]
      ,[DATA_PARA_TRANSFERENCIA]
FROM LDR.DRVAREJO.DBO.CLIENTE_CONCEITOS A
WHERE NOT EXISTS(SELECT * FROM CLIENTE_CONCEITOS WHERE CONCEITO=A.CONCEITO )


--- 5o
--- CLIENTE_ATAC_TIPOS
INSERT INTO CLIENTE_ATAC_TIPOS
SELECT [TIPO]
      ,[PESO_DO_TIPO]
      ,[DESCONTO_MARGEM_CONTRIBUICAO]
      ,[DATA_PARA_TRANSFERENCIA]
  FROM LDR.DRVAREJO.DBO.CLIENTE_ATAC_TIPOS A
WHERE NOT EXISTS(SELECT * FROM CLIENTE_ATAC_TIPOS WHERE TIPO=A.TIPO)  

  
--- 6o 
--- TIPOS REPRESENTANTES
INSERT INTO REPRE_TIPOS
SELECT [TIPO]
      ,[DATA_PARA_TRANSFERENCIA]
FROM LDR.DRVAREJO.DBO.REPRE_TIPOS A
WHERE NOT EXISTS (SELECT TIPO FROM REPRE_TIPOS WHERE TIPO=A.TIPO)

--- 7o 
--- CADASTRO_CLI_FOR ( REPRESENTANTES )
INSERT INTO CADASTRO_CLI_FOR
           ([NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,[CONTA_CONTABIL]
           ,[CLIFOR]
           ,[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,[INATIVO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,[COD_CLIFOR]
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,[CLI_FOR])
SELECT [NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,A.[CONTA_CONTABIL]
           ,CAST('400051' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row
           ,A.[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,A.[INATIVO]
           ,A.[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,A.[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,CAST('400051' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,A.[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,CAST('400051' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row
FROM LDR.DRVAREJO.DBO.[CADASTRO_CLI_FOR] A
JOIN LDR.DRVAREJO.DBO.[REPRESENTANTES] B ON B.REPRESENTANTE = A.NOME_CLIFOR
WHERE IND_REPRESENTANTE=1 AND B.INATIVO=0 AND A.INATIVO=0  
AND NOT EXISTS (SELECT * FROM REPRESENTANTES WHERE REPRESENTANTE=B.REPRESENTANTE) 
AND NOT EXISTS (SELECT * FROM CADASTRO_CLI_FOR WHERE NOME_CLIFOR=A.NOME_CLIFOR)
AND B.REPRESENTANTE<>'DENI RICARDO MONCAY CECHI'

--- 8o 
--- GERENTES
INSERT INTO [REPRESENTANTES]
           ([REPRESENTANTE]
           ,[GERENTE]
           ,[REGIAO]
           ,[TIPO]
           ,[COMISSAO]
           ,[PORCENTAGEM_ACERTO]
           ,[ACERTO_PGTO]
           ,[INATIVO]
           ,[MARGEM_NEGOCIACAO]
           ,[DESCONTO_COMISSAO]
           ,[CGC_CPF]
           ,[CLIFOR]
           ,[SEQUENCIAL]
           ,[COMISSAO_GERENTE]
           ,[IRRF]
           ,[COD_REPRESENTANTE]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[CONTA_CONTABIL]
           ,[CTB_CONTA_CONTABIL])
SELECT A.REPRESENTANTE
           ,'FABRICA'
           ,A.REGIAO
           ,A.TIPO
           ,A.COMISSAO
           ,A.PORCENTAGEM_ACERTO
           ,A.ACERTO_PGTO           
           ,A.INATIVO           
           ,A.MARGEM_NEGOCIACAO
           ,A.DESCONTO_COMISSAO
           ,A.CGC_CPF
           ,B.CLIFOR
           ,A.SEQUENCIAL
           ,A.COMISSAO_GERENTE
           ,A.IRRF
           ,B.CLIFOR
           ,A.DATA_PARA_TRANSFERENCIA
           ,A.CONTA_CONTABIL
           ,'1125001003'--A.CTB_CONTA_CONTABIL
FROM LDR.DRVAREJO.DBO.REPRESENTANTES A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.REPRESENTANTE
WHERE A.INATIVO=0
AND NOT EXISTS (SELECT * FROM REPRESENTANTES WHERE REPRESENTANTE=A.REPRESENTANTE) 
AND A.REPRESENTANTE IN(
'BRINDES - MERCHANDISING',  
'DENI RICARDO MONCAY CECHI',
'JOSE ANTONIO SARMENTO',    
'JOSE MARIO',               
'MARCUS CARIOCA',           
'SARMENTO - DR',            
'SERGIO PIRES',             
'SERGIO PIRES - DR',        
'VENDA DIRETA',            
'VENDA DIRETA - SERGIO PIR',
'VENDA DIRETA EXPORTACAO',
'VENDA DIRETA NACIONAL',    
'VENDA INTERNA')

--- 9o
--- ALTERAR REPRESENTANTES PARA GERENTES
UPDATE REPRESENTANTES
SET GERENTE=REPRESENTANTE
WHERE REPRESENTANTE IN(
'BRINDES - MERCHANDISING',  
'DENI RICARDO MONCAY CECHI',
'JOSE ANTONIO SARMENTO',    
'JOSE MARIO',               
'MARCUS CARIOCA',           
'SARMENTO - DR',            
'SERGIO PIRES',             
'SERGIO PIRES - DR',        
'VENDA DIRETA',            
'VENDA DIRETA - SERGIO PIR',
'VENDA DIRETA EXPORTACAO',
'VENDA DIRETA NACIONAL',    
'VENDA INTERNA')

--- 10o
--- REPRESENTANTES
INSERT INTO [REPRESENTANTES]
           ([REPRESENTANTE]
           ,[GERENTE]
           ,[REGIAO]
           ,[TIPO]
           ,[COMISSAO]
           ,[PORCENTAGEM_ACERTO]
           ,[ACERTO_PGTO]
           ,[INATIVO]
           ,[MARGEM_NEGOCIACAO]
           ,[DESCONTO_COMISSAO]
           ,[CGC_CPF]
           ,[CLIFOR]
           ,[SEQUENCIAL]
           ,[COMISSAO_GERENTE]
           ,[IRRF]
           ,[COD_REPRESENTANTE]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[CONTA_CONTABIL]
           ,[CTB_CONTA_CONTABIL])
SELECT A.REPRESENTANTE
           ,A.GERENTE
           ,A.REGIAO
           ,A.TIPO
           ,A.COMISSAO
           ,A.PORCENTAGEM_ACERTO
           ,A.ACERTO_PGTO           
           ,A.INATIVO           
           ,A.MARGEM_NEGOCIACAO
           ,A.DESCONTO_COMISSAO
           ,A.CGC_CPF
           ,B.CLIFOR
           ,A.SEQUENCIAL
           ,A.COMISSAO_GERENTE
           ,A.IRRF
           ,B.CLIFOR
           ,A.DATA_PARA_TRANSFERENCIA
           ,A.CONTA_CONTABIL
           ,'1125001003'--A.CTB_CONTA_CONTABIL
FROM LDR.DRVAREJO.DBO.REPRESENTANTES A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.REPRESENTANTE
WHERE A.INATIVO=0
AND not EXISTS (SELECT * FROM REPRESENTANTES WHERE REPRESENTANTE=A.REPRESENTANTE) 
AND A.GERENTE 
IN('BRINDES - MERCHANDISING',  
'DENI RICARDO MONCAY CECHI',
'JOSE ANTONIO SARMENTO',    
'JOSE MARIO',               
'MARCUS CARIOCA',           
'SARMENTO - DR',            
'SERGIO PIRES',             
'SERGIO PIRES - DR',        
'VENDA DIRETA',            
'VENDA DIRETA - SERGIO PIR',
'VENDA DIRETA EXPORTACAO',
'VENDA DIRETA NACIONAL',    
'VENDA INTERNA')


INSERT INTO [REPRESENTANTES]
           ([REPRESENTANTE]
           ,[GERENTE]
           ,[REGIAO]
           ,[TIPO]
           ,[COMISSAO]
           ,[PORCENTAGEM_ACERTO]
           ,[ACERTO_PGTO]
           ,[INATIVO]
           ,[MARGEM_NEGOCIACAO]
           ,[DESCONTO_COMISSAO]
           ,[CGC_CPF]
           ,[CLIFOR]
           ,[SEQUENCIAL]
           ,[COMISSAO_GERENTE]
           ,[IRRF]
           ,[COD_REPRESENTANTE]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[CONTA_CONTABIL]
           ,[CTB_CONTA_CONTABIL])
SELECT A.REPRESENTANTE
           ,GERENTE='FABRICA'
           ,A.REGIAO
           ,A.TIPO
           ,A.COMISSAO
           ,A.PORCENTAGEM_ACERTO
           ,A.ACERTO_PGTO           
           ,A.INATIVO           
           ,A.MARGEM_NEGOCIACAO
           ,A.DESCONTO_COMISSAO
           ,A.CGC_CPF
           ,B.CLIFOR
           ,A.SEQUENCIAL
           ,A.COMISSAO_GERENTE
           ,A.IRRF
           ,B.CLIFOR
           ,A.DATA_PARA_TRANSFERENCIA
           ,A.CONTA_CONTABIL
           ,'1125001003'--A.CTB_CONTA_CONTABIL
FROM LDR.DRVAREJO.DBO.REPRESENTANTES A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.REPRESENTANTE
WHERE a.representante='SERGIO BOLIVAR           '


--- 11o
--- FORNECEDOR TIPO
INSERT INTO FORNECEDOR_TIPOS
SELECT [TIPO]
      ,[DATA_PARA_TRANSFERENCIA]
FROM LDR.DRVAREJO.DBO.FORNECEDOR_TIPOS A
WHERE NOT EXISTS(SELECT * FROM FORNECEDOR_TIPOS WHERE TIPO=A.TIPO)

--- 12o
--- FORNECEDOR SUBTIPO
INSERT INTO FORNECEDOR_SUBTIPO
SELECT [SUBTIPO_FORNECEDOR]
      ,[TIPO]
      ,[DATA_PARA_TRANSFERENCIA]
  FROM LDR.DRVAREJO.DBO.FORNECEDOR_SUBTIPO A
WHERE NOT EXISTS(SELECT * FROM FORNECEDOR_SUBTIPO WHERE SUBTIPO_FORNECEDOR=A.SUBTIPO_FORNECEDOR AND TIPO=A.TIPO) AND 
SUBTIPO_FORNECEDOR='REPRESENTAÇÃO' AND TIPO='SERVICOS'

--- 13o
--- FORNECEDORES
INSERT INTO FORNECEDORES
SELECT [FORNECEDOR]
      ,[CENTRO_CUSTO]
      ,[TIPO]
      ,[SUBTIPO_FORNECEDOR]
      ,B.CLIFOR
      ,B.CLIFOR
      ,[CONDICAO_PGTO]
      ,A.[CGC_CPF]
      ,[FORNECE_MATERIAIS]
      ,[FORNECE_PROD_ACAB]
      ,[FORNECE_MAT_CONSUMO]
      ,[BENEFICIADOR]
      ,[FORNECE_OUTROS]
      ,[MOEDA]
      ,A.[INATIVO]
      ,A.[DATA_PARA_TRANSFERENCIA] 
      ,[LICENCIADO]
      ,[LICENDIADO_ROYALTIES]
      ,A.[CONTA_CONTABIL]
      ,'2125001'--[CTB_CONTA_CONTABIL]
      ,[LICENCIADO_ROYALTIES]
      ,[CQFOR_CLASSIFICACAO]
      ,[INDICA_CQFOR]
      ,[DIAS_DESCONTO_VENCIMENTO]
      ,[DESCONTO_VENCIMENTO]
      ,[VALOR_MINIMO_PEDIDO]
      ,[INDICA_TRANSPORTADORA]
      ,[LX_METODO_PAGAMENTO]
  FROM LDR.DRVAREJO.DBO.[FORNECEDORES] A
  JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.FORNECEDOR
WHERE EXISTS(SELECT * FROM REPRESENTANTES WHERE REPRESENTANTE=A.FORNECEDOR) 
AND A.FORNECEDOR <> 'DENI RICARDO MONCAY CECHI'  


--- 14o
--- FORMA DE PAGTO
INSERT INTO FORMA_PGTO
SELECT [CONDICAO_PGTO]
      ,[DESC_COND_PGTO]
      ,[TIPO_CONDICAO]
      ,[NUMERO_PARCELAS]
      ,[DESCONTO]
      ,[ENCARGO]
      ,[DESCONTO_ITEM]
      ,[DESCONTO_FATURAMENTO]
      ,[ENCARGO_FATURAMENTO]
      ,[DESCONTO_ITEM_FATURAMENTO]
      ,[DIAS_DESCONTO_VENCIMENTO]
      ,[DESCONTO_VENCIMENTO]
      ,[EXCLUSIVO_LINX]
      ,[CONDICAO_ESPECIAL]
      ,[VALOR_MINIMO_PARCELAMENTO]
      ,[VALOR_MAXIMO_PARCELAMENTO]
      ,[NOVO_PARCELAMENTO_MINIMO]
      ,[NOVO_PARCELAMENTO_MAXIMO]
      ,[INCIDE_SOBRE_PRECO]
      ,[PORC_ANTECIPACAO]
      ,[INDICA_PARCELAS_IGUAIS]
      ,[PARCELA_ARRED_MENOR]
      ,[PARCELA_ARRED_MAIOR]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[COND_PGTO_ENTRADA]
      ,[LX_TIPO_DOCUMENTO]
      ,[INDICA_NAO_ENVIO_BORDERO]
FROM LDR.DRVAREJO.DBO.FORMA_PGTO A
WHERE NOT EXISTS (SELECT * FROM FORMA_PGTO WHERE CONDICAO_PGTO=A.CONDICAO_PGTO)

--- 15o
--- FORMA_PGTO_PARCELA
INSERT INTO FORMA_PGTO_PARCELA
SELECT [CONDICAO_PGTO]
      ,[PARCELA]
      ,[DIAS_PARCELA]
      ,[PORCENTAGEM]
      ,[LX_TIPO_DOCUMENTO]
  FROM LDR.DRVAREJO.DBO.[FORMA_PGTO_PARCELA] A
WHERE NOT EXISTS(SELECT * FROM [FORMA_PGTO_PARCELA] WHERE CONDICAO_PGTO=A.CONDICAO_PGTO AND PARCELA=A.PARCELA)  

--- 16o
--- CLIENTES ATACADO ( REPRESENTANTES/GERENTES )
INSERT INTO CLIENTES_ATACADO
SELECT [CLIENTE_ATACADO]
      ,B.[CLIFOR]
      ,[CONDICAO_PGTO]
      ,[REGIAO]
      ,[MATRIZ_CLIENTE]
      ,[FILIAL]
      ,[PONTUALIDADE]
      ,'NOSSO CARRO'--[TRANSPORTADORA]
      ,[CONCEITO]
      ,[TIPO]
      ,[TIPO_BLOQUEIO]
      ,A.[CGC_CPF]
      ,B.[CLIFOR]
      ,[FRETE_A_PAGAR]
      ,[PRIORIDADE]
      ,[SEM_CREDITO]
      ,[LIMITE_CREDITO]
      ,[BLOQUEIO_EXPEDICAO]
      ,[BLOQUEIO_FATURAMENTO]
      ,[ACEITA_JUNTAR_PED]
      ,[BLOQUEIO_PEDIDOS]
      ,[NUMERO_PEDIDOS]
      ,[DATA_MAIOR_PEDIDO]
      ,[MAIOR_PEDIDO]
      ,[DATA_MAIOR_QTDE_PEDIDO]
      ,[MAIOR_QTDE_PEDIDO]
      ,[MAIOR_SALDO]
      ,[DATA_MAIOR_SALDO]
      ,[NUMERO_ATRASOS]
      ,[MAIOR_ATRASO]
      ,[PGTOS_CARTORIO]
      ,[NUMERO_DEVOLUCOES]
      ,[DATA_MAIOR_DEVOLUCAO]
      ,[MAIOR_DEVOLUCAO]
      ,[DATA_MAIOR_QTDE_DEV]
      ,[MAIOR_QTDE_DEV]
      ,[NUMERO_PRORROGACOES]
      ,[MAIOR_PRORROGACAO]
      ,[DESCONTO_FATURAMENTO]
      ,[OBS]
      ,A.[INATIVO]
      ,[MOEDA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[INDICA_FRANQUIA]
      ,'01'--[CODIGO_TAB_PRECO]
      ,[FATOR_CUSTO_FRANQUIA]
      ,[DESCONTO_PEDIDO_VENDA]
      ,[SEGURO_NUMERO_CONTRATO]
      ,[SEGURO_NUMERO_CLIENTE]
      ,[SEGURO_VALIDADE]
      ,A.[CONTA_CONTABIL] 
      ,A.[MESES_SEM_VENCIMENTO]
      ,[EXPEDICAO_COMPLETO_PEDIDO]
      ,[EXPEDICAO_COMPLETO_PACK]
      ,[EXPEDICAO_COMPLETO_TAMANHOS]
      ,[EXPEDICAO_COMPLETO_COR]
      ,[EXPEDICAO_COMPLETO_COORDENADO]
      ,[EXPEDICAO_COMPLETO_CARTELA]
      ,[EXPEDICAO_PORCENTAGEM_MAIOR]
      ,[EXPEDICAO_PORCENTAGEM_MINIMA]
      ,[EXPEDICAO_PORCENTAGEM_TIPO]
      ,[EXPEDICAO_VALOR_MAXIMO]
      ,[CONTA_CONTABIL_ANTECIPACAO]
      ,'NOSSO CARRO'--[TRANSP_REDESPACHO]
      ,[CONTA_CONTABIL_VENDAS_TIPO]
      ,'NOSSO CARRO'--[TRANSPORTADORA2]
      ,'1125001001'--[CTB_CONTA_CONTABIL]
      ,[EXPEDICAO_COMPLETO_FAIXAS]
      ,[DESCONTO_BRUTO]
      ,[DESCONTO_BRUTO_1]
      ,[DESCONTO_BRUTO_2]
      ,[DESCONTO_BRUTO_3]
      ,[DESCONTO_BRUTO_4]
      ,[DESCONTO_SOBRE_1]
      ,[DESCONTO_SOBRE_2]
      ,[DESCONTO_SOBRE_3]
      ,[DESCONTO_SOBRE_4]
      ,[EXPEDICAO_PORC_ADEQUACAO]
      ,[EXPEDICAO_QTDE_ADEQUACAO]
      ,[EXPEDICAO_ADEQUACAO_COR]
      ,[EXPEDICAO_ADEQUACAO_TAMANHO]
      ,[MULTI_DESCONTO_ACUMULAR]
      ,[INDICADOR_VENDA]
      ,[DATA_MAIOR_ATRASO]
      ,[MAIOR_VALOR_FATURADO]
      ,[DATA_MAIOR_VALOR_FATURADO]
      ,[DT_ULTIMA_VENDA]
      ,[DT_PENULTIMA_VENDA]
      ,[DT_ANTEPENULTIMA_VENDA]
      ,[DT_PRIMEIRA_VENDA]
      ,[CONTEUDO_XPED_NFE]
  FROM LDR.DRVAREJO.DBO.[CLIENTES_ATACADO] A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.CLIENTE_ATACADO  
WHERE EXISTS(SELECT * FROM REPRESENTANTES WHERE REPRESENTANTE=A.CLIENTE_ATACADO) AND B.IND_REPRESENTANTE=1 AND A.CLIENTE_ATACADO<>'DENI RICARDO MONCAY CECHI'

--- 17o
--- CLIENTE REPRE
INSERT INTO CLIENTE_REPRE
SELECT A.[REPRESENTANTE]
      ,A.[CLIENTE_ATACADO]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,A.[COMISSAO]
      ,A.[REPRESENTANTE_PRINCIPAL]
  FROM LDR.DRVAREJO.DBO.[CLIENTE_REPRE] A
JOIN CLIENTES_ATACADO B ON B.CLIENTE_ATACADO=A.CLIENTE_ATACADO 
JOIN REPRESENTANTES C ON C.REPRESENTANTE=A.REPRESENTANTE
WHERE NOT EXISTS(SELECT * FROM CLIENTE_REPRE WHERE REPRESENTANTE=A.REPRESENTANTE AND CLIENTE_ATACADO=A.CLIENTE_ATACADO)  
AND B.CTB_CONTA_CONTABIL='1125001001' AND B.INATIVO=0


--- 18o
--- CLIENTES ATACADO QUE COMPRARAM NOS ULTIMOS 3 ANOS
--- CADASTRO_CLI_FOR 
INSERT INTO CADASTRO_CLI_FOR
           ([NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,[CONTA_CONTABIL]
           ,[CLIFOR]
           ,[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,[INATIVO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,[COD_CLIFOR]
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,[CLI_FOR])
SELECT A.[NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,A.[CONTA_CONTABIL]
           ,CAST('509678' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row1
           ,A.[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,A.[INATIVO]
           ,A.[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,A.[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,CAST('509678' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row2
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,A.[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,CAST('509678' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row3
FROM LDR.DRVAREJO.DBO.[CADASTRO_CLI_FOR] A
JOIN (
SELECT A.CLIFOR,A.NOME_CLIFOR,
DATA_ULTIMA_COMPRA=(SELECT MAX(EMISSAO) FROM LDR.DRVAREJO.DBO.VENDAS B WHERE B.CLIENTE_ATACADO=A.NOME_CLIFOR) 
FROM LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR A
JOIN LDR.DRVAREJO.DBO.CLIENTES_ATACADO C ON C.CLIENTE_ATACADO=A.NOME_CLIFOR
--WHERE A.INATIVO=0 AND C.INATIVO=0 AND A.PJ_PF='1'
GROUP BY A.CLIFOR,A.NOME_CLIFOR
HAVING DATEDIFF(DD,(SELECT MAX(EMISSAO) FROM LDR.DRVAREJO.DBO.VENDAS B WHERE B.CLIENTE_ATACADO=A.NOME_CLIFOR),GETDATE())<=1095 
) B ON B.NOME_CLIFOR=A.NOME_CLIFOR
WHERE A.CLIFOR='030877' NOT EXISTS (SELECT * FROM CADASTRO_CLI_FOR WHERE NOME_CLIFOR=A.NOME_CLIFOR) 

SELECT * FROM SEQUENCIAIS
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'

UPDATE SEQUENCIAIS
SET SEQUENCIA='509679'
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'


--- 19o
--- CLIENTES ATACADO
INSERT INTO CLIENTES_ATACADO
SELECT [CLIENTE_ATACADO]
      ,B.[CLIFOR]
      ,[CONDICAO_PGTO]
      ,[REGIAO]
      ,[CLIENTE_ATACADO]
      ,[FILIAL]
      ,[PONTUALIDADE]
      ,'NOSSO CARRO'--[TRANSPORTADORA]
      ,[CONCEITO]
      ,[TIPO]
      ,[TIPO_BLOQUEIO]
      ,A.[CGC_CPF]
      ,B.[CLIFOR]
      ,[FRETE_A_PAGAR]
      ,[PRIORIDADE]
      ,[SEM_CREDITO]
      ,[LIMITE_CREDITO]
      ,[BLOQUEIO_EXPEDICAO]
      ,[BLOQUEIO_FATURAMENTO]
      ,[ACEITA_JUNTAR_PED]
      ,[BLOQUEIO_PEDIDOS]
      ,[NUMERO_PEDIDOS]
      ,[DATA_MAIOR_PEDIDO]
      ,[MAIOR_PEDIDO]
      ,[DATA_MAIOR_QTDE_PEDIDO]
      ,[MAIOR_QTDE_PEDIDO]
      ,[MAIOR_SALDO]
      ,[DATA_MAIOR_SALDO]
      ,[NUMERO_ATRASOS]
      ,[MAIOR_ATRASO]
      ,[PGTOS_CARTORIO]
      ,[NUMERO_DEVOLUCOES]
      ,[DATA_MAIOR_DEVOLUCAO]
      ,[MAIOR_DEVOLUCAO]
      ,[DATA_MAIOR_QTDE_DEV]
      ,[MAIOR_QTDE_DEV]
      ,[NUMERO_PRORROGACOES]
      ,[MAIOR_PRORROGACAO]
      ,[DESCONTO_FATURAMENTO]
      ,[OBS]
      ,A.[INATIVO]
      ,[MOEDA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[INDICA_FRANQUIA]
      ,'01'--[CODIGO_TAB_PRECO]
      ,[FATOR_CUSTO_FRANQUIA]
      ,[DESCONTO_PEDIDO_VENDA]
      ,[SEGURO_NUMERO_CONTRATO]
      ,[SEGURO_NUMERO_CLIENTE]
      ,[SEGURO_VALIDADE]
      ,A.[CONTA_CONTABIL] 
      ,A.[MESES_SEM_VENCIMENTO]
      ,[EXPEDICAO_COMPLETO_PEDIDO]
      ,[EXPEDICAO_COMPLETO_PACK]
      ,[EXPEDICAO_COMPLETO_TAMANHOS]
      ,[EXPEDICAO_COMPLETO_COR]
      ,[EXPEDICAO_COMPLETO_COORDENADO]
      ,[EXPEDICAO_COMPLETO_CARTELA]
      ,[EXPEDICAO_PORCENTAGEM_MAIOR]
      ,[EXPEDICAO_PORCENTAGEM_MINIMA]
      ,[EXPEDICAO_PORCENTAGEM_TIPO]
      ,[EXPEDICAO_VALOR_MAXIMO]
      ,[CONTA_CONTABIL_ANTECIPACAO]
      ,'NOSSO CARRO'--[TRANSP_REDESPACHO]
      ,[CONTA_CONTABIL_VENDAS_TIPO]
      ,'NOSSO CARRO'--[TRANSPORTADORA2]
      ,'1125001001'--[CTB_CONTA_CONTABIL]
      ,[EXPEDICAO_COMPLETO_FAIXAS]
      ,[DESCONTO_BRUTO]
      ,[DESCONTO_BRUTO_1]
      ,[DESCONTO_BRUTO_2]
      ,[DESCONTO_BRUTO_3]
      ,[DESCONTO_BRUTO_4]
      ,[DESCONTO_SOBRE_1]
      ,[DESCONTO_SOBRE_2]
      ,[DESCONTO_SOBRE_3]
      ,[DESCONTO_SOBRE_4]
      ,[EXPEDICAO_PORC_ADEQUACAO]
      ,[EXPEDICAO_QTDE_ADEQUACAO]
      ,[EXPEDICAO_ADEQUACAO_COR]
      ,[EXPEDICAO_ADEQUACAO_TAMANHO]
      ,[MULTI_DESCONTO_ACUMULAR]
      ,[INDICADOR_VENDA]
      ,[DATA_MAIOR_ATRASO]
      ,[MAIOR_VALOR_FATURADO]
      ,[DATA_MAIOR_VALOR_FATURADO]
      ,[DT_ULTIMA_VENDA]
      ,[DT_PENULTIMA_VENDA]
      ,[DT_ANTEPENULTIMA_VENDA]
      ,[DT_PRIMEIRA_VENDA]
      ,[CONTEUDO_XPED_NFE]
  FROM LDR.DRVAREJO.DBO.[CLIENTES_ATACADO] A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.CLIENTE_ATACADO  
WHERE NOT EXISTS(SELECT * FROM CLIENTES_ATACADO WHERE CLIENTE_ATACADO=A.CLIENTE_ATACADO) AND B.INDICA_CLIENTE=1 AND A.CLIENTE_ATACADO<>'DENI RICARDO MONCAY CECHI' AND A.CLIENTE_ATACADO<>''


--- 20o
--- CLIENTE REPRE 
INSERT INTO CLIENTE_REPRE
SELECT A.[REPRESENTANTE]
      ,A.[CLIENTE_ATACADO]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,A.[COMISSAO]
      ,A.[REPRESENTANTE_PRINCIPAL]
  FROM LDR.DRVAREJO.DBO.[CLIENTE_REPRE] A
JOIN CLIENTES_ATACADO B ON B.CLIENTE_ATACADO=A.CLIENTE_ATACADO 
JOIN REPRESENTANTES C ON C.REPRESENTANTE=A.REPRESENTANTE
WHERE NOT EXISTS(SELECT * FROM CLIENTE_REPRE WHERE REPRESENTANTE=A.REPRESENTANTE AND CLIENTE_ATACADO=A.CLIENTE_ATACADO)  
AND B.CTB_CONTA_CONTABIL='1125001001' AND B.INATIVO=0


-------------------------------- BALCONISTAS --------------------------------------
SELECT * FROM DRLINGERIE.DBO.SEQUENCIAIS
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'

--- 21o
--- CLIENTES BANCONISTAS  
--- CADASTRO_CLI_FOR 
INSERT INTO CADASTRO_CLI_FOR
           ([NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,[CONTA_CONTABIL]
           ,[CLIFOR]
           ,[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,[INATIVO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,[COD_CLIFOR]
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,[CLI_FOR])
SELECT A.[NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,A.[CONTA_CONTABIL]
           ,CAST('507963' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row1
           ,A.[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,A.[INATIVO]
           ,A.[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,A.[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,CAST('507963' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row2
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,A.[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,CAST('507963' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row3
FROM LDR.DRVAREJO.DBO.[CADASTRO_CLI_FOR] A
JOIN (
SELECT A.CLIFOR,A.NOME_CLIFOR,
DATA_ULTIMA_COMPRA=(SELECT MAX(EMISSAO) FROM LDR.DRVAREJO.DBO.VENDAS B WHERE B.CLIENTE_ATACADO=A.NOME_CLIFOR) 
FROM LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR A
JOIN LDR.DRVAREJO.DBO.CLIENTES_ATACADO C ON C.CLIENTE_ATACADO=A.NOME_CLIFOR
WHERE A.INATIVO=0 AND C.INATIVO=0 AND A.PJ_PF='0' AND C.TIPO = 'BALCONISTA'
GROUP BY A.CLIFOR,A.NOME_CLIFOR
HAVING DATEDIFF(DD,(SELECT MAX(EMISSAO) FROM LDR.DRVAREJO.DBO.VENDAS B WHERE B.CLIENTE_ATACADO=A.NOME_CLIFOR),GETDATE())<=1095 
) B ON B.NOME_CLIFOR=A.NOME_CLIFOR
WHERE NOT EXISTS (SELECT * FROM CADASTRO_CLI_FOR WHERE NOME_CLIFOR=A.NOME_CLIFOR) 



--- 22o
--- CLIENTES ATACADO
INSERT INTO CLIENTES_ATACADO
SELECT [CLIENTE_ATACADO]
      ,B.[CLIFOR]
      ,[CONDICAO_PGTO]
      ,[REGIAO]
      ,[CLIENTE_ATACADO]
      ,[FILIAL]
      ,[PONTUALIDADE]
      ,'NOSSO CARRO'--[TRANSPORTADORA]
      ,[CONCEITO]
      ,[TIPO]
      ,[TIPO_BLOQUEIO]
      ,A.[CGC_CPF]
      ,B.[CLIFOR]
      ,[FRETE_A_PAGAR]
      ,[PRIORIDADE]
      ,[SEM_CREDITO]
      ,[LIMITE_CREDITO]
      ,[BLOQUEIO_EXPEDICAO]
      ,[BLOQUEIO_FATURAMENTO]
      ,[ACEITA_JUNTAR_PED]
      ,[BLOQUEIO_PEDIDOS]
      ,[NUMERO_PEDIDOS]
      ,[DATA_MAIOR_PEDIDO]
      ,[MAIOR_PEDIDO]
      ,[DATA_MAIOR_QTDE_PEDIDO]
      ,[MAIOR_QTDE_PEDIDO]
      ,[MAIOR_SALDO]
      ,[DATA_MAIOR_SALDO]
      ,[NUMERO_ATRASOS]
      ,[MAIOR_ATRASO]
      ,[PGTOS_CARTORIO]
      ,[NUMERO_DEVOLUCOES]
      ,[DATA_MAIOR_DEVOLUCAO]
      ,[MAIOR_DEVOLUCAO]
      ,[DATA_MAIOR_QTDE_DEV]
      ,[MAIOR_QTDE_DEV]
      ,[NUMERO_PRORROGACOES]
      ,[MAIOR_PRORROGACAO]
      ,[DESCONTO_FATURAMENTO]
      ,[OBS]
      ,A.[INATIVO]
      ,[MOEDA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[INDICA_FRANQUIA]
      ,'VA'--[CODIGO_TAB_PRECO]
      ,[FATOR_CUSTO_FRANQUIA]
      ,[DESCONTO_PEDIDO_VENDA]
      ,[SEGURO_NUMERO_CONTRATO]
      ,[SEGURO_NUMERO_CLIENTE]
      ,[SEGURO_VALIDADE]
      ,A.[CONTA_CONTABIL] 
      ,A.[MESES_SEM_VENCIMENTO]
      ,[EXPEDICAO_COMPLETO_PEDIDO]
      ,[EXPEDICAO_COMPLETO_PACK]
      ,[EXPEDICAO_COMPLETO_TAMANHOS]
      ,[EXPEDICAO_COMPLETO_COR]
      ,[EXPEDICAO_COMPLETO_COORDENADO]
      ,[EXPEDICAO_COMPLETO_CARTELA]
      ,[EXPEDICAO_PORCENTAGEM_MAIOR]
      ,[EXPEDICAO_PORCENTAGEM_MINIMA]
      ,[EXPEDICAO_PORCENTAGEM_TIPO]
      ,[EXPEDICAO_VALOR_MAXIMO]
      ,[CONTA_CONTABIL_ANTECIPACAO]
      ,'NOSSO CARRO'--[TRANSP_REDESPACHO]
      ,[CONTA_CONTABIL_VENDAS_TIPO]
      ,'NOSSO CARRO'--[TRANSPORTADORA2]
      ,'1125001001'--[CTB_CONTA_CONTABIL]
      ,[EXPEDICAO_COMPLETO_FAIXAS]
      ,[DESCONTO_BRUTO]
      ,[DESCONTO_BRUTO_1]
      ,[DESCONTO_BRUTO_2]
      ,[DESCONTO_BRUTO_3]
      ,[DESCONTO_BRUTO_4]
      ,[DESCONTO_SOBRE_1]
      ,[DESCONTO_SOBRE_2]
      ,[DESCONTO_SOBRE_3]
      ,[DESCONTO_SOBRE_4]
      ,[EXPEDICAO_PORC_ADEQUACAO]
      ,[EXPEDICAO_QTDE_ADEQUACAO]
      ,[EXPEDICAO_ADEQUACAO_COR]
      ,[EXPEDICAO_ADEQUACAO_TAMANHO]
      ,[MULTI_DESCONTO_ACUMULAR]
      ,[INDICADOR_VENDA]
      ,[DATA_MAIOR_ATRASO]
      ,[MAIOR_VALOR_FATURADO]
      ,[DATA_MAIOR_VALOR_FATURADO]
      ,[DT_ULTIMA_VENDA]
      ,[DT_PENULTIMA_VENDA]
      ,[DT_ANTEPENULTIMA_VENDA]
      ,[DT_PRIMEIRA_VENDA]
      ,[CONTEUDO_XPED_NFE]
  FROM LDR.DRVAREJO.DBO.[CLIENTES_ATACADO] A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.CLIENTE_ATACADO  
WHERE NOT EXISTS(SELECT * FROM CLIENTES_ATACADO WHERE CLIENTE_ATACADO=A.CLIENTE_ATACADO) AND B.INDICA_CLIENTE=1 AND A.CLIENTE_ATACADO<>'DENI RICARDO MONCAY CECHI' AND A.CLIENTE_ATACADO<>''


--- 23o
--- CLIENTE REPRE 
INSERT INTO CLIENTE_REPRE
SELECT A.[REPRESENTANTE]
      ,A.[CLIENTE_ATACADO]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,A.[COMISSAO]
      ,A.[REPRESENTANTE_PRINCIPAL]
  FROM LDR.DRVAREJO.DBO.[CLIENTE_REPRE] A
JOIN CLIENTES_ATACADO B ON B.CLIENTE_ATACADO=A.CLIENTE_ATACADO 
JOIN REPRESENTANTES C ON C.REPRESENTANTE=A.REPRESENTANTE
WHERE NOT EXISTS(SELECT * FROM CLIENTE_REPRE WHERE REPRESENTANTE=A.REPRESENTANTE AND CLIENTE_ATACADO=A.CLIENTE_ATACADO)  
AND B.CTB_CONTA_CONTABIL='1125001001' AND B.INATIVO=0 AND B.TIPO='BALCONISTA'

-----------------------------------------------------------------------------------

--- APOIO AO BANCO TESTE COM AS NOVAS CONTAS CRIADAS PELO ELTON
INSERT INTO CTB_CONTA_TIPO
SELECT [TIPO_CONTA]
      ,[DESC_CONTA_TIPO]
      ,[CONTA_OBRIGATORIA]
      ,[INDICA_ID_CONTABIL_TERCEIRO]
  FROM [DRLINGERIE].[dbo].[CTB_CONTA_TIPO] A 
WHERE NOT EXISTS(SELECT * FROM CTB_CONTA_TIPO WHERE TIPO_CONTA=A.TIPO_CONTA)

INSERT INTO CTB_CONTA_PLANO
SELECT [CONTA_CONTABIL]
      ,[RATEIO_CENTRO_CUSTO]
      ,[CODIGO_HISTORICO]
      ,[LX_GRUPO_FLUXO]
      ,[DESC_CONTA]
      ,[TIPO_CONTA]
      ,[INATIVA]
      ,[CODIGO_RESUMIDO]
      ,[CONTA_CORRENTE]
      ,[ULTIMO_CHEQUE]
      ,[EXPORTACAO_CONTA_CONTABIL]
      ,[EXPORTACAO_TIPO]
      ,[CONTA_PORTADORA]
      ,[DESC_CONTA_REDUZIDA]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[ID_CARTEIRA_COBRANCA]
      ,[DESC_DETALHADA]
      ,[BANCO]
      ,[AGENCIA]
      ,[NUMERO_CONTA_CORRENTE]
      ,[COD_CLIFOR]
      ,[MOEDA]
      ,[LX_GRUPO_CONTABIL]
      ,[LANCAMENTO_PADRAO]
      ,[LANCAMENTO_PADRAO_DEFLACAO]
      ,[LIMITE_CONTA_CORRENTE]
      ,[SALDO_BLOQ_CONTA_CORRENTE]
      ,[PREVISAO_DESPESA]
      ,[ID_IMPOSTO]
      ,[COD_FILIAL]
      ,[INDICA_CONSOLIDACAO]
      ,[INDICA_CTRL_ORCAMENTO]
      ,[CONVENIO]
  FROM [DRLINGERIE].[dbo].[CTB_CONTA_PLANO] A
WHERE NOT EXISTS (SELECT * FROM CTB_CONTA_PLANO WHERE CONTA_CONTABIL=A.CONTA_CONTABIL) 


--- DESCOBRE AS TRIGGERS CRIADAS NA DR
SELECT     name, OBJECT_NAME(parent_obj) AS tabela
FROM         sysobjects
WHERE     (xtype = 'TR') and name like 'D%'


--- DESCOBRE AS TRIGGERS CRIADAS NA LDR
SELECT     name, OBJECT_NAME(parent_obj) AS tabela
FROM         LDR.DRVAREJO.DBO.sysobjects A
WHERE     (xtype = 'TR') and name like 'LDR%' and not exists(
SELECT name, OBJECT_NAME(parent_obj) AS tabela
FROM         sysobjects
WHERE     (xtype = 'TR') AND name=A.NAME
)
ORDER BY TABELA



USE [DRVAREJO]
GO

/****** Object:  Table [dbo].[COTA_LIMITE_PERFAT]    Script Date: 12/08/2015 15:35:09 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[COTA_LIMITE_PERFAT](
	[NUMERO_ENTREGA] [char](2) NOT NULL,
	[PERIODO_PCP] [varchar](25) NOT NULL,
	[QTDE_LIMITE] [numeric](14, 0) NULL,
	[FECHADO] [bit] NULL,
 CONSTRAINT [PK_COTA_LIMITE_PERFAT] PRIMARY KEY CLUSTERED 
(
	[NUMERO_ENTREGA] ASC,
	[PERIODO_PCP] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

UPDATE COTA_LIMITE_PERFAT
SET FECHADO=0
FROM COTA_LIMITE_PERFAT A
JOIN PRODUTOS_PERIODOS_ENTREGAS B ON B.NUMERO_ENTREGA=A.NUMERO_ENTREGA AND B.PERIODO_PCP=A.PERIODO_PCP
WHERE B.ENTREGA>'20160101' AND B.ENTREGA<='20160331'



SELECT * FROM COTA_LIMITE_PERFAT
WHERE FECHADO=0
ORDER BY NUMERO_ENTREGA

INSERT INTO COTA_LIMITE_PERFAT
SELECT NUMERO_ENTREGA,PERIODO_PCP,50000,1 FROM PRODUTOS_PERIODOS_ENTREGAS
WHERE ENTREGA>'20150101'


SELECT * FROM PRODUTOS_PERIODOS_PCP
WHERE PERIODO_PCP LIKE 'DEZ%2015'

SELECT * FROM PRODUTOS_PERIODOS_ENTREGAS
WHERE PERIODO_PCP LIKE 'DEZ%2015'

ORDER BY NUMERO_ENTREGA




USE [DRVAREJO]
GO

/****** Object:  Table [dbo].[LDR_PRODUTOS_PERIODOS_ENTREGAS_FUTURAS]    Script Date: 12/08/2015 16:05:53 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[LDR_PRODUTOS_PERIODOS_ENTREGAS_FUTURAS](
	[PRODUTO] [char](12) NULL,
	[COR_PRODUTO] [char](10) NULL,
	[ENTREGA] [datetime] NULL,
	[PEDIDO_EXTERNO] [char](12) NULL,
	[NUMERO_ENTREGA] [char](2) NULL,
	[LIMITE_ENTREGA] [datetime] NULL,
	[ENVIAR_EMAIL] [bit] NULL,
	[REPRESENTANTE] [varchar](25) NULL,
	[CLIENTE_ATACADO] [varchar](25) NULL,
	[NUMERO_ENTREGA_REP] [char](2) NULL,
	[GERENTE] [varchar](25) NULL,
	[QTDE_ORIGINAL] [int] NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO



SELECT * FROM LDR_PRODUTO_COR_ENTREGA_FUTURA


INSERT INTO LDR_PRODUTO_COR_ENTREGA_FUTURA
SELECT PRODUTO,COR_PRODUTO,'DEZEMBRO 2015','49','20151129','20151205' 
FROM PRODUTO_CORES
WHERE PRODUTO LIKE 'V%'







CREATE TABLE [dbo].[LDR_PRODUTO_COR_ENTREGA_FUTURA](
	[PRODUTO] [char](12) NOT NULL,
	[COR_PRODUTO] [char](10) NOT NULL,
	[PERIODO_PCP] [varchar](25) NOT NULL,
	[NUMERO_ENTREGA] [char](2) NOT NULL,
	[ENTREGA] [datetime] NOT NULL,
	[LIMITE] [datetime] NOT NULL,
 CONSTRAINT [PK_LDR_PRODUTO_COR_ENTREGA_FUTURA] PRIMARY KEY CLUSTERED 
(
	[PRODUTO] ASC,
	[COR_PRODUTO] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON, FILLFACTOR = 90) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO



USE [DRVAREJO]
GO

/****** Object:  Table [dbo].[SFV_MATERIAL_PROMOCIONAL]    Script Date: 12/08/2015 16:37:03 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING OFF
GO

SELECT * FROM SFV_MATERIAL_PROMOCIONAL

CREATE TABLE [dbo].[SFV_MATERIAL_PROMOCIONAL](
	[ID] [int] IDENTITY(1,1) NOT NULL,
	[DESCRICAO] [varchar](50) NULL
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO

----------------------- C O N T A S  A  R E C E B E R -----------------------------------

---- CONTAS A RECEBER 
SELECT DISTINCT B.CONTA_PORTADOR,C.DESC_CONTA 
FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
WHERE B.VALOR_A_RECEBER>0
union all
SELECT DISTINCT B.CONTA_PORTADOR,C.DESC_CONTA 
FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A WITH (NOLOCK)
JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
WHERE B.VALOR_A_PAGAR>0


--- COLOCAR O CÓDIGO DA SEQUÊNCIA N LDR
UPDATE A
SET REF_ANTERIOR=B.CLIFOR
--SELECT A.REF_ANTERIOR 
FROM CADASTRO_CLI_FOR A
JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.NOME_CLIFOR AND B.CGC_CPF=A.CGC_CPF



--- lancamentos contas a receber
SELECT *
FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001'
AND NOT EXISTS(SELECT * FROM CADASTRO_CLI_FOR WHERE CGC_CPF=D.CGC_CPF)

--- INSERT DE MOEDAS
INSERT INTO MOEDAS( [MOEDA]
      ,[INDICA_PADRAO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[NOME_MOEDA_PLURAL]
      ,[NOME_FRACAO_MOEDA_PLURAL]
      ,[NOME_MOEDA]
      ,[NOME_FRACAO_MOEDA]
      ,[LX_STATUS_REGISTRO])
SELECT [MOEDA]
      ,[INDICA_PADRAO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[NOME_MOEDA_PLURAL]
      ,[NOME_FRACAO_MOEDA_PLURAL]
      ,[NOME_MOEDA]
      ,[NOME_FRACAO_MOEDA]
      ,[LX_STATUS_REGISTRO]
  FROM LDR.DRVAREJO.[dbo].[MOEDAS] A
WHERE NOT EXISTS(SELECT * FROM MOEDAS WHERE MOEDA=A.MOEDA)

--- INSERT DE PAISES
INSERT INTO PAISES
SELECT [PAIS]
      ,[MOEDA]
      ,[DDI]
      ,[COD_PAIS]
      ,[BLOCO_ECONOMICO]
      ,[DATA_PARA_TRANSFERENCIA]
  FROM LDR.DRVAREJO.[dbo].[PAISES] A
WHERE NOT EXISTS(SELECT * FROM PAISES WHERE PAIS=A.PAIS)


--- VERIFICAR O CADASTRO DOS CLIENTES E FORNECEDORES
INSERT INTO CADASTRO_CLI_FOR
           ([NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,[CONTA_CONTABIL]
           ,[CLIFOR]
           ,[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,[INATIVO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,[COD_CLIFOR]
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,[CLI_FOR])
SELECT      RTRIM(SUBSTRING([NOME_CLIFOR],1,19))+RTRIM([CLIFOR])
           ,[CARTEIRA]
           ,[BANCO]
           ,A.[CONTA_CONTABIL]
           ,CAST('509636' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row1
           ,A.[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]=CLIFOR
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,A.[INATIVO]
           ,A.[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,A.[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,CAST('509636' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row2
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,A.[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,CAST('509636' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row3
FROM LDR.DRVAREJO.DBO.[CADASTRO_CLI_FOR] A WITH (NOLOCK)
WHERE A.CLIFOR IN (
        SELECT COD_CLIFOR FROM LDR.DRVAREJO.DBO.CTB_CHEQUE_CARTAO
        WHERE VALOR_A_RECEBER>0

		--SELECT DISTINCT A.COD_CLIFOR
		--FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
		--JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
		--JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
		--JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
		--WHERE B.VALOR_A_PAGAR>0
		--UNION ALL
		--SELECT DISTINCT A.COD_CLIFOR
		--FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
		--JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
		--JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
		--JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
		--WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001' 
		--UNION ALL
		--SELECT DISTINCT B.COD_CLIFOR 
		--FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
		--JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
		--WHERE VALOR_AVISO>0 		
		
) AND NOT EXISTS (SELECT * FROM CADASTRO_CLI_FOR WHERE REF_ANTERIOR=A.CLIFOR)


SELECT * FROM SEQUENCIAIS
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'


UPDATE SEQUENCIAIS
SET SEQUENCIA='509651'
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'

SELECT CLIFOR FROM CADASTRO_CLI_FOR
WHERE REF_ANTERIOR IS NOT NULL
ORDER BY CLIFOR


--- CLIENTES ATACADO
INSERT INTO CLIENTES_ATACADO
SELECT C.NOME_CLIFOR
      ,C.[CLIFOR]
      ,[CONDICAO_PGTO]
      ,[REGIAO]
      ,C.NOME_CLIFOR
      ,[FILIAL]
      ,[PONTUALIDADE]
      ,'NOSSO CARRO'--[TRANSPORTADORA]
      ,[CONCEITO]
      ,[TIPO]
      ,[TIPO_BLOQUEIO]
      ,A.[CGC_CPF]
      ,C.[CLIFOR]
      ,[FRETE_A_PAGAR]
      ,[PRIORIDADE]
      ,[SEM_CREDITO]
      ,[LIMITE_CREDITO]
      ,[BLOQUEIO_EXPEDICAO]
      ,[BLOQUEIO_FATURAMENTO]
      ,[ACEITA_JUNTAR_PED]
      ,[BLOQUEIO_PEDIDOS]
      ,[NUMERO_PEDIDOS]
      ,[DATA_MAIOR_PEDIDO]
      ,[MAIOR_PEDIDO]
      ,[DATA_MAIOR_QTDE_PEDIDO]
      ,[MAIOR_QTDE_PEDIDO]
      ,[MAIOR_SALDO]
      ,[DATA_MAIOR_SALDO]
      ,[NUMERO_ATRASOS]
      ,[MAIOR_ATRASO]
      ,[PGTOS_CARTORIO]
      ,[NUMERO_DEVOLUCOES]
      ,[DATA_MAIOR_DEVOLUCAO]
      ,[MAIOR_DEVOLUCAO]
      ,[DATA_MAIOR_QTDE_DEV]
      ,[MAIOR_QTDE_DEV]
      ,[NUMERO_PRORROGACOES]
      ,[MAIOR_PRORROGACAO]
      ,[DESCONTO_FATURAMENTO]
      ,[OBS]
      ,A.[INATIVO]
      ,[MOEDA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[INDICA_FRANQUIA]
      ,'VA'--[CODIGO_TAB_PRECO]
      ,[FATOR_CUSTO_FRANQUIA]
      ,[DESCONTO_PEDIDO_VENDA]
      ,[SEGURO_NUMERO_CONTRATO]
      ,[SEGURO_NUMERO_CLIENTE]
      ,[SEGURO_VALIDADE]
      ,A.[CONTA_CONTABIL] 
      ,A.[MESES_SEM_VENCIMENTO]
      ,[EXPEDICAO_COMPLETO_PEDIDO]
      ,[EXPEDICAO_COMPLETO_PACK]
      ,[EXPEDICAO_COMPLETO_TAMANHOS]
      ,[EXPEDICAO_COMPLETO_COR]
      ,[EXPEDICAO_COMPLETO_COORDENADO]
      ,[EXPEDICAO_COMPLETO_CARTELA]
      ,[EXPEDICAO_PORCENTAGEM_MAIOR]
      ,[EXPEDICAO_PORCENTAGEM_MINIMA]
      ,[EXPEDICAO_PORCENTAGEM_TIPO]
      ,[EXPEDICAO_VALOR_MAXIMO]
      ,[CONTA_CONTABIL_ANTECIPACAO]
      ,'NOSSO CARRO'--[TRANSP_REDESPACHO]
      ,[CONTA_CONTABIL_VENDAS_TIPO]
      ,'NOSSO CARRO'--[TRANSPORTADORA2]
      ,'1125001001'--[CTB_CONTA_CONTABIL]
      ,[EXPEDICAO_COMPLETO_FAIXAS]
      ,[DESCONTO_BRUTO]
      ,[DESCONTO_BRUTO_1]
      ,[DESCONTO_BRUTO_2]
      ,[DESCONTO_BRUTO_3]
      ,[DESCONTO_BRUTO_4]
      ,[DESCONTO_SOBRE_1]
      ,[DESCONTO_SOBRE_2]
      ,[DESCONTO_SOBRE_3]
      ,[DESCONTO_SOBRE_4]
      ,[EXPEDICAO_PORC_ADEQUACAO]
      ,[EXPEDICAO_QTDE_ADEQUACAO]
      ,[EXPEDICAO_ADEQUACAO_COR]
      ,[EXPEDICAO_ADEQUACAO_TAMANHO]
      ,[MULTI_DESCONTO_ACUMULAR]
      ,[INDICADOR_VENDA]
      ,[DATA_MAIOR_ATRASO]
      ,[MAIOR_VALOR_FATURADO]
      ,[DATA_MAIOR_VALOR_FATURADO]
      ,[DT_ULTIMA_VENDA]
      ,[DT_PENULTIMA_VENDA]
      ,[DT_ANTEPENULTIMA_VENDA]
      ,[DT_PRIMEIRA_VENDA]
      ,[CONTEUDO_XPED_NFE]
  FROM LDR.DRVAREJO.DBO.[CLIENTES_ATACADO] A WITH (NOLOCK)
JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR B WITH (NOLOCK) ON B.NOME_CLIFOR=A.CLIENTE_ATACADO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=B.CLIFOR
WHERE NOT EXISTS(SELECT * FROM CLIENTES_ATACADO WHERE COD_CLIENTE=C.CLIFOR) --AND C.INDICA_CLIENTE=1


--- FORNECEDOR SUBTIPO
INSERT INTO FORNECEDOR_SUBTIPO
SELECT [SUBTIPO_FORNECEDOR]
      ,[TIPO]
      ,[DATA_PARA_TRANSFERENCIA]
  FROM LDR.DRVAREJO.DBO.FORNECEDOR_SUBTIPO A
WHERE NOT EXISTS(SELECT * FROM FORNECEDOR_SUBTIPO WHERE SUBTIPO_FORNECEDOR=A.SUBTIPO_FORNECEDOR AND TIPO=A.TIPO)


---- FORNECEDORES
INSERT INTO FORNECEDORES
SELECT C.[NOME_CLIFOR]
      ,[CENTRO_CUSTO]
      ,[TIPO]
      ,[SUBTIPO_FORNECEDOR]
      ,C.CLIFOR
      ,C.CLIFOR
      ,[CONDICAO_PGTO]='002'
      ,A.[CGC_CPF]
      ,[FORNECE_MATERIAIS]
      ,[FORNECE_PROD_ACAB]
      ,[FORNECE_MAT_CONSUMO]
      ,[BENEFICIADOR]
      ,[FORNECE_OUTROS]
      ,[MOEDA]
      ,A.[INATIVO]
      ,A.[DATA_PARA_TRANSFERENCIA] 
      ,[LICENCIADO]
      ,[LICENDIADO_ROYALTIES]
      ,A.[CONTA_CONTABIL]
      ,'2125001'--[CTB_CONTA_CONTABIL]
      ,[LICENCIADO_ROYALTIES]
      ,[CQFOR_CLASSIFICACAO]
      ,[INDICA_CQFOR]
      ,[DIAS_DESCONTO_VENCIMENTO]
      ,[DESCONTO_VENCIMENTO]
      ,[VALOR_MINIMO_PEDIDO]
      ,[INDICA_TRANSPORTADORA]
      ,[LX_METODO_PAGAMENTO]
FROM LDR.DRVAREJO.DBO.[FORNECEDORES] A
JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR B WITH (NOLOCK) ON B.NOME_CLIFOR=A.FORNECEDOR
JOIN CADASTRO_CLI_FOR C ON C.REF_ANTERIOR=B.CLIFOR 
WHERE NOT EXISTS(SELECT * FROM FORNECEDORES WHERE FORNECEDOR=C.NOME_CLIFOR) --AND C.INDICA_FORNECEDOR=1


SELECT * FROM SEQUENCIAIS
WHERE TABELA_COLUNA='CTB_LANCAMENTO.LANCAMENTO'

SELECT * FROM CTB_LANCAMENTO
ORDER BY LANCAMENTO DESC


UPDATE SEQUENCIAIS
SET SEQUENCIA='00302395'
WHERE TABELA_COLUNA='CTB_LANCAMENTO.LANCAMENTO'

----------------------- INICIO DO CONTAS A PAGAR E RECEBER --------------------
--- APAGAR TUDO
select * FROM CTB_LANCAMENTO
WHERE USUARIO='TI-LDR' and LANCAMENTO>='302303'

--- LANCAMENTOS
INSERT INTO CTB_LANCAMENTO
SELECT CAST('302367' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.LANCAMENTO) AS Row1
      ,[EMPRESA]
      ,[TIPO_MOVIMENTO]
      ,[LOTE_LANCAMENTO]=NULL
      ,[LANCAMENTO_PADRAO]=NULL
      ,[GERADO_INTEGRACAO]='0'
      ,[CONCILIADO]
      ,[DATA_CONCILIADO]
      ,[DATA_LANCAMENTO]='20160101'
      ,[DATA_DIGITACAO]='20160101'
      ,[COD_FILIAL]='000003'
      ,[ID_ASSINATURA_DOCUMENTO]
      ,[USUARIO]='TI-LDR'
      ,[LANCAMENTO_CAIXA]
      ,[TERMINAL]
      ,[PARCELA]
      ,[CAMBIO_NA_DATA_EMISSAO]
      ,[GERADO_VALOR_FINANCEIRO]
      ,[USUARIO_ASSINATURA]
      ,[DATA_ASSINATURA]
      ,[NUMERO_CORRELATIVO]=A.LANCAMENTO
      ,[TIPO_COMPROVANTE]
      ,[INDICA_DEPARA]
  FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO] A WITH (NOLOCK) 
WHERE A.LANCAMENTO IN(
    SELECT DISTINCT LANCAMENTO FROM LDR.DRVAREJO.DBO.CTB_CHEQUE_CARTAO  
    WHERE VALOR_A_RECEBER>0

	--SELECT A.LANCAMENTO 
	--FROM LDR.DRVAREJO.DBO.CTB_CHEQUE A
	--JOIN LDR.DRVAREJO.DBO.W_CTB_CHEQUE B ON B.LANCAMENTO=A.LANCAMENTO
	--WHERE B.VALOR_A_PAGAR>0

	--SELECT DISTINCT A.LANCAMENTO
	--FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	--JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	--JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	--JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	--WHERE B.VALOR_A_PAGAR>0
	--UNION ALL
	--SELECT DISTINCT A.LANCAMENTO
	--FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	--JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	--WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAD'		
    --UNION ALL 
	--SELECT DISTINCT A.LANCAMENTO
	--FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	--JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	--JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	--JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	--WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001' 
	--UNION ALL
	--SELECT DISTINCT A.LANCAMENTO
	--FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	--JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	--WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAC'		
)


---- IMPORTAR NA SEGUNDA DIA 4
---- L A N Ç A M E N T O S  C O N T A S  A  R E C E B E R 
---- DÉBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,A.[RATEIO_CENTRO_CUSTO]
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=D.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001'
)


---- CRÉDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMC'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='CREDITO REF'
      ,[CODIGO_HISTORICO]='LMC'
      ,[RATEIO_CENTRO_CUSTO]='31'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=D.CLIFOR      
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001'
)


INSERT INTO CTB_LX_DOCUMENTO_TIPO
SELECT [LX_TIPO_DOCUMENTO]
      ,[TIPO_DOCUMENTO]
      ,[SERIE_NF]
      ,[NOME_RECIBO]
      ,[INATIVO]
      ,[TIPO_PGTO]
      ,[LX_TIPO_PADRAO]
      ,[VALIDA_VALOR]
      ,[VALOR_MINIMO]
      ,[VALOR_MAXIMO]
FROM LDR.DRVAREJO.DBO.CTB_LX_DOCUMENTO_TIPO A WITH (NOLOCK)
WHERE NOT EXISTS(SELECT * FROM CTB_LX_DOCUMENTO_TIPO WITH (NOLOCK) WHERE LX_TIPO_DOCUMENTO=A.LX_TIPO_DOCUMENTO)


--- LANÇAMENTOS DE CONTAS A RECEBER FATURA
INSERT INTO CTB_A_RECEBER_FATURA
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[FATURA]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[CODIGO_CONSUMIDOR]
      ,A.[EMISSAO]
      ,A.[DOCUMENTO]
      ,A.[FATURA_IMPRESSA]
      ,A.[POSSUI_SAIDA]
      ,A.[COMISSAO_GERENTE]
      ,A.[PORCENTAGEM_ACERTO]
      ,A.[COMISSAO]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[JUROS_POR_ATRASO]
      ,A.[MULTA_POR_ATRASO]
      ,A.[SERIE]
      ,A.[NUMERO_PARCELAS]
      ,[COD_REPRESENTANTE]= case when e.COD_CLIFOR <> null then e.COD_CLIFOR else f.COD_CLIFOR end
      ,[COD_REPRESENTANTE_GERENTE]=F.CLIFOR
      ,A.[MOEDA]
      ,[COD_CLIFOR]=D.COD_CLIFOR
      ,[COD_EMISSOR]='000003'
      ,A.[INDICA_PROTESTO]
FROM LDR.DRVAREJO.dbo.[CTB_A_RECEBER_FATURA] A WITH (NOLOCK)
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR

LEFT JOIN CADASTRO_CLI_FOR E WITH (NOLOCK) ON E.REF_ANTERIOR=A.COD_REPRESENTANTE
LEFT JOIN CADASTRO_CLI_FOR F WITH (NOLOCK) ON F.REF_ANTERIOR=A.COD_REPRESENTANTE_GERENTE

WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001'
) --AND E.CLIFOR IS NULL


----- FAZER O DE PARA DAS CONTAS CONTABEIS LDR - DR
----- LANÇAMENTOS DE CONTAS A RECEBER PARCELAS
INSERT INTO CTB_A_RECEBER_PARCELA
SELECT B.[LANCAMENTO] 
      ,A.[ITEM]
      ,A.[ID_PARCELA]
      ,[CONTA_PORTADOR]=
       (CASE WHEN CONTA_PORTADOR='112011301' THEN '1125004001'
             WHEN CONTA_PORTADOR='112011309' THEN '1125004005'
             WHEN CONTA_PORTADOR='112011401' THEN '1125005001'
             WHEN CONTA_PORTADOR='1120106'   THEN '1125001003'
             WHEN CONTA_PORTADOR='112010310' THEN '1125004001'
             WHEN CONTA_PORTADOR='1120101'   THEN '1125001001'
             WHEN CONTA_PORTADOR='112011419' THEN '1125003003'
             WHEN CONTA_PORTADOR='112011305' THEN '1125004002'
             WHEN CONTA_PORTADOR='1120115'   THEN '1125001007'
             WHEN CONTA_PORTADOR='1120109'   THEN '1125001005'
             WHEN CONTA_PORTADOR='112010311' THEN '1125002002'
             WHEN CONTA_PORTADOR='1120117'   THEN '1125001008'
             WHEN CONTA_PORTADOR='112010306' THEN '1125002001'
             WHEN CONTA_PORTADOR='112010414' THEN '1125003002'
             WHEN CONTA_PORTADOR='1120112'   THEN '1125001006'
             WHEN CONTA_PORTADOR='1120102'   THEN '1125001002'
             WHEN CONTA_PORTADOR='112011307' THEN '1125004003'
             WHEN CONTA_PORTADOR='112010402' THEN '1125003001'
             WHEN CONTA_PORTADOR='112010314' THEN '1125002003'
             WHEN CONTA_PORTADOR='112010315' THEN '1125002004'
             WHEN CONTA_PORTADOR='1120108'   THEN '1125001004'
             WHEN CONTA_PORTADOR='112011308' THEN '1125004004'
             WHEN CONTA_PORTADOR='21415'     THEN '2125003'
             WHEN CONTA_PORTADOR='21105'     THEN '2125004'
             WHEN CONTA_PORTADOR='21111'     THEN '2115002'
             WHEN CONTA_PORTADOR='21101'     THEN '2115001'
             WHEN CONTA_PORTADOR='21122'     THEN '2135003'
             WHEN CONTA_PORTADOR='21121'     THEN '2135002'
             WHEN CONTA_PORTADOR='21201'     THEN '2125001'
             WHEN CONTA_PORTADOR='1120101'   THEN '1125001001'
             WHEN CONTA_PORTADOR='21117'     THEN '2115004'
             WHEN CONTA_PORTADOR='1120106'   THEN '1125001003'
             WHEN CONTA_PORTADOR='21204'     THEN '2135001'
             WHEN CONTA_PORTADOR='21113'     THEN '2115003'
             WHEN CONTA_PORTADOR='21103'     THEN '211017001'
             WHEN CONTA_PORTADOR='21120'     THEN '211017002'
             WHEN CONTA_PORTADOR='21124'     THEN '211017003'
             WHEN CONTA_PORTADOR='21125'     THEN '211017004'
             WHEN CONTA_PORTADOR='21126'     THEN '211017005'

			 WHEN CONTA_PORTADOR='112010407' THEN '1125003004'
		  	 WHEN CONTA_PORTADOR='112010411' THEN '1125003005'
			 WHEN CONTA_PORTADOR='112010419' THEN '1125003003'
			 WHEN CONTA_PORTADOR='112010425' THEN '1125003006'
			 WHEN CONTA_PORTADOR='112011303' THEN '1125004006'
			 WHEN CONTA_PORTADOR='1120118'	 THEN '1125001009'
			 WHEN CONTA_PORTADOR='1120119'   THEN '1125001010'
			 WHEN CONTA_PORTADOR='1120120'   THEN '1125001011'
			 WHEN CONTA_PORTADOR='1120121'   THEN '1125001012'
             
        ELSE 
             'FALTA CONTA:'+CONTA_PORTADOR 
        END)      
      ,A.[VENCIMENTO]
      ,A.[NUMERO_BANCARIO]
      ,[VALOR_ORIGINAL_PADRAO]=A.[VALOR_A_RECEBER]
      ,[VALOR_ORIGINAL]=A.[VALOR_A_RECEBER]
      ,A.[DIAS_PRORROGADOS]
      ,A.[DESCONTO_VENC]
      ,A.[DATA_DESCONTO_VENC]
      ,A.[AGENCIA]
      ,A.[EMPRESA]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[VENCIMENTO_REAL]
      ,A.[VALOR_A_RECEBER]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[VALOR_MULTA_PAGA_PADRAO]
      ,A.[VALOR_JUROS_PAGO_PADRAO]
      ,A.[DESCONTO_EFETIVADO_PADRAO]
      ,A.[BANCO]
      ,A.[INDICA_PROTESTO]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,A.[VALOR_JUROS_DESCONTO]
      ,A.[EMPRESA_DESPESA_DESCONTO]
      ,A.[LANCAMENTO_DESPESA_DESCONTO]
      ,A.[ITEM_DESPESA_DESCONTO]
      ,A.[LOJA_CHAVE]
      ,A.[INDICA_ESTORNO_COMISSAO]
      ,A.[DATA_ENVIO_SCI]
      ,A.[DATA_BAIXA_SCI]
      ,A.[DATA_ENVIO_SERASA]
      ,A.[DATA_BAIXA_SERASA]
      ,A.[INDICA_NAO_ENVIO_BORDERO]
      ,A.[CONTRATO_GRUPO]
FROM LDR.DRVAREJO.dbo.[CTB_A_RECEBER_PARCELA] A WITH (NOLOCK)
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO  
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_RECEBER>0 AND A.COD_EMISSOR='000001'
) AND A.VALOR_A_RECEBER>0


---- SOMA DE VALORES PARA OS LANÇAMENTOS CONTAS A RECEBER
---- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_A_RECEBER_PARCELA A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ITR' AND CREDITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 
WHERE B.LANCAMENTO > '293262'


--- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_A_RECEBER_PARCELA A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ITR') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND  B.ITEM=RTRIM(A.ITEM)+100 
--WHERE B.LANCAMENTO > '293262' AND B.LX_TIPO_LANCAMENTO='LMC'

-------------------------------------------------------------------------------




--- CADASTRO DE OCORRENCIA
INSERT INTO CTB_OCORRENCIA
SELECT [OCORRENCIA]
      ,[DESC_OCORRENCIA]
  FROM LDR.DRVAREJO.DBO.[CTB_OCORRENCIA] A
WHERE NOT EXISTS(SELECT * FROM CTB_OCORRENCIA WHERE OCORRENCIA=A.OCORRENCIA)


--- DADOS DO ACOMPANHAMENTO DAS PARCELAS
INSERT INTO CTB_ACOMPANHAMENTO
SELECT A.[EMPRESA] 
      ,C.[LANCAMENTO]
      ,C.[ITEM]
      ,A.[DATA_DIGITACAO]
      ,A.[OCORRENCIA]
      ,A.[SUB_ITEM]
      ,A.[ID_PARCELA]
      ,A.[DATA_ACOMPANHAMENTO]
      ,A.[OBS]
      ,A.[STATUS]
      ,[USUARIO]='SA'
  FROM LDR.DRVAREJO.DBO.[CTB_ACOMPANHAMENTO] A
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO  
JOIN CTB_LANCAMENTO_ITEM C WITH (NOLOCK) ON C.LANCAMENTO=B.LANCAMENTO AND C.ITEM=A.ITEM
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_RECEBER_FATURA A WITH (NOLOCK)
	JOIN LDR.DRVAREJO.DBO.CTB_A_RECEBER_PARCELA B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C WITH (NOLOCK) ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_RECEBER>0 
) 


----------- A V I S O  D E  C R E D I T O S / D E B I T O S
--- INCLUIR CÓDIGO ANTERIOR DA LDR
UPDATE A
SET REF_ANTERIOR=B.CLIFOR
SELECT A.REF_ANTERIOR FROM CADASTRO_CLI_FOR A
JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.NOME_CLIFOR AND B.CGC_CPF=A.CGC_CPF

---------- AVISO DE CREDITO
---- CRÉDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,A.[RATEIO_CENTRO_CUSTO]
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAC'
)


---- DÉBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMD'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='DEBITO REF'
      ,[CODIGO_HISTORICO]='LMD'
      ,[RATEIO_CENTRO_CUSTO]='31'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAC'
)

--- AVISO DE LANÇAMENTO
INSERT INTO CTB_AVISO_LANCAMENTO
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[CODIGO_CONSUMIDOR]
      ,A.[CODIGO_FISCAL_OPERACAO]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[AVISO_LANCAMENTO]
      ,A.[VENCIMENTO]
      ,A.[EMISSAO]
      ,[VALOR_ORIGINAL]=[VALOR_AVISO]
      ,A.[STATUS_APROVACAO]
      ,[VALOR_ORIGINAL_PADRAO]=[VALOR_AVISO]
      ,A.[DESC_AVISO_LANCAMENTO]
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[DESCRICAO]
      ,A.[SUB_ITEM]
      ,A.[ID_ASSINATURA_DOCUMENTO]
      ,A.[USUARIO]
      ,A.[LOJA_LANCAMENTO_CAIXA]
      ,A.[LOJA_TERMINAL]
      ,A.[LOJA_PARCELA]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[VENCIMENTO_REAL]
      ,A.[VALOR_AVISO]
      ,A.[LANCAMENTO_CAIXA]
      ,A.[TERMINAL]
      ,A.[PARCELA]
      ,A.[CAMBIO_NEGOCIADO]
      ,A.[PEDIDO_COMPRA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[COD_CLIFOR_SACADO]=C.CLIFOR
      ,A.[INDICA_SACADO_PRINCIPAL]
      ,A.[INDICA_FLUXO]
      ,A.[LOJA_CHAVE]
FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A WITH (NOLOCK)
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAC'
)

---- SOMA DE VALORES PARA OS LANÇAMENTOS AVISO DE CREDITO
---- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_AVISO) FROM CTB_AVISO_LANCAMENTO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='IAC' AND DEBITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 
WHERE B.LANCAMENTO >'291899'


--- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_AVISO_LANCAMENTO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='IAC') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=RTRIM(A.ITEM)+100 
WHERE B.LANCAMENTO >'291899' --AND B.LX_TIPO_LANCAMENTO='LMD'


----- AVISO DE BÉBITO
---- CRÉDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,[RATEIO_CENTRO_CUSTO]='8620'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAD'
) and not exists(select * from CTB_AVISO_LANCAMENTO where LANCAMENTO=b.LANCAMENTO)


---- DÉBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMC'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='CREDITO REF'
      ,[CODIGO_HISTORICO]='LMC'
      ,[RATEIO_CENTRO_CUSTO]='8620'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAD'
) and not exists(select * from CTB_AVISO_LANCAMENTO where LANCAMENTO=b.LANCAMENTO)


--- AVISO DE LANÇAMENTO
INSERT INTO CTB_AVISO_LANCAMENTO
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[CODIGO_CONSUMIDOR]
      ,A.[CODIGO_FISCAL_OPERACAO]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[AVISO_LANCAMENTO]
      ,A.[VENCIMENTO]
      ,A.[EMISSAO]
      ,[VALOR_ORIGINAL]=[VALOR_AVISO]
      ,A.[STATUS_APROVACAO]
      ,[VALOR_ORIGINAL_PADRAO]=[VALOR_AVISO]
      ,A.[DESC_AVISO_LANCAMENTO]
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[MOEDA]
      ,A.[DESCRICAO]
      ,A.[SUB_ITEM]
      ,A.[ID_ASSINATURA_DOCUMENTO]
      ,A.[USUARIO]
      ,A.[LOJA_LANCAMENTO_CAIXA]
      ,A.[LOJA_TERMINAL]
      ,A.[LOJA_PARCELA]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[VENCIMENTO_REAL]
      ,A.[VALOR_AVISO]
      ,A.[LANCAMENTO_CAIXA]
      ,A.[TERMINAL]
      ,A.[PARCELA]
      ,A.[CAMBIO_NEGOCIADO]
      ,A.[PEDIDO_COMPRA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[COD_CLIFOR_SACADO]=C.CLIFOR
      ,A.[INDICA_SACADO_PRINCIPAL]
      ,A.[INDICA_FLUXO]
      ,A.[LOJA_CHAVE]
FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A WITH (NOLOCK)
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT DISTINCT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.[CTB_AVISO_LANCAMENTO] A
	JOIN LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	WHERE VALOR_AVISO>0 AND B.LX_TIPO_LANCAMENTO='IAD'
) and not exists(select * from CTB_AVISO_LANCAMENTO where LANCAMENTO=b.LANCAMENTO)


----------------------- C O N T A S  A  P A G A R ----------------------------------------------------

---- CREDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,[RATEIO_CENTRO_CUSTO]='8620'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=D.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_PAGAR>0 
)

---- DEBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMD'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='DEBITO REF'
      ,[CODIGO_HISTORICO]='LMD'
      ,[RATEIO_CENTRO_CUSTO]='8602'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]=D.CLIFOR
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_PAGAR>0 
)



INSERT INTO [CTB_ESPECIE_SERIE]
SELECT [ESPECIE_SERIE]
      ,[NUMERO_MODELO_FISCAL]
      ,[DESC_ESPECIE_SERIE]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[LX_STATUS_REGISTRO]
  FROM LDR.DRVAREJO.[dbo].[CTB_ESPECIE_SERIE] A
WHERE NOT EXISTS(SELECT * FROM [CTB_ESPECIE_SERIE] WHERE ESPECIE_SERIE=A.ESPECIE_SERIE)


---- CTB_A_PAGAR_FATURA
INSERT INTO [CTB_A_PAGAR_FATURA]
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[FATURA]
      ,A.[ESPECIE_SERIE]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[EMISSAO]
      ,A.[FATURA_SERIE]
      ,A.[FATURA_OK]
      ,A.[POSSUI_ENTRADA]
      ,A.[PROVISAO]
      ,A.[COMPLEMENTO_NOME]
      ,A.[TAXA_JUROS]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[TAXA_MULTA]
      ,A.[DATA_ENTRADA]
      ,A.[NUMERO_ENTRADA]
      ,A.[NUMERO_PARCELAS]
      ,[COD_CLIFOR]=D.CLIFOR
      ,[COD_FILIAL]='000003'
      ,A.[MOEDA]
      ,A.[DOCUMENTO]
      ,[USUARIO]='SA'
      ,[COD_CLIFOR_SACADO]=D.CLIFOR
      ,A.[VALOR_OUTRAS_ENTIDADES]
      ,A.[INDICA_SACADO_PRINCIPAL]
      ,A.[ID_DADOS_ARRECADACAO]
      ,A.[DATA_APURACAO]
      ,A.[LX_METODO_PAGAMENTO]
FROM LDR.DRVAREJO.[dbo].[CTB_A_PAGAR_FATURA] A
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_PAGAR>0 
)


---- CTB_A_PAGAR_PARCELA
INSERT INTO CTB_A_PAGAR_PARCELA
SELECT B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[ID_PARCELA]
      ,A.[BANCO]
      ,[CONTA_PORTADOR]=
       (CASE WHEN CONTA_PORTADOR='112011301' THEN '1125004001'
             WHEN CONTA_PORTADOR='112011309' THEN '1125004005'
             WHEN CONTA_PORTADOR='112011401' THEN '1125005001'
             WHEN CONTA_PORTADOR='1120106'   THEN '1125001003'
             WHEN CONTA_PORTADOR='112010310' THEN '1125004001'
             WHEN CONTA_PORTADOR='1120101'   THEN '1125001001'
             WHEN CONTA_PORTADOR='112011419' THEN '1125003003'
             WHEN CONTA_PORTADOR='112011305' THEN '1125004002'
             WHEN CONTA_PORTADOR='1120115'   THEN '1125001007'
             WHEN CONTA_PORTADOR='1120109'   THEN '1125001005'
             WHEN CONTA_PORTADOR='112010311' THEN '1125002002'
             WHEN CONTA_PORTADOR='1120117'   THEN '1125001008'
             WHEN CONTA_PORTADOR='112010306' THEN '1125002001'
             WHEN CONTA_PORTADOR='112010414' THEN '1125003002'
             WHEN CONTA_PORTADOR='1120112'   THEN '1125001006'
             WHEN CONTA_PORTADOR='1120102'   THEN '1125001002'
             WHEN CONTA_PORTADOR='112011307' THEN '1125004003'
             WHEN CONTA_PORTADOR='112010402' THEN '1125003001'
             WHEN CONTA_PORTADOR='112010314' THEN '1125002003'
             WHEN CONTA_PORTADOR='112010315' THEN '1125002004'
             WHEN CONTA_PORTADOR='1120108'   THEN '1125001004'
             WHEN CONTA_PORTADOR='112011308' THEN '1125004004'
             WHEN CONTA_PORTADOR='21415'     THEN '2125003'
             WHEN CONTA_PORTADOR='21105'     THEN '2125004'
             WHEN CONTA_PORTADOR='21111'     THEN '2115002'
             WHEN CONTA_PORTADOR='21101'     THEN '2115001'
             WHEN CONTA_PORTADOR='21122'     THEN '2135003'
             WHEN CONTA_PORTADOR='21121'     THEN '2135002'
             WHEN CONTA_PORTADOR='21201'     THEN '2125001'
             WHEN CONTA_PORTADOR='1120101'   THEN '1125001001'
             WHEN CONTA_PORTADOR='21117'     THEN '2115004'
             WHEN CONTA_PORTADOR='1120106'   THEN '1125001003'
             WHEN CONTA_PORTADOR='21204'     THEN '2135001'
             WHEN CONTA_PORTADOR='21113'     THEN '2115003'
             WHEN CONTA_PORTADOR='21103'     THEN '211017001'
             WHEN CONTA_PORTADOR='21120'     THEN '211017002'
             WHEN CONTA_PORTADOR='21124'     THEN '211017003'
             WHEN CONTA_PORTADOR='21125'     THEN '211017004'
             WHEN CONTA_PORTADOR='21126'     THEN '211017005'
        ELSE 
             'FALTA CONTA'
        END)      
      ,[VALOR_ORIGINAL]=A.VALOR_A_PAGAR
      ,[VALOR_ORIGINAL_PADRAO]=A.VALOR_A_PAGAR
      ,A.[DATA_DESCONTO_VENC]
      ,A.[DESCONTO_VENC]
      ,A.[NUMERO_BANCARIO]
      ,A.[VENCIMENTO]
      ,A.[DIAS_PRORROGADOS]
      ,A.[PAGAMENTO_APROVADO]
      ,A.[CODIGO_BARRA]
      ,A.[EMPRESA]
      ,A.[ID_ASSINATURA_DOCUMENTO]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[ID_ASSINATURA_APROVACAO]
      ,A.[VALOR_A_PAGAR]
      ,A.[VENCIMENTO_REAL]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[VALOR_OUTRAS_ENTIDADES]
      ,A.[VALOR_PREVISAO_IMPOSTO]
      ,A.[LX_STATUS_CONCILIACAO]
      ,A.[LX_TIPO_DOCUMENTO_PARCELA]
      ,A.[CONCILIADO_DDA]
      ,A.[LX_METODO_PAGAMENTO_PARCELA]
FROM LDR.DRVAREJO.[dbo].[CTB_A_PAGAR_PARCELA] A
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_PAGAR>0 
) AND A.VALOR_A_PAGAR>0

--- DADOS DO ACOMPANHAMENTO DAS PARCELAS
INSERT INTO CTB_ACOMPANHAMENTO
SELECT A.[EMPRESA] 
      ,C.[LANCAMENTO]
      ,C.[ITEM]
      ,A.[DATA_DIGITACAO]
      ,A.[OCORRENCIA]
      ,A.[SUB_ITEM]
      ,A.[ID_PARCELA]
      ,A.[DATA_ACOMPANHAMENTO]
      ,A.[OBS]
      ,A.[STATUS]
      ,[USUARIO]='SA'
  FROM LDR.DRVAREJO.DBO.[CTB_ACOMPANHAMENTO] A
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO  
JOIN CTB_LANCAMENTO_ITEM C WITH (NOLOCK) ON C.LANCAMENTO=B.LANCAMENTO AND C.ITEM=A.ITEM
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_A_PAGAR_FATURA A
	JOIN LDR.DRVAREJO.DBO.CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
	JOIN LDR.DRVAREJO.DBO.CTB_CONTA_PLANO C ON C.CONTA_CONTABIL=B.CONTA_PORTADOR
	JOIN LDR.DRVAREJO.DBO.CADASTRO_CLI_FOR D ON D.CLIFOR=A.COD_CLIFOR
	WHERE B.VALOR_A_PAGAR>0 
)-- AND A.VALOR_A_PAGAR>0

---- SOMA DE VALORES PARA OS LANÇAMENTOS CONTAS A PAGAR
---- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_A_PAGAR_PARCELA A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ITP' AND DEBITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 
WHERE B.LANCAMENTO<>'222287'


--- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_A_PAGAR_PARCELA A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ITP') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM='10'+RTRIM(A.ITEM) 
WHERE B.LANCAMENTO<>'222287' AND B.LX_TIPO_LANCAMENTO='LMD'


---- SOMA DE VALORES PARA OS LANÇAMENTOS AVISO DE DEBITO
---- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_AVISO) FROM CTB_AVISO_LANCAMENTO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='IAD' AND DEBITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 
WHERE B.LANCAMENTO<>'222287'


--- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_ORIGINAL) FROM CTB_AVISO_LANCAMENTO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='IAD') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM='10'+RTRIM(A.ITEM) 
WHERE B.LANCAMENTO<>'222287' AND B.LX_TIPO_LANCAMENTO='LMC'


--- APAGAR TUDO
DELETE FROM CTB_LANCAMENTO
WHERE USUARIO='TI-LDR'


--- PARAMETROS 
INSERT INTO PARAMETROS
SELECT [PARAMETRO]
      ,[PENULT_ATUALIZACAO]
      ,[VALOR_DEFAULT]
      ,[ULT_ATUALIZACAO]
      ,[VALOR_ATUAL]
      ,[DESC_PARAMETRO]
      ,[TIPO_DADO]
      ,[RANGE_VALOR_ATUAL]
      ,[GLOBAL]
      ,[ESCOPO]
      ,[POR_USUARIO_OK]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[NOTA_PROGRAMADOR]
      ,[PERMITE_POR_EMPRESA]
      ,[ENVIA_PARA_LOJA]
      ,[PERMITE_POR_LOJA]
      ,[PERMITE_POR_TERMINAL]
      ,[PERMITE_ALTERAR_NA_LOJA]
      ,[PERMITE_ALTERAR_NO_TERMINAL]
      ,[ENVIA_PARA_REPRESENTANTE]
      ,[PERMITE_POR_REPRESENTANTE]
      ,[PERMITE_ALTERAR_NO_REPRESENTANTE]
      ,[APLICACAO]
  FROM LDR.DRVAREJO.[dbo].[PARAMETROS] A
WHERE NOT EXISTS(SELECT * FROM PARAMETROS WHERE PARAMETRO=A.PARAMETRO)

--- SEQUENCIAIS
INSERT INTO SEQUENCIAIS
SELECT [TABELA_COLUNA]
      ,[DESCRICAO]
      ,[SEQUENCIA]
      ,[TAMANHO]
      ,[OBS1]
      ,[OBS2]
      ,[OBS3]
      ,[OBS4]
      ,[OBS5]
      ,[OBS6]
      ,[OBS7]
      ,[OBS8]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[PERMITE_POR_EMPRESA]
      ,[APLICACAO]
  FROM LDR.DRVAREJO.[dbo].[SEQUENCIAIS] A
WHERE NOT EXISTS(SELECT * FROM SEQUENCIAIS WHERE TABELA_COLUNA=A.TABELA_COLUNA)



--- TABELAS DE PREÇOS
INSERT INTO TABELAS_PRECO([CODIGO_TAB_PRECO]
      ,[TABELA]
      ,[MOEDA]
      ,[LANCAMENTO_TABELA]
      ,[DATA_DESATIVACAO]
      ,[ATACADO_VAREJO]
      ,[STATUS]
      ,[ENVIA_LOJA_VAREJO]
      ,[ENVIA_LOJA_ATACADO]
      ,[ENVIA_REPRESENTANTE]
      ,[ENVIA_VAREJO_INTERNET]
      ,[ENVIA_ATACADO_INTERNET]
      ,[INATIVO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[CONDICAO_PGTO]
      ,[OBS]
      ,[CODIGO_TAB_PRECO_BASE]
      ,[PORCENTAGEM_TABELA_BASE]
      ,[PRECO_TIPO]
      ,[EMPRESA]
      ,[BLOQ_ATUALIZACAO_BASE]
      ,[LX_STATUS_REGISTRO])
SELECT [CODIGO_TAB_PRECO]
      ,[TABELA]
      ,[MOEDA]
      ,[LANCAMENTO_TABELA]
      ,[DATA_DESATIVACAO]
      ,[ATACADO_VAREJO]
      ,[STATUS]
      ,[ENVIA_LOJA_VAREJO]
      ,[ENVIA_LOJA_ATACADO]
      ,[ENVIA_REPRESENTANTE]
      ,[ENVIA_VAREJO_INTERNET]
      ,[ENVIA_ATACADO_INTERNET]
      ,[INATIVO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[CONDICAO_PGTO]
      ,[OBS]
      ,[CODIGO_TAB_PRECO_BASE]
      ,[PORCENTAGEM_TABELA_BASE]
      ,[PRECO_TIPO]
      ,[EMPRESA]
      ,[BLOQ_ATUALIZACAO_BASE]
      ,[LX_STATUS_REGISTRO]
  FROM LDR.DRVAREJO.[dbo].[TABELAS_PRECO]
WHERE CODIGO_TAB_PRECO IN ('VC','VB')


INSERT INTO PRODUTOS_PRECOS([CODIGO_TAB_PRECO]
      ,[PRODUTO]
      ,[PRECO1]
      ,[PRECO2]
      ,[PRECO3]
      ,[PRECO4]
      ,[LIMITE_DESCONTO]
      ,[PROMOCAO_DESCONTO]
      ,[ULT_ATUALIZACAO]
      ,[INICIO_PROMOCAO]
      ,[FIM_PROMOCAO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[MARK_UP_PREVISTO]
      ,[PROMOCAO_ATACADO]
      ,[PRECO_LIQUIDO1]
      ,[PRECO_LIQUIDO2]
      ,[PRECO_LIQUIDO3]
      ,[PRECO_LIQUIDO4]
      ,[LX_STATUS_REGISTRO]
      ,[LX_HASH])
SELECT [CODIGO_TAB_PRECO]='VC'
      ,[PRODUTO]
      ,[PRECO1]=0.00
      ,[PRECO2]=0.00
      ,[PRECO3]=0.00
      ,[PRECO4]=0.00
      ,[LIMITE_DESCONTO]
      ,[PROMOCAO_DESCONTO]
      ,[ULT_ATUALIZACAO]
      ,[INICIO_PROMOCAO]
      ,[FIM_PROMOCAO]
      ,[DATA_PARA_TRANSFERENCIA]
      ,[MARK_UP_PREVISTO]
      ,[PROMOCAO_ATACADO]
      ,[PRECO_LIQUIDO1]=0.00
      ,[PRECO_LIQUIDO2]=0.00
      ,[PRECO_LIQUIDO3]=0.00
      ,[PRECO_LIQUIDO4]=0.00
      ,[LX_STATUS_REGISTRO]
      ,[LX_HASH]
FROM [DRLINGERIE].[dbo].[PRODUTOS_PRECOS]
WHERE CODIGO_TAB_PRECO='VA' --'VC'

SELECT * FROM PRODUTOS_PRECOS
WHERE CODIGO_TAB_PRECO='VC'


UPDATE PRODUTOS_PRECOS
SET   [PRECO_LIQUIDO1]=0.00
      ,[PRECO_LIQUIDO2]=0.00
      ,[PRECO_LIQUIDO3]=0.00
      ,[PRECO_LIQUIDO4]=0.00
WHERE CODIGO_TAB_PRECO='VC'


INSERT INTO MATERIAIS_PRECO
SELECT [CODIGO_TAB_PRECO]='VB'
      ,[MATERIAL]=A.MATERIAL
      ,[COR_MATERIAL]=A.COR_MATERIAL
      ,[PRECO]=0.00
      ,[PRECO_DESCONTO]=0.00
FROM [DRLINGERIE].[dbo].[MATERIAIS_CORES] A
LEFT JOIN MATERIAIS_PRECO B ON B.MATERIAL=A.MATERIAL AND B.COR_MATERIAL=A.COR_MATERIAL
--WHERE CODIGO_TAB_PRECO='VB'


----FIM

--- CHEQUES A PAGAR
---- CREDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,[RATEIO_CENTRO_CUSTO]='8620'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]='000003'
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
--JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
--JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_CHEQUE A
	JOIN LDR.DRVAREJO.DBO.W_CTB_CHEQUE B ON B.LANCAMENTO=A.LANCAMENTO
	WHERE B.VALOR_A_PAGAR>0
)

---- DEBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMD'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='DEBITO REF'
      ,[CODIGO_HISTORICO]='LMD'
      ,[RATEIO_CENTRO_CUSTO]='8602'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]='000003'
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
--JOIN LDR.DRVAREJO.dbo.CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.CLIFOR=A.COD_CLIFOR
--JOIN CADASTRO_CLI_FOR D WITH (NOLOCK) ON D.REF_ANTERIOR=C.CLIFOR
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_CHEQUE A
	JOIN LDR.DRVAREJO.DBO.W_CTB_CHEQUE B ON B.LANCAMENTO=A.LANCAMENTO
	WHERE B.VALOR_A_PAGAR>0
)


--- CHEQUES A PAGAR
INSERT INTO CTB_CHEQUE
SELECT C. [LANCAMENTO]
      ,A.[ITEM]
      ,A.[EMISSAO]
      ,A.[FAVORECIDO_CHEQUE]
      ,A.[VALOR_CHEQUE]
      ,A.[NUMERO_CHEQUE]
      ,A.[CONTA_CONTABIL]
      ,A.[VENCIMENTO]
      ,A.[EMITIDO]
      ,A.[EMITE_RECIBO]
      ,A.[RECIBO_IMPRESSO]
      ,A.[EMPRESA]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[MOEDA]
      ,A.[COD_CLIFOR]
      ,A.[VALOR_CHEQUE_PADRAO]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[CANCELADO]
      ,A.[USUARIO_ASSINADO]
      ,A.[DATA_MOV_ASSINADO]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[BANCO_FAVORECIDO]
      ,A.[AGENCIA_FAVORECIDO]
      ,A.[CONTA_CORRENTE_FAVORECIDO]
      ,A.[CGC_CPF_FAVORECIDO]
FROM LDR.DRVAREJO.DBO.CTB_CHEQUE A WITH (NOLOCK)
JOIN LDR.DRVAREJO.DBO.W_CTB_CHEQUE B WITH (NOLOCK) ON B.LANCAMENTO=A.LANCAMENTO
JOIN CTB_LANCAMENTO C WITH (NOLOCK) ON C.NUMERO_CORRELATIVO=A.LANCAMENTO
WHERE B.VALOR_A_PAGAR>0


---- SOMA DE VALORES PARA OS LANÇAMENTOS CONTAS A PAGAR
---- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_CHEQUE) FROM CTB_CHEQUE A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ECH' AND DEBITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 
--WHERE B.LANCAMENTO<>'222287'


--- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
SELECT * FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_CHEQUE) FROM CTB_CHEQUE A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ECH') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM='10'+RTRIM(A.ITEM) 
--WHERE B.LANCAMENTO<>'222287' AND B.LX_TIPO_LANCAMENTO='LMD'



--- CHEQUE A RECEBER
---- DEBITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]
      ,[CREDITO]=0.00
      ,[DEBITO]=0.00
      ,[HISTORICO]
      ,[CODIGO_HISTORICO]
      ,[RATEIO_CENTRO_CUSTO]='8620'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00
      ,[CREDITO_MOEDA]=0.00
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]='000003'
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_CHEQUE_CARTAO A
	WHERE A.VALOR_A_RECEBER>0
)

---- CREDITO
INSERT INTO CTB_LANCAMENTO_ITEM
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]+100
      ,[CONTA_CONTABIL]='9990001'
      ,[LX_TIPO_LANCAMENTO]='LMC'
      ,[CREDITO]=0.00--=A.DEBITO
      ,[DEBITO]=0.00--=A.CREDITO
      ,[HISTORICO]='CREDITO REF'
      ,[CODIGO_HISTORICO]='LMC'
      ,[RATEIO_CENTRO_CUSTO]='8602'
      ,A.[CONCILIADO]
      ,A.[PERMITE_ALTERACAO]
      ,A.[DISPARA_FORMULA]
      ,[DEBITO_MOEDA]=0.00--=A.CREDITO_MOEDA
      ,[CREDITO_MOEDA]=0.00--=A.DEBITO_MOEDA
      ,A.[GERADO_AUTOMATICO_TIPO]
      ,A.[DATA_DIGITACAO]
      ,[RATEIO_FILIAL]='000003'
      ,[COD_CLIFOR]='000003'
      ,A.[MOEDA]
      ,A.[CAMBIO_NA_DATA]
      ,A.[ID_CONTRAPARTIDA]
      ,[VALOR_FINANCEIRO]=0.00
      ,[VALOR_FINANCEIRO_PADRAO]=0.00
      ,A.[DATA_MOV]
      ,A.[USUARIO_MOV]
      ,A.[DOCUMENTO]
FROM LDR.DRVAREJO.DBO.[CTB_LANCAMENTO_ITEM] A WITH (NOLOCK) 
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
WHERE RTRIM(CAST(B.NUMERO_CORRELATIVO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4)) IN(
	SELECT RTRIM(CAST(A.LANCAMENTO AS CHAR(8)))+CAST(A.ITEM AS CHAR(4))
	FROM LDR.DRVAREJO.DBO.CTB_CHEQUE_CARTAO A
	WHERE A.VALOR_A_RECEBER>0
)

--- CHEQUES A RECEBER
INSERT INTO CTB_CHEQUE_CARTAO
SELECT A.[EMPRESA]
      ,B.[LANCAMENTO]
      ,A.[ITEM]
      ,A.[SUB_ITEM]
      ,A.[CONTA_PORTADOR]
      ,A.[LX_TIPO_DOCUMENTO]
      ,A.[CODIGO_CONSUMIDOR]
      ,[COD_FILIAL]='000003'
      ,A.[CODIGO_ADMINISTRADORA]
      ,A.[DATA_EMISSAO]
      ,A.[VENDA_DOCUMENTO]
      ,A.[NUMERO_CHEQUE_CARTAO]
      ,A.[DATA_DIGITACAO]
      ,A.[VENDA_TOTAL_PARCELAMENTO]
      ,A.[INDICA_CARTAO]
      ,A.[CHEQUE_AGENCIA]
      ,A.[VENCIMENTO]
      ,A.[CHEQUE_CONTA_CORRENTE]
      ,A.[PRORROGACAO]
      ,A.[ORIGEM]
      ,A.[VALOR_ORIGINAL]
      ,A.[NUMERO_DEVOLUCOES]
      ,A.[TAXA_ADMINISTRACAO]
      ,A.[GUIA_ENVIO]
      ,A.[CHEQUE_BANCO]
      ,A.[VENDA_PARCELAMENTO]
      ,A.[CMC7_CVCARTAO]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[COD_CLIFOR]=C.CLIFOR
      ,A.[LOJA_TERMINAL]
      ,A.[LOJA_LANCAMENTO_CAIXA]
      ,A.[LOJA_PARCELA]
      ,A.[VALOR_A_RECEBER]
      ,A.[VENCIMENTO_REAL]
      ,A.[NR_DEVOLUCOES]
      ,A.[LX_PARCELA]
      ,A.[VENDA_ITEM_PGTO]
      ,A.[NUMERO_APROVACAO_CARTAO]
      ,A.[LX_CONCILIADO]
      ,A.[LX_DATA_CONCILIACAO]
      ,A.[USUARIO_CONCILIACAO]
      ,A.[DIVERGENCIA_CONCILIACAO]
      ,A.[LOJA_TIPO_PGTO]
      ,A.[MOEDA]
      ,A.[VALOR_ORIGINAL_PADRAO]
      ,A.[CAMBIO_NA_DATA_EMISSAO]
      ,A.[CAMBIO_FIXO_PGTO]
      ,A.[IMPOSTO_DEDUTIVEL]
      ,A.[IMPOSTO_RETIDO]
      ,A.[COD_CLIFOR_RESPONSAVEL]
      ,A.[DATA_VENDA_CONCILIACAO]
      ,A.[CODIGO_FILIAL_REMESSA]
      ,A.[LOTE_REMESSA]
      ,A.[ID_ARQUIVO_FIN]
      ,A.[ITEM_ARQUIVO_FIN]
      ,A.[ID_ARQUIVO_VEN]
      ,A.[ITEM_ARQUIVO_VEN]
FROM LDR.DRVAREJO.dbo.CTB_CHEQUE_CARTAO A WITH (NOLOCK)
JOIN CTB_LANCAMENTO B WITH (NOLOCK) ON B.NUMERO_CORRELATIVO=A.LANCAMENTO
JOIN CADASTRO_CLI_FOR C WITH (NOLOCK) ON C.REF_ANTERIOR=A.COD_CLIFOR
WHERE VALOR_A_RECEBER>0


---- SOMA DE VALORES PARA OS LANÇAMENTOS CONTAS A PAGAR
---- DEBITO
UPDATE B
SET B.DEBITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_A_RECEBER) FROM CTB_CHEQUE_CARTAO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ICH' AND DEBITO=0) B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM 


--- CREDITO
UPDATE B
SET B.CREDITO=A.CREDITO
FROM (
SELECT A.LANCAMENTO,A.ITEM,CREDITO=SUM(A.VALOR_A_RECEBER) FROM CTB_CHEQUE_CARTAO A
JOIN (SELECT * FROM CTB_LANCAMENTO_ITEM
WHERE CONTA_CONTABIL='9990001' AND LX_TIPO_LANCAMENTO='ICH') B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
GROUP BY A.LANCAMENTO,A.ITEM
) A
JOIN CTB_LANCAMENTO_ITEM B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=RTRIM(A.ITEM)+100 




------------- IMPORTAÇÃO DE CLIENTES SEM MOVIMENTOS --------------------------
---
SELECT * FROM SEQUENCIAIS
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'

UPDATE SEQUENCIAIS
SET SEQUENCIA='510038'
WHERE TABELA_COLUNA='CLIENTES_ATACADO.CLIFOR'


--- CADASTRO_CLI_FOR 
INSERT INTO CADASTRO_CLI_FOR
           ([NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,[CONTA_CONTABIL]
           ,[CLIFOR]
           ,[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,[INATIVO]
           ,[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,[COD_CLIFOR]
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,[CLI_FOR])
SELECT A.[NOME_CLIFOR]
           ,[CARTEIRA]
           ,[BANCO]
           ,A.[CONTA_CONTABIL]
           ,CAST('510036' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row1
           ,A.[CGC_CPF]
           ,[RAZAO_SOCIAL]
           ,[PJ_PF]
           ,[RG_IE]
           ,[CEP]
           ,[ENDERECO]
           ,[BAIRRO]
           ,[CIDADE]
           ,[UF]
           ,[TELEFONE1]
           ,[PAIS]
           ,[DDI]
           ,[TELEFONE2]
           ,[FAX]
           ,[DDD1]
           ,[RAMAL1]
           ,[RAMAL2]
           ,[DDD2]
           ,[COBRANCA_ENDERECO]
           ,[COBRANCA_CIDADE]
           ,[COBRANCA_BAIRRO]
           ,[DDDFAX]
           ,[COBRANCA_UF]
           ,[COBRANCA_CEP]
           ,[COBRANCA_TELEFONE]
           ,[ENTREGA_ENDERECO]
           ,[ENTREGA_CIDADE]
           ,[ENTREGA_UF]
           ,[ENTREGA_BAIRRO]
           ,[ENTREGA_CEP]
           ,[ENTREGA_TELEFONE]
           ,[COBRANCA_DDD]
           ,[CONTATO]
           ,[COBRANCA_CGC]
           ,[CADASTRAMENTO]
           ,[COBRANCA_IE]
           ,[ANIVERSARIO]
           ,[INDICA_FORNECEDOR]
           ,[INDICA_CLIENTE]
           ,[IND_REPRESENTANTE]
           ,[INDICA_FILIAL]
           ,[ENTREGA_DDD]
           ,[ENTREGA_CGC]
           ,[ENTREGA_IE]
           ,[CC_AGENCIA]
           ,[CC_CONTA]
           ,[CC_NOME_AGENCIA]
           ,[REF_ANTERIOR]
           ,[ATUALIZACAO_EXPORTAR]
           ,[DATA_EXPORTACAO]
           ,[EMAIL]
           ,[STATUS_ENVIO]
           ,A.[INATIVO]
           ,A.[DATA_PARA_TRANSFERENCIA]
           ,[ENTREGA_PAIS]
           ,[COBRANCA_PAIS]
           ,[ENTREGA_DDI]
           ,[COBRANCA_DDI]
           ,[OBS_DE_FATURAMENTO]
           ,[ISENTO_IPI]
           ,[ISENTO_ICMS]
           ,A.[IRRF]
           ,[MESES_SEM_VENCIMENTO]
           ,[DATA_FIXA_PGTO]
           ,[ACEITA_AGRUPAR_FATURA]
           ,[PASSWEB]
           ,[VENCIMENTO_PASSWEB]
           ,[NUMERO_VIAS_FATURA]
           ,[REPORT_FATURA]
           ,[DIAS_ANTECIPACAO_PGTO]
           ,[POSSUI_RECARGO]
           ,[CODIGO_CHAVE]
           ,[TIPO_RELACAO_COMERCIAL]
           ,[ID_CLASIF_CLIFOR]
           ,CAST('510036' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row2
           ,[ENTREGA_RAZAO_SOCIAL]
           ,[COBRANCA_RAZAO_SOCIAL]
           ,[INDICADOR_FISCAL_TERCEIRO]
           ,A.[CTB_CONTA_CONTABIL]
           ,[ACEITA_DIAS_FIXO]
           ,[ID_EXCECAO_GRUPO]
           ,[AGRUPAMENTO_ITENS]
           ,[CODIGO_CONTATO]
           ,[IM]
           ,[IM_ENTREGA]
           ,[IM_COBRANCA]
           --,[NOVO_CLIENTE]
           --,[EXPORTADO]
           --,[ID_CLIENTE_SERVIDOR]
           ,[CADASTRO_CLI_FOR]
           ,[INSCRICAO_SUFRAMA]
           ,[NUMERO]
           ,[COMPLEMENTO]
           ,[COBRANCA_NUMERO]
           ,[COBRANCA_COMPLEMENTO]
           ,[ENTREGA_NUMERO]
           ,[ENTREGA_COMPLEMENTO]
           ,[CNAE]
           ,[INCL_AUTO_GRP_ECON]
           ,[EMAIL_NFE]
           ,[COD_MUNICIPIO_IBGE]
           ,[COD_MUNICIPIO_IBGE_ENTREGA]
           ,[COD_MUNICIPIO_IBGE_COBRANCA]
           ,[CODIGO_SPC]
           ,[ENVIADO_SPC]
           ,[IEST]
           ,[LX_STATUS_REGISTRO]
           ,[CLINR_SEQUENCIA_ROTA]
           ,[CLICN_CODIGO_ROTA]
           ,CAST('510036' AS INT)+ ROW_NUMBER() OVER(ORDER BY A.CLIFOR) AS Row3
FROM LDR.DRVAREJO.DBO.[CADASTRO_CLI_FOR] A
WHERE A.CGC_CPF='01958862000194' AND  NOT EXISTS (SELECT * FROM CADASTRO_CLI_FOR WHERE CGC_CPF=A.CGC_CPF) 



--- CLIENTES ATACADO ( REPRESENTANTES/GERENTES )
INSERT INTO CLIENTES_ATACADO
SELECT [CLIENTE_ATACADO]
      ,B.[CLIFOR]
      ,[CONDICAO_PGTO]
      ,[REGIAO]
      ,[MATRIZ_CLIENTE]
      ,[FILIAL]
      ,[PONTUALIDADE]
      ,'NOSSO CARRO'--[TRANSPORTADORA]
      ,[CONCEITO]
      ,[TIPO]
      ,[TIPO_BLOQUEIO]
      ,A.[CGC_CPF]
      ,B.[CLIFOR]
      ,[FRETE_A_PAGAR]
      ,[PRIORIDADE]
      ,[SEM_CREDITO]
      ,[LIMITE_CREDITO]
      ,[BLOQUEIO_EXPEDICAO]
      ,[BLOQUEIO_FATURAMENTO]
      ,[ACEITA_JUNTAR_PED]
      ,[BLOQUEIO_PEDIDOS]
      ,[NUMERO_PEDIDOS]
      ,[DATA_MAIOR_PEDIDO]
      ,[MAIOR_PEDIDO]
      ,[DATA_MAIOR_QTDE_PEDIDO]
      ,[MAIOR_QTDE_PEDIDO]
      ,[MAIOR_SALDO]
      ,[DATA_MAIOR_SALDO]
      ,[NUMERO_ATRASOS]
      ,[MAIOR_ATRASO]
      ,[PGTOS_CARTORIO]
      ,[NUMERO_DEVOLUCOES]
      ,[DATA_MAIOR_DEVOLUCAO]
      ,[MAIOR_DEVOLUCAO]
      ,[DATA_MAIOR_QTDE_DEV]
      ,[MAIOR_QTDE_DEV]
      ,[NUMERO_PRORROGACOES]
      ,[MAIOR_PRORROGACAO]
      ,[DESCONTO_FATURAMENTO]
      ,[OBS]
      ,A.[INATIVO]
      ,[MOEDA]
      ,A.[DATA_PARA_TRANSFERENCIA]
      ,[INDICA_FRANQUIA]
      ,'01'--[CODIGO_TAB_PRECO]
      ,[FATOR_CUSTO_FRANQUIA]
      ,[DESCONTO_PEDIDO_VENDA]
      ,[SEGURO_NUMERO_CONTRATO]
      ,[SEGURO_NUMERO_CLIENTE]
      ,[SEGURO_VALIDADE]
      ,A.[CONTA_CONTABIL] 
      ,A.[MESES_SEM_VENCIMENTO]
      ,[EXPEDICAO_COMPLETO_PEDIDO]
      ,[EXPEDICAO_COMPLETO_PACK]
      ,[EXPEDICAO_COMPLETO_TAMANHOS]
      ,[EXPEDICAO_COMPLETO_COR]
      ,[EXPEDICAO_COMPLETO_COORDENADO]
      ,[EXPEDICAO_COMPLETO_CARTELA]
      ,[EXPEDICAO_PORCENTAGEM_MAIOR]
      ,[EXPEDICAO_PORCENTAGEM_MINIMA]
      ,[EXPEDICAO_PORCENTAGEM_TIPO]
      ,[EXPEDICAO_VALOR_MAXIMO]
      ,[CONTA_CONTABIL_ANTECIPACAO]
      ,'NOSSO CARRO'--[TRANSP_REDESPACHO]
      ,[CONTA_CONTABIL_VENDAS_TIPO]
      ,'NOSSO CARRO'--[TRANSPORTADORA2]
      ,'1125001001'--[CTB_CONTA_CONTABIL]
      ,[EXPEDICAO_COMPLETO_FAIXAS]
      ,[DESCONTO_BRUTO]
      ,[DESCONTO_BRUTO_1]
      ,[DESCONTO_BRUTO_2]
      ,[DESCONTO_BRUTO_3]
      ,[DESCONTO_BRUTO_4]
      ,[DESCONTO_SOBRE_1]
      ,[DESCONTO_SOBRE_2]
      ,[DESCONTO_SOBRE_3]
      ,[DESCONTO_SOBRE_4]
      ,[EXPEDICAO_PORC_ADEQUACAO]
      ,[EXPEDICAO_QTDE_ADEQUACAO]
      ,[EXPEDICAO_ADEQUACAO_COR]
      ,[EXPEDICAO_ADEQUACAO_TAMANHO]
      ,[MULTI_DESCONTO_ACUMULAR]
      ,[INDICADOR_VENDA]
      ,[DATA_MAIOR_ATRASO]
      ,[MAIOR_VALOR_FATURADO]
      ,[DATA_MAIOR_VALOR_FATURADO]
      ,[DT_ULTIMA_VENDA]
      ,[DT_PENULTIMA_VENDA]
      ,[DT_ANTEPENULTIMA_VENDA]
      ,[DT_PRIMEIRA_VENDA]
      ,[CONTEUDO_XPED_NFE]
  FROM LDR.DRVAREJO.DBO.[CLIENTES_ATACADO] A
JOIN CADASTRO_CLI_FOR B ON B.NOME_CLIFOR=A.CLIENTE_ATACADO  
WHERE B.CLIFOR IN('510036','510037') AND 
NOT EXISTS(SELECT * FROM CLIENTES_ATACADO WHERE COD_CLIENTE=B.CLIFOR)

SELECT * FROM CADASTRO_CLI_FOR
WHERE NOME_CLIFOR='ANAHI CONFECCOES'

SELECT * FROM CLIENTES_ATACADO
WHERE REGIAO='RV-08 ZN-01 ST-21'

