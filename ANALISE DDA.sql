---- FUNÇÃO MODULO 11
SELECT DBO.MODULO11('2379114700000426960054020001260000701242120')

---- TABELAS
SELECT *  FROM CTB_ARQ_CONCILIACAO

SELECT * FROM REDES_CARTAO

SELECT ID_ARQUIVO + ROW_NUMBER() OVER(ORDER BY ID_ARQUIVO) AS ID_ARQUIVO FROM CTB_ARQ_CONCILIACAO

INSERT INTO [TESTES].[dbo].[CTB_ARQ_CONCILIACAO]
           ([ID_ARQUIVO]
           ,[NOME_ARQUIVO]
           ,[DATA_RECEBIMENTO]
           ,[REDE]
           ,[LAYOUT]
           ,[STATUS])
     VALUES
           (1
           ,'PG010300.RET'
           ,'20160318'
           ,'1'
           ,'0193'
           ,1)

SELECT * FROM CTB_ARQ_CONCILIACAO_DDA

DELETE FROM CTB_ARQ_CONCILIACAO_DDA

INSERT INTO [TESTES].[dbo].[CTB_ARQ_CONCILIACAO_DDA]
           ([ID_ARQUIVO]
           ,[ITEM_ARQUIVO]
           ,[DUPLICATA]
           ,[CODIGO_BARRA]
           ,[EMISSAO]
           ,[VENCIMENTO]
           ,[VALOR_TITULO]
           ,[EMPRESA]
           ,[LANCAMENTO]
           ,[ITEM]
           ,[ID_PARCELA]
           ,[AGENCIA]
           ,[BANCO]
           ,[NUMERO_CONTA_CORRENTE]
           ,[CONTA_CONTABIL]
           ,[LAYOUT]
           ,[LX_STATUS_CONCILIACAO]
           ,[LINHA_DIG]
           ,[RAZAO_SOCIAL]
           ,[CNPJ]
           ,[AVALISTA]
           ,[CNPJ_AVALISTA]
           ,[CNPJ_FILIAL]
           ,[MOVIMENTO])
VALUES
           (1
           ,1
           ,'0035666'
           ,'34192668400130071731126825852062938056328000'
           ,'20151027'
           ,'20160325'
           ,130071.73
           ,1
           ,278180
           ,1
           ,'A'
           ,''
           ,''
           ,''
           ,'21201   '
           ,'0193'
           ,0
           ,'34191126892585206293180563280009266840013007173'
           ,'INVISTA ELASTANO'
           ,'00021096000417'
           ,''
           ,''
           ,''
           ,'01')
GO



SELECT * FROM CTB_BORDERO_LAYOUT

SP_HELP CTB_ARQ_CONCILIACAO_DDA

exec LX_CONCILIATION_JOB

---- PROCEDURES
EXEC LX_CTB_CONCILIACAO_DDA 
EXEC LX_CTB_GERA_ARQ_CONCILIACAO_DDA  
EXEC LX_CTB_GERA_NOVO_TITULO_DDA 


USE [TESTES]
GO

/****** Object:  Table [dbo].[RETORNO_DESCONTO_DDA]    Script Date: 03/21/2016 13:43:16 ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO

SET ANSI_PADDING ON
GO

CREATE TABLE [dbo].[RETORNO_DESCONTO_DDA](
	[LINHA_RETORNO] [char](500) NOT NULL,
	[SEQUENCIAL] [char](10) NOT NULL,
 CONSTRAINT [PK_RETORNO_DESCONTO_DDA] PRIMARY KEY CLUSTERED 
(
	[SEQUENCIAL] ASC
)WITH (PAD_INDEX  = OFF, STATISTICS_NORECOMPUTE  = OFF, IGNORE_DUP_KEY = OFF, ALLOW_ROW_LOCKS  = ON, ALLOW_PAGE_LOCKS  = ON) ON [PRIMARY]
) ON [PRIMARY]

GO

SET ANSI_PADDING OFF
GO


alter table retorno_desconto_dda alter column SEQUENCIAL char(10) not null


SELECT * FROM RETORNO_DESCONTO_DDA
ORDER BY LINHA_RETORNO

delete from RETORNO_DESCONTO_DDA

SELECT * FROM CADASTRO_CLI_FOR
WHERE CGC_CPF='00021096000417'



SELECT B.* FROM CTB_A_PAGAR_FATURA A
JOIN CTB_A_PAGAR_PARCELA B ON B.LANCAMENTO=A.LANCAMENTO AND B.ITEM=A.ITEM
JOIN CADASTRO_CLI_FOR C ON C.CLIFOR=A.COD_CLIFOR
WHERE C.CGC_CPF='00021096000417' AND NOT EXISTS(SELECT * FROM CTB_A_PAGAR_MOV WHERE LANCAMENTO_MOV=B.LANCAMENTO AND ITEM_MOV=B.ITEM)



SELECT * FROM CTB_A_PAGAR_MOV




UPDATE CTB_A_PAGAR_PARCELA
SET VENCIMENTO='20160325', VENCIMENTO_REAL='20160325'
WHERE LANCAMENTO='278180' AND ITEM=1







------------------------ CODIGOS DE BARRAS -------------------------------

ITAÚ
34192668400130071731126825852062938056328000

BRADESCO
23794114700000426960054020001260000701242120


34191126892585206293180563280009266840013007173
