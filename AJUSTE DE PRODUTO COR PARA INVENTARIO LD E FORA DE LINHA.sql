exec sp_executesql N'
/* lx005015spk  CursorAdapter: cur_v_estoque_prod_contagem_00_itens(Alias: v_estoque_prod_contagem_00_itens)  */
SELECT   ESTOQUE_PROD_CTG_ITENS.PRODUTO, ESTOQUE_PROD_CTG_ITENS.COR_PRODUTO, ESTOQUE_PROD_CTG_ITENS.NOME_CONTAGEM, 
ESTOQUE_PROD_CTG_ITENS.QTDE_CONTAGEM,   ESTOQUE_PROD_CTG_ITENS.SALDO_CONTAGEM, QTDE_CONTAGEM-SALDO_CONTAGEM AS 
DIFERENCA_TOTAL,   ESTOQUE_PROD_CTG_ITENS.Q1, ESTOQUE_PROD_CTG_ITENS.Q2, ESTOQUE_PROD_CTG_ITENS.Q3, 
ESTOQUE_PROD_CTG_ITENS.Q4, ESTOQUE_PROD_CTG_ITENS.Q5,   ESTOQUE_PROD_CTG_ITENS.Q6, ESTOQUE_PROD_CTG_ITENS.Q7, 
ESTOQUE_PROD_CTG_ITENS.Q8, ESTOQUE_PROD_CTG_ITENS.Q9, ESTOQUE_PROD_CTG_ITENS.Q10,   ESTOQUE_PROD_CTG_ITENS.Q11, 
ESTOQUE_PROD_CTG_ITENS.Q12, ESTOQUE_PROD_CTG_ITENS.Q13, ESTOQUE_PROD_CTG_ITENS.Q14, ESTOQUE_PROD_CTG_ITENS.Q15,   
ESTOQUE_PROD_CTG_ITENS.Q16, 0 AS Q17, 0 AS Q18, 0 AS Q19, 0 AS Q20,   0 AS Q21, 0 AS Q22, 0 AS Q23, 0 AS Q24, 0 AS Q25,   
0 AS Q26, 0 AS Q27, 0 AS Q28, 0 AS Q29, 0 AS Q30,   0 AS Q31, 0 AS Q32, 0 AS Q33, 0 AS Q34, 0 AS Q35,   0 AS Q36, 
0 AS Q37, 0 AS Q38, 0 AS Q39, 0 AS Q40,   0 AS Q41, 0 AS Q42, 0 AS Q43, 0 AS Q44, 0 AS Q45,   0 AS Q46, 0 AS Q47, 
0 AS Q48,   ESTOQUE_PROD_CTG_ITENS.S1, ESTOQUE_PROD_CTG_ITENS.S2, ESTOQUE_PROD_CTG_ITENS.S3, ESTOQUE_PROD_CTG_ITENS.S4, 
ESTOQUE_PROD_CTG_ITENS.S5,   ESTOQUE_PROD_CTG_ITENS.S6, ESTOQUE_PROD_CTG_ITENS.S7, ESTOQUE_PROD_CTG_ITENS.S8, 
ESTOQUE_PROD_CTG_ITENS.S9, ESTOQUE_PROD_CTG_ITENS.S10,   ESTOQUE_PROD_CTG_ITENS.S11, ESTOQUE_PROD_CTG_ITENS.S12, 
ESTOQUE_PROD_CTG_ITENS.S13, ESTOQUE_PROD_CTG_ITENS.S14, ESTOQUE_PROD_CTG_ITENS.S15,   ESTOQUE_PROD_CTG_ITENS.S16, 
0 AS S17, 0 AS S18, 0 AS S19, 0 AS S20,   0 AS S21, 0 AS S22, 0 AS S23, 0 AS S24, 0 AS S25,   0 AS S26, 0 AS S27, 
0 AS S28, 0 AS S29, 0 AS S30,   0 AS S31, 0 AS S32, 0 AS S33, 0 AS S34, 0 AS S35,   0 AS S36, 0 AS S37, 0 AS S38, 
0 AS S39, 0 AS S40,   0 AS S41, 0 AS S42, 0 AS S43, 0 AS S44, 0 AS S45,   0 AS S46, 0 AS S47, 0 AS S48,   
PRODUTOS.DESC_PRODUTO, PRODUTOS.GRUPO_PRODUTO, PRODUTOS.SUBGRUPO_PRODUTO, PRODUTOS.GRADE, PRODUTOS.UNIDADE, 
PRODUTOS.PESO, PRODUTOS.REVENDA,   PRODUTO_CORES.DESC_COR_PRODUTO, PRODUTO_CORES.COR_SORTIDA, PRODUTO_CORES.COR_FABRICANTE, 
PRODUTOS.REFER_FABRICANTE,   ESTOQUE_PROD_CTG_ITENS.Q1-ESTOQUE_PROD_CTG_ITENS.S1 AS D1, Q2-S2 AS D2, Q3-S3 AS D3, 
Q4-S4 AS D4, Q5-S5 AS D5, Q6-S6 AS D6, Q7-S7 AS D7, Q8-S8 AS D8,   Q9-S9 AS D9, Q10-S10 AS D10, Q11-S11 AS D11, 
Q12-S12 AS D12, Q13-S13 AS D13, Q14-S14 AS D14, Q15-S15 AS D15, Q16-S16 AS D16, Q17-S17 AS D17,   Q18-S18 AS D18, 
Q19-S19 AS D19, Q20-S20 AS D20, Q21-S21 AS D21, Q22-S22 AS D22, Q23-S23 AS D23, Q24-S24 AS D24, Q25-S25 AS D25, 
Q26-S26 AS D26,   Q27-S27 AS D27, Q28-S28 AS D28, Q29-S29 AS D29, Q30-S30 AS D30, Q31-S31 AS D31, Q32-S32 AS D32, 
Q33-S33 AS D33, Q34-S34 AS D34, Q35-S35 AS D35,   Q36-S36 AS D36, Q37-S37 AS D37, Q38-S38 AS D38, Q39-S39 AS D39, 
Q40-S40 AS D40, Q41-S41 AS D41, Q42-S42 AS D42, Q43-S43 AS D43, Q44-S44 AS D44,   Q45-S45 AS D45, Q46-S46 AS D46, 
Q47-S47 AS D47, Q48-S48 AS D48,  PRODUTOS.PONTEIRO_PRECO_TAM, PRODUTOS.VARIA_PRECO_COR, PRODUTOS.VARIA_PRECO_TAM,  
PRODUTO_CORES.CUSTO_REPOSICAO1, PRODUTO_CORES.CUSTO_REPOSICAO2, PRODUTO_CORES.CUSTO_REPOSICAO3, PRODUTO_CORES.CUSTO_REPOSICAO4,
  ESTOQUE_PRODUTOS.CUSTO_MEDIO1, ESTOQUE_PRODUTOS.CUSTO_MEDIO2, ESTOQUE_PRODUTOS.CUSTO_MEDIO3, ESTOQUE_PRODUTOS.CUSTO_MEDIO4,  
  CONVERT(NUMERIC(14,2),0) AS CUSTO4_A_VALORIZAR, CONVERT(NUMERIC(14,2),0) AS CUSTO3_A_VALORIZAR, CONVERT(NUMERIC(14,2),0) 
  AS CUSTO2_A_VALORIZAR, CONVERT(NUMERIC(14,2),0) AS CUSTO1_A_VALORIZAR,    CONVERT(NUMERIC(14,2),0) 
  AS VALOR_CONTAGEM_DIFERENCA 
  FROM   ESTOQUE_PROD_CTG_ITENS   
  INNER JOIN PRODUTOS ON ESTOQUE_PROD_CTG_ITENS.PRODUTO =   PRODUTOS.PRODUTO   
  INNER JOIN PRODUTO_CORES ON ESTOQUE_PROD_CTG_ITENS.PRODUTO = PRODUTO_CORES.PRODUTO 
  AND  ESTOQUE_PROD_CTG_ITENS.COR_PRODUTO = PRODUTO_CORES.COR_PRODUTO   
  INNER JOIN ESTOQUE_PROD_CONTAGEM ON  ESTOQUE_PROD_CTG_ITENS.NOME_CONTAGEM = ESTOQUE_PROD_CONTAGEM.NOME_CONTAGEM  
  INNER JOIN ESTOQUE_PRODUTOS ON ESTOQUE_PROD_CTG_ITENS.PRODUTO = ESTOQUE_PRODUTOS.PRODUTO 
  AND ESTOQUE_PROD_CTG_ITENS.COR_PRODUTO = ESTOQUE_PRODUTOS.COR_PRODUTO   
  AND ESTOQUE_PROD_CONTAGEM.FILIAL = ESTOQUE_PRODUTOS.FILIAL 
  WHERE   ESTOQUE_PROD_CTG_ITENS.NOME_CONTAGEM = @P1  
  ORDER BY   ESTOQUE_PROD_CTG_ITENS.PRODUTO, ESTOQUE_PROD_CTG_ITENS.COR_PRODUTO',N'@P1 varchar(22)','RGIS_INV_ABRIL_2013_LD'

-- LD
SELECT RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) FROM   ESTOQUE_PROD_CTG_ITENS   
WHERE NOME_CONTAGEM='RGIS_INV_ABRIL_2013_LD' AND RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) NOT IN (SELECT RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) FROM  ESTOQUE_PRODUTOS WHERE FILIAL='LD')


-- FORA DE LINHA
SELECT RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) FROM   ESTOQUE_PROD_CTG_ITENS   
WHERE NOME_CONTAGEM='RGIS_INV_ABRIL_2013_FDL' AND RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) NOT IN (SELECT RTRIM(PRODUTO)+RTRIM(COR_PRODUTO) FROM  ESTOQUE_PRODUTOS WHERE FILIAL='FORA DE LINHA')




