SELECT C.FILIAL, A.ORDEM_PRODUCAO,A.PRODUTO,A.COR_PRODUTO,A.NF_SAIDA,A.SERIE_NF,C.EMISSAO,D.INDICADOR_TIPO_MOV,
F9_QTDE_O=A.QTDE_O,F9_O1=A.O1,F9_O2=A.O2,F9_O3=A.O3,F9_O4=A.O4,F9_O5=A.O5,F9_O6=A.O6,F9_O7=A.O7,F9_O8=A.O8,F9_O9=A.O9,F9_O10=A.O10,F9_O11=A.O11,F9_O12=A.O12,F9_O13=A.O13,F9_O14=A.O14,F9_O15=A.O15,F9_O16=A.O16,
F10_QTDE_O=B.QTDE_O,F10_O1=B.O1,F10_O2=B.O2,F10_O3=B.O3,F10_O4=B.O4,F10_O5=B.O5,F10_O6=B.O6,F10_O7=B.O7,F10_O8=B.O8,F10_O9=B.O9,F10_O10=B.O10,F10_O11=B.O11,F10_O12=B.O12,F10_O13=B.O13,F10_O14=B.O14,F10_O15=B.O15,F10_O16=B.O16 
FROM W_ORDEM_PRODUCAO_RETORNO A
LEFT JOIN W_ORDEM_PRODUCAO_RECEBIMENTO B ON B.ORDEM_PRODUCAO=A.ORDEM_PRODUCAO AND B.PRODUTO=A.PRODUTO AND B.COR_PRODUTO=A.COR_PRODUTO
LEFT JOIN FATURAMENTO C WITH (NOLOCK) ON C.NF_SAIDA=A.NF_SAIDA AND C.SERIE_NF=A.SERIE_NF
LEFT JOIN (SELECT DISTINCT B.ORDEM_PRODUCAO,'PERDA NO PROCESSO' AS INDICADOR_TIPO_MOV FROM PRODUCAO_ORDEM_SERVICO A
JOIN PRODUCAO_OS_TAREFAS B ON B.ORDEM_SERVICO=A.ORDEM_SERVICO
WHERE A.INDICADOR_TIPO_MOV=4) AS D ON D.ORDEM_PRODUCAO=A.ORDEM_PRODUCAO
WHERE C.EMISSAO>'20141231'
