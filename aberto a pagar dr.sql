/* lx009028spk  CursorAdapter: CUR_V_CTB_A_PAGAR_FATURA_01_PARCELA(Alias: v_ctb_a_pagar_fatura_01_parcela)  */
SELECT   W_CTB_A_PAGAR_PARCELA.EMPRESA, W_CTB_A_PAGAR_PARCELA.LANCAMENTO, W_CTB_A_PAGAR_PARCELA.TIPO_MOVIMENTO,       W_CTB_A_PAGAR_PARCELA.DESC_TIPO_MOVIMENTO, W_CTB_A_PAGAR_PARCELA.LOTE_LANCAMENTO,             W_CTB_A_PAGAR_PARCELA.LANCAMENTO_PADRAO, 
W_CTB_A_PAGAR_PARCELA.GERADO_INTEGRACAO,             W_CTB_A_PAGAR_PARCELA.DATA_LANCAMENTO, W_CTB_A_PAGAR_PARCELA.COD_FILIAL_LANCAMENTO,            W_CTB_A_PAGAR_PARCELA.FILIAL_LANCAMENTO, W_CTB_A_PAGAR_PARCELA.ITEM,             W_CTB_A_PAGAR_PARCELA.CONTA_CONTABIL, 
W_CTB_A_PAGAR_PARCELA.DESC_CONTA,             W_CTB_A_PAGAR_PARCELA.LX_TIPO_LANCAMENTO, W_CTB_A_PAGAR_PARCELA.DESC_TIPO_LANCAMENTO,             W_CTB_A_PAGAR_PARCELA.HISTORICO, W_CTB_A_PAGAR_PARCELA.RATEIO_CENTRO_CUSTO,             
W_CTB_A_PAGAR_PARCELA.DESC_RATEIO_CENTRO_CUSTO, W_CTB_A_PAGAR_PARCELA.CONCILIADO,             W_CTB_A_PAGAR_PARCELA.DATA_DIGITACAO, W_CTB_A_PAGAR_PARCELA.RATEIO_FILIAL,             W_CTB_A_PAGAR_PARCELA.DESC_RATEIO_FILIAL, W_CTB_A_PAGAR_PARCELA.COD_CLIFOR,             
W_CTB_A_PAGAR_PARCELA.NOME_CLIFOR, W_CTB_A_PAGAR_PARCELA.CGC_CPF, W_CTB_A_PAGAR_PARCELA.RAZAO_SOCIAL,        W_CTB_A_PAGAR_PARCELA.MOEDA_LANCAMENTO, W_CTB_A_PAGAR_PARCELA.CAMBIO_NA_DATA_LANCAMENTO,             W_CTB_A_PAGAR_PARCELA.FATURA, W_CTB_A_PAGAR_PARCELA.ESPECIE_SERIE,             W_CTB_A_PAGAR_PARCELA.LX_TIPO_DOCUMENTO, W_CTB_A_PAGAR_PARCELA.TIPO_DOCUMENTO,             W_CTB_A_PAGAR_PARCELA.EMISSAO, W_CTB_A_PAGAR_PARCELA.FATURA_SERIE, W_CTB_A_PAGAR_PARCELA.FATURA_OK,          W_CTB_A_PAGAR_PARCELA.POSSUI_ENTRADA, W_CTB_A_PAGAR_PARCELA.PROVISAO,             W_CTB_A_PAGAR_PARCELA.COMPLEMENTO_NOME, W_CTB_A_PAGAR_PARCELA.TAXA_JUROS,             W_CTB_A_PAGAR_PARCELA.CAMBIO_NA_DATA_EMISSAO, W_CTB_A_PAGAR_PARCELA.TAXA_MULTA,             W_CTB_A_PAGAR_PARCELA.DATA_ENTRADA, W_CTB_A_PAGAR_PARCELA.NUMERO_ENTRADA,             W_CTB_A_PAGAR_PARCELA.COD_FILIAL, W_CTB_A_PAGAR_PARCELA.FILIAL, W_CTB_A_PAGAR_PARCELA.MOEDA,             W_CTB_A_PAGAR_PARCELA.ID_PARCELA, W_CTB_A_PAGAR_PARCELA.BANCO, W_CTB_A_PAGAR_PARCELA.CONTA_PORTADOR,             W_CTB_A_PAGAR_PARCELA.DESC_CONTA_PORTADOR, W_CTB_A_PAGAR_PARCELA.DATA_DESCONTO_VENC,             W_CTB_A_PAGAR_PARCELA.DESCONTO_VENC, W_CTB_A_PAGAR_PARCELA.NUMERO_BANCARIO,             W_CTB_A_PAGAR_PARCELA.VENCIMENTO, W_CTB_A_PAGAR_PARCELA.DIAS_PRORROGADOS,             W_CTB_A_PAGAR_PARCELA.PAGAMENTO_APROVADO, W_CTB_A_PAGAR_PARCELA.CODIGO_BARRA,             W_CTB_A_PAGAR_PARCELA.VENCIMENTO_REAL, W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL,             W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL_PADRAO, W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR,             W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR_PADRAO, W_CTB_A_PAGAR_PARCELA.SALDO_PRINCIPAL_DEVIDO,             W_CTB_A_PAGAR_PARCELA.SALDO_MULTA_GERADA, W_CTB_A_PAGAR_PARCELA.SALDO_JUROS_GERADO,             W_CTB_A_PAGAR_PARCELA.SALDO_DESCONTO_OBTIDO, W_CTB_A_PAGAR_PARCELA.TOTAL_PRINCIPAL_PAGO,             W_CTB_A_PAGAR_PARCELA.TOTAL_MULTA_PAGA, W_CTB_A_PAGAR_PARCELA.TOTAL_JUROS_PAGO,             W_CTB_A_PAGAR_PARCELA.TOTAL_DESCONTO_EFETIVADO, W_CTB_A_PAGAR_PARCELA.TOTAL_MULTA_GERADA,             W_CTB_A_PAGAR_PARCELA.TOTAL_JUROS_GERADO, W_CTB_A_PAGAR_PARCELA.TOTAL_DESCONTO_OBTIDO,             CTB_ESPECIE_SERIE.DESC_ESPECIE_SERIE, BANCOS.NOME_BANCO,             W_CTB_A_PAGAR_PARCELA.TOTAL_PRINCIPAL_PAGO_PADRAO, W_CTB_A_PAGAR_PARCELA.POSICAO,             W_CTB_A_PAGAR_PARCELA.PERIODO, W_CTB_A_PAGAR_PARCELA.TIPO, W_CTB_A_PAGAR_PARCELA.SUBTIPO_FORNECEDOR,             W_CTB_A_PAGAR_PARCELA.ID_CARTEIRA_COBRANCA, W_CTB_A_PAGAR_PARCELA.CARTEIRA,             W_CTB_A_PAGAR_PARCELA.LOTE_DOCUMENTO_PA, W_CTB_A_PAGAR_PARCELA.LOTE_DOCUMENTO_CP,             W_CTB_A_PAGAR_PARCELA.MATRIZ_CONTABIL, W_CTB_A_PAGAR_PARCELA.COD_MATRIZ_CONTABIL,            W_CTB_A_PAGAR_PARCELA.CONTA_CONTABIL_CONTRAPARTIDA, W_CTB_A_PAGAR_PARCELA.DESC_CONTA_CONTRAPARTIDA,             W_CTB_A_PAGAR_PARCELA.COD_CLIFOR_SACADO, W_CTB_A_PAGAR_PARCELA.NOME_CLIFOR_SACADO,             W_CTB_A_PAGAR_PARCELA.TIPO_FORNECEDOR, W_CTB_A_PAGAR_PARCELA.VALOR_OUTRAS_ENTIDADES,             W_CTB_A_PAGAR_PARCELA.VALOR_FINANCEIRO, W_CTB_A_PAGAR_PARCELA.VALOR_FINANCEIRO_PADRAO,             W_CTB_A_PAGAR_PARCELA.PRAZO_PAGAMENTO_REAL, W_CTB_A_PAGAR_PARCELA.PRAZO_COMPRA,             W_CTB_A_PAGAR_PARCELA.PRAZO_PAGAMENTO_MEDIO, W_CTB_A_PAGAR_PARCELA.TOTAL_MULTA_PAGA_PADRAO,             W_CTB_A_PAGAR_PARCELA.TOTAL_JUROS_PAGO_PADRAO, W_CTB_A_PAGAR_PARCELA.TOTAL_DESCONTO_EFETIVADO_PADRAO,             W_CTB_A_PAGAR_PARCELA.TOTAL_DESCONTO_EFETIVADO_PADRAO, W_CTB_A_PAGAR_PARCELA.DOCUMENTO,             W_CTB_A_PAGAR_PARCELA.NUMERO_CORRELATIVO, W_CTB_A_PAGAR_PARCELA.ID_DADOS_ARRECADACAO,             W_CTB_A_PAGAR_PARCELA.VALOR_PREVISAO_IMPOSTO,      W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO,            W_CTB_A_PAGAR_PARCELA.LX_TIPO_DOCUMENTO_PARCELA,      W_CTB_A_PAGAR_PARCELA.TIPO_DOCUMENTO_PARCELA,      STATUS_CONCILIACAO = CASE WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'FV' THEN 'FINANCEIRO VALIDAR'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'FN' THEN 'FINANCEIRO NAO VALIDADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'FD' THEN 'FINANCEIRO VALIDADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DR' THEN 'PRONTO PARA REMESSA'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DG' THEN 'DOCUMENTO AGENDADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DC' THEN 'DOCUMENTO CANCELAR'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DL' THEN 'DOCUMENTO EM LOTE'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DE' THEN 'ARQUIVO GERADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DV' THEN 'CANCELADO ENVIADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DO' THEN 'DOCUMENTO DEVOLVIDO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DI' THEN 'DIVERGENCIA'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DD' THEN 'DOCUMENTO CANCELADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'DQ' THEN 'DOCUMENTO QUITADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'E1' THEN 'CODIGO DE BARRA NAO INFORMADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'E2' THEN 'BANCO/CONTA DO FORNECEDOR NÃO INFORMADO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'E3' THEN 'VALOR NAO ESTA DE ACORDO COM O TIPO DE PAGTO'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'E4' THEN 'BANCO ORIGEM E DESTINO IGUAIS, UTILIZAR TRANSF.'             WHEN W_CTB_A_PAGAR_PARCELA.LX_STATUS_CONCILIACAO = 'E5' THEN 'BANCO ORIGEM E DESTINO DIFERENTES, UTILIZAR DOC/TED'             END             FROM   {OJ{OJ  W_CTB_A_PAGAR_PARCELA W_CTB_A_PAGAR_PARCELA      LEFT OUTER JOIN DBO.BANCOS BANCOS                ON  W_CTB_A_PAGAR_PARCELA.BANCO = BANCOS.BANCO}      LEFT OUTER JOIN DBO.CTB_ESPECIE_SERIE CTB_ESPECIE_SERIE                ON  W_CTB_A_PAGAR_PARCELA.ESPECIE_SERIE = CTB_ESPECIE_SERIE.ESPECIE_SERIE} WHERE w_ctb_a_pagar_parcela.VALOR_A_pagar > 0

 

SELECT W_CTB_A_PAGAR_PARCELA.VENCIMENTO,--W_CTB_A_PAGAR_PARCELA.VENCIMENTO_REAL, 
sum(W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL) as VALOR_ORIGINAL,             
sum(W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL_PADRAO) as VALOR_ORIGINAL_PADRAO, 
sum(W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR) as VALOR_A_PAGAR,             
sum(W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR_PADRAO) as VALOR_A_PAGAR_PADRAO, 
sum(W_CTB_A_PAGAR_PARCELA.SALDO_PRINCIPAL_DEVIDO) as SALDO_PRINCIPAL_DEVIDO
FROM   {OJ{OJ  W_CTB_A_PAGAR_PARCELA W_CTB_A_PAGAR_PARCELA      
LEFT OUTER JOIN DBO.BANCOS BANCOS                ON  W_CTB_A_PAGAR_PARCELA.BANCO = BANCOS.BANCO}      
LEFT OUTER JOIN DBO.CTB_ESPECIE_SERIE CTB_ESPECIE_SERIE                ON  W_CTB_A_PAGAR_PARCELA.ESPECIE_SERIE = CTB_ESPECIE_SERIE.ESPECIE_SERIE} 
WHERE w_ctb_a_pagar_parcela.VALOR_A_pagar > 0
group by W_CTB_A_PAGAR_PARCELA.VENCIMENTO--_REAL
order by W_CTB_A_PAGAR_PARCELA.VENCIMENTO--_REAL


SELECT W_CTB_A_PAGAR_PARCELA.COD_FILIAL,W_CTB_A_PAGAR_PARCELA.MOEDA,
sum(W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL) as VALOR_ORIGINAL,             
sum(W_CTB_A_PAGAR_PARCELA.VALOR_ORIGINAL_PADRAO) as VALOR_ORIGINAL_PADRAO, 
sum(W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR) as VALOR_A_PAGAR,             
sum(W_CTB_A_PAGAR_PARCELA.VALOR_A_PAGAR_PADRAO) as VALOR_A_PAGAR_PADRAO, 
sum(W_CTB_A_PAGAR_PARCELA.SALDO_PRINCIPAL_DEVIDO) as SALDO_PRINCIPAL_DEVIDO
FROM   {OJ{OJ  W_CTB_A_PAGAR_PARCELA W_CTB_A_PAGAR_PARCELA      
LEFT OUTER JOIN DBO.BANCOS BANCOS                ON  W_CTB_A_PAGAR_PARCELA.BANCO = BANCOS.BANCO}      
LEFT OUTER JOIN DBO.CTB_ESPECIE_SERIE CTB_ESPECIE_SERIE                ON  W_CTB_A_PAGAR_PARCELA.ESPECIE_SERIE = CTB_ESPECIE_SERIE.ESPECIE_SERIE} 
WHERE w_ctb_a_pagar_parcela.VALOR_A_pagar > 0
GROUP BY W_CTB_A_PAGAR_PARCELA.COD_FILIAL,W_CTB_A_PAGAR_PARCELA.MOEDA
