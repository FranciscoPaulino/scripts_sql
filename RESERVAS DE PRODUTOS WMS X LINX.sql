--- PEDIDO MAIOR QUE ORIGINAL
SELECT * FROM VENDAS_PRODUTO
WHERE QTDE_ORIGINAL-(QTDE_ENTREGUE+QTDE_EMBALADA)<0 AND PEDIDO='75409'

exec SP_INCLUIR_CAIXA_WMS_LINX_PEDIDO '75409'

--- Qtde vindas do Wms x Linx
SELECT A.PEDIDO,A.PRODUTO,A.COR_PRODUTO,
A.E1,A.E2,A.E3,A.E4,A.E5,A.E6,A.E7,A.E8,A.E9,A.E10,A.E11,A.E12,A.E13,A.E14,A.E15,A.E16,
B.VO1,B.VO2,B.VO3,B.VO4,B.VO5,B.VO6,B.VO7,B.VO8,B.VO9,B.VO10,B.VO11,B.VO12,B.VO13,B.VO14,B.VO15,B.VO16,
F1=ISNULL(C.F1,0),F2=ISNULL(C.F2,0),F3=ISNULL(C.F3,0),F4=ISNULL(C.F4,0),F5=ISNULL(C.F5,0),F6=ISNULL(C.F6,0),F7=ISNULL(C.F7,0),F8=ISNULL(C.F8,0),
F9=ISNULL(C.F9,0),F10=ISNULL(C.F10,0),F11=ISNULL(C.F11,0),F12=ISNULL(C.F12,0),F13=ISNULL(C.F13,0),F14=ISNULL(C.F14,0),F15=ISNULL(C.F15,0),F16=ISNULL(C.F16,0),
D1=(B.VO1-ISNULL(C.F1,0)-A.E1),
D2=(B.VO2-ISNULL(C.F2,0)-A.E2),
D3=(B.VO3-ISNULL(C.F3,0)-A.E3),
D4=(B.VO4-ISNULL(C.F4,0)-A.E4),
D5=(B.VO5-ISNULL(C.F5,0)-A.E5),
D6=(B.VO6-ISNULL(C.F6,0)-A.E6),
D7=(B.VO7-ISNULL(C.F7,0)-A.E7),
D8=(B.VO8-ISNULL(C.F8,0)-A.E8),
D9=(B.VO9-ISNULL(C.F9,0)-A.E9),
D10=(B.VO10-ISNULL(C.F10,0)-A.E10),
D11=(B.VO11-ISNULL(C.F11,0)-A.E11),
D12=(B.VO12-ISNULL(C.F12,0)-A.E12),
D13=(B.VO13-ISNULL(C.F13,0)-A.E13),
D14=(B.VO14-ISNULL(C.F14,0)-A.E14),
D15=(B.VO15-ISNULL(C.F15,0)-A.E15),
D16=(B.VO16-ISNULL(C.F16,0)-A.E16)
FROM (
	SELECT PEDIDO,PRODUTO,COR_PRODUTO,E1=SUM(E1),E2=SUM(E2),E3=SUM(E3),E4=SUM(E4),E5=SUM(E5),E6=SUM(E6),E7=SUM(E7),E8=SUM(E8),E9=SUM(E9),E10=SUM(E10),E11=SUM(E11),E12=SUM(E12),E13=SUM(E13),E14=SUM(E14),E15=SUM(E15),E16=SUM(E16)
	FROM SoftlogWMS.DBO.W_WMS_LINX_RESERVA_ITEM
	GROUP BY PEDIDO,PRODUTO,COR_PRODUTO
) A 
JOIN VENDAS_PRODUTO B ON B.PEDIDO=A.PEDIDO AND B.PRODUTO=A.PRODUTO AND B.COR_PRODUTO=A.COR_PRODUTO
LEFT JOIN (
	SELECT PEDIDO,PRODUTO,COR_PRODUTO,F1=SUM(F1),F2=SUM(F2),F3=SUM(F3),F4=SUM(F4),F5=SUM(F5),F6=SUM(F6),F7=SUM(F7),F8=SUM(F8),F9=SUM(F9),F10=SUM(F10),F11=SUM(F11),F12=SUM(F12),F13=SUM(F13),F14=SUM(F14),F15=SUM(F15),F16=SUM(F16) 
	FROM FATURAMENTO_PROD 
	GROUP BY PEDIDO,PRODUTO,COR_PRODUTO
) 
C ON C.PEDIDO=A.PEDIDO AND C.PRODUTO=A.PRODUTO AND C.COR_PRODUTO=A.COR_PRODUTO
WHERE --A.PEDIDO='75409'
(B.VO1-ISNULL(C.F1,0)-A.E1)>=0 AND
(B.VO2-ISNULL(C.F2,0)-A.E2)>=0 AND
(B.VO3-ISNULL(C.F3,0)-A.E3)>=0 AND
(B.VO4-ISNULL(C.F4,0)-A.E4)>=0 AND
(B.VO5-ISNULL(C.F5,0)-A.E5)>=0 AND
(B.VO6-ISNULL(C.F6,0)-A.E6)>=0 AND
(B.VO7-ISNULL(C.F7,0)-A.E7)>=0 AND
(B.VO8-ISNULL(C.F8,0)-A.E8)>=0 AND
(B.VO9-ISNULL(C.F9,0)-A.E9)>=0 AND
(B.VO10-ISNULL(C.F10,0)-A.E10)>=0 AND
(B.VO11-ISNULL(C.F11,0)-A.E11)>=0 AND
(B.VO12-ISNULL(C.F12,0)-A.E12)>=0 AND
(B.VO13-ISNULL(C.F13,0)-A.E13)>=0 AND
(B.VO14-ISNULL(C.F14,0)-A.E14)>=0 AND
(B.VO15-ISNULL(C.F15,0)-A.E15)>=0 AND
(B.VO16-ISNULL(C.F16,0)-A.E16)>=0 
AND A.PEDIDO='75409'
order by a.PEDIDO





SELECT * FROM SoftlogWMS.DBO.W_WMS_LINX_RESERVA_ITEM A
where pedido='75409'

WHERE NOT EXISTS(SELECT * FROM FATURAMENTO_PROD WHERE PEDIDO=A.PEDIDO)


SELECT * FROM FATURAMENTO_PROD
WHERE PEDIDO='83159'




DELETE FROM FATURAMENTO_CAIXAS
WHERE CAIXA IN(select CAIXA from SoftlogWMS.DBO.W_WMS_LINX_RESERVA
WHERE PEDIDO='75409')


SELECT * FROM VENDAS
WHERE PEDIDO='576664' 


SELECT PEDIDO, produto,cor_produto,SUM(QTDE) AS QTDE_JA_FATURADA 
FROM FATURAMENTO_PROD 
WHERE PEDIDO = '576656'
GROUP BY PEDIDO, produto,cor_produto


SELECT A.PEDIDO, A.produto,A.cor_produto,b.QTDE_ORIGINAL,SUM(QTDE) AS QTDE_JA_FATURADA 
FROM FATURAMENTO_PROD a
join VENDAS_PRODUTO B ON B.PEDIDO=A.PEDIDO AND B.PRODUTO=A.PRODUTO AND B.COR_PRODUTO=A.COR_PRODUTO
WHERE A.PEDIDO = '586422'
GROUP BY a.PEDIDO, a.produto,a.cor_produto,b.QTDE_ORIGINAL




SELECT * FROM VENDAS_LOTE_PROD_COPIA_PEDIDO
WHERE PEDIDO_EXTERNO='0234l.001156'
 
