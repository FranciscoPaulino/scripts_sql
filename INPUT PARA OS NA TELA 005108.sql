--- busca OS
exec sp_executesql N'
/* lx005108spk  CursorAdapter: cur_v_entradas_00_retorno_beneficiamento_os_selecao(Alias: v_entradas_00_retorno_beneficiamento_os_selecao)  */
SELECT PRODUCAO_RECURSOS.DESC_RECURSO, PRODUCAO_FASE.DESC_FASE_PRODUCAO, PRODUCAO_SETOR.DESC_SETOR_PRODUCAO, PRODUCAO_OS_ANTERIOR.TAREFA, PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO, PRODUCAO_OS_ANTERIOR.COR_ANTERIOR, PRODUCAO_OS_ANTERIOR.QTDE_A, PRODUCAO_OS_ANTERIOR.QTDE_A AS QTDE_NF, PRODUCAO_OS_ANTERIOR.A1, PRODUCAO_OS_ANTERIOR.A2, PRODUCAO_OS_ANTERIOR.A3, PRODUCAO_OS_ANTERIOR.A4, PRODUCAO_OS_ANTERIOR.A5, PRODUCAO_OS_ANTERIOR.A6, PRODUCAO_OS_ANTERIOR.A7, PRODUCAO_OS_ANTERIOR.A8, PRODUCAO_OS_ANTERIOR.A9, PRODUCAO_OS_ANTERIOR.A10, PRODUCAO_OS_ANTERIOR.A11, PRODUCAO_OS_ANTERIOR.A12, PRODUCAO_OS_ANTERIOR.A13, PRODUCAO_OS_ANTERIOR.A14, PRODUCAO_OS_ANTERIOR.A15, PRODUCAO_OS_ANTERIOR.A16, 0 AS A17, 0 AS A18, 0 AS A19, 0 AS A20, 0 AS A21, 0 AS A22, 0 AS A23, 0 AS A24, 0 AS A25, 0 AS A26, 0 AS A27, 0 AS A28, 0 AS A29, 0 AS A30, 0 AS A31, 0 AS A32, 0 AS A33, 0 AS A34, 0 AS A35, 0 AS A36, 0 AS A37, 0 AS A38, 0 AS A39, 0 AS A40, 0 AS A41, 0 AS A42, 0 AS A43, 0 AS A44, 0 AS 
A45, 0 AS A46, 0 AS A47, 0 AS A48, PRODUCAO_OS_ANTERIOR.CUSTO_EFETIVO, CONVERT(NUMERIC(5,2),100) AS PORC_VALOR, CONVERT(NUMERIC(5,2),100) AS PORC_QTDE, CAST((CASE WHEN ISNULL(PRODUCAO_OS_ANTERIOR.QTDE_A, 0) = 0 THEN 0 ELSE 
((PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO / PRODUCAO_OS_ANTERIOR.QTDE_A ) + PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO ) END ) AS NUMERIC(20,6)) AS CUSTO_CHEIO, PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO, 
PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO, PRODUCAO_OS_ANTERIOR.TIMESTAMP, PRODUCAO_OS_ANTERIOR.ITEM_IMPRESSAO, PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_TAREFAS.RECURSO_PRODUTIVO, PRODUCAO_TAREFAS.FASE_PRODUCAO, 
PRODUCAO_TAREFAS.SETOR_PRODUCAO, PRODUCAO_ORDEM_SERVICO.DATA AS DATA_SERVICO, PRODUCAO_ORDEM_SERVICO.CONFERIDO_POR, PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO_PARALELA, PRODUCAO_ORDEM_SERVICO.FILIAL, 
PRODUCAO_ORDEM_SERVICO.NF_SAIDA, PRODUCAO_ORDEM_SERVICO.SERIE_NF, PRODUCAO_ORDEM_SERVICO.NF_ENTRADA, PRODUCAO_ORDEM_SERVICO.INDICADOR_TIPO_MOV, PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR, 
PRODUCAO_ORDEM_SERVICO.SERIE_NF_ENTRADA, PRODUCAO_RECURSOS.NOME_CLIFOR, PRODUTOS.DESC_PRODUTO, PRODUTO_CORES.DESC_COR_PRODUTO,PRODUTOS.GRADE, ISNULL(PRODUTOS_INDICADOR_CFOP.INDICADOR_CFOP, CASE WHEN 
ISNULL(FILIAIS.INDICA_CFOP_SOMENTE_REVENDA, 0) = 1 AND PRODUTOS.INDICADOR_CFOP = 10 THEN 11 ELSE PRODUTOS.INDICADOR_CFOP END) AS INDICADOR_CFOP,PRODUTOS.CLASSIF_FISCAL, PRODUTOS.UNIDADE, PRODUTOS.TRIBUT_ORIGEM, 
PRODUTOS.TRIBUT_ICMS, PRODUTOS.CONTA_CONTABIL, PRODUTOS_TAMANHOS.NUMERO_TAMANHOS, PRODUCAO_OS_ANTERIOR.CUSTO_MATERIAL_TERCEIRO FROM PRODUCAO_OS_ANTERIOR PRODUCAO_OS_ANTERIOR INNER JOIN PRODUCAO_OS_TAREFAS 
PRODUCAO_OS_TAREFAS ON (((PRODUCAO_OS_ANTERIOR.TAREFA = PRODUCAO_OS_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_OS_TAREFAS.ORDEM_SERVICO ) AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO = 
PRODUCAO_OS_TAREFAS.ORDEM_PRODUCAO ) AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUCAO_OS_TAREFAS.PRODUTO ) AND PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUCAO_OS_TAREFAS.COR_PRODUTO INNER JOIN DBO.PRODUTOS PRODUTOS ON PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTOS.PRODUTO INNER JOIN DBO.PRODUTO_CORES PRODUTO_CORES ON PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUTO_CORES.COR_PRODUTO AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTO_CORES.PRODUTO INNER JOIN PRODUCAO_ORDEM_SERVICO PRODUCAO_ORDEM_SERVICO ON PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO INNER JOIN PRODUCAO_TAREFAS PRODUCAO_TAREFAS ON (PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR=PRODUCAO_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO=PRODUCAO_TAREFAS.ORDEM_PRODUCAO) INNER JOIN PRODUCAO_RECURSOS PRODUCAO_RECURSOS ON PRODUCAO_TAREFAS.RECURSO_PRODUTIVO = PRODUCAO_RECURSOS.RECURSO_PRODUTIVO INNER JOIN PRODUCAO_FASE PRODUCAO_FASE ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_FASE.FASE_PRODUCAO INNER JOIN PRODUCAO_SETOR PRODUCAO_SETOR ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_SETOR.FASE_PRODUCAO AND PRODUCAO_TAREFAS.SETOR_PRODUCAO = PRODUCAO_SETOR.SETOR_PRODUCAO INNER JOIN FILIAIS ON FILIAIS.FILIAL = @P1 LEFT JOIN PRODUTOS_INDICADOR_CFOP ON PRODUTOS_INDICADOR_CFOP.PRODUTO = PRODUCAO_OS_ANTERIOR.PRODUTO AND PRODUTOS_INDICADOR_CFOP.FILIAL = FILIAIS.FILIAL JOIN PRODUTOS_TAMANHOS ON (PRODUTOS.GRADE=PRODUTOS_TAMANHOS.GRADE) WHERE Producao_ordem_servico.ORDEM_SERVICO like ''574849'' AND  IsNull(Producao_ordem_servico.NF_ENTRADA,'''')='''' AND IsNull(Producao_ordem_servico.SERIE_NF_ENTRADA,'''')=''''  AND (PRODUCAO_ORDEM_SERVICO.ACERTO_ENTRADA = 0) AND(PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR = (@P2 ) ) ORDER BY PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO',N'@P1 varchar(9),@P2 varchar(17)','DR VAREJO','ATHENA CONFECÇÕES'



exec sp_executesql N'
/* lx005108spk  CursorAdapter: cur_v_entradas_00_retorno_beneficiamento_os_selecao(Alias: v_entradas_00_retorno_beneficiamento_os_selecao)  */
SELECT PRODUCAO_RECURSOS.DESC_RECURSO, PRODUCAO_FASE.DESC_FASE_PRODUCAO, PRODUCAO_SETOR.DESC_SETOR_PRODUCAO, PRODUCAO_OS_ANTERIOR.TAREFA, PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO, PRODUCAO_OS_ANTERIOR.COR_ANTERIOR, PRODUCAO_OS_ANTERIOR.QTDE_A, PRODUCAO_OS_ANTERIOR.QTDE_A AS QTDE_NF, PRODUCAO_OS_ANTERIOR.A1, PRODUCAO_OS_ANTERIOR.A2, PRODUCAO_OS_ANTERIOR.A3, PRODUCAO_OS_ANTERIOR.A4, PRODUCAO_OS_ANTERIOR.A5, PRODUCAO_OS_ANTERIOR.A6, PRODUCAO_OS_ANTERIOR.A7, PRODUCAO_OS_ANTERIOR.A8, PRODUCAO_OS_ANTERIOR.A9, PRODUCAO_OS_ANTERIOR.A10, PRODUCAO_OS_ANTERIOR.A11, PRODUCAO_OS_ANTERIOR.A12, PRODUCAO_OS_ANTERIOR.A13, PRODUCAO_OS_ANTERIOR.A14, PRODUCAO_OS_ANTERIOR.A15, PRODUCAO_OS_ANTERIOR.A16, 0 AS A17, 0 AS A18, 0 AS A19, 0 AS A20, 0 AS A21, 0 AS A22, 0 AS A23, 0 AS A24, 0 AS A25, 0 AS A26, 0 AS A27, 0 AS A28, 0 AS A29, 0 AS A30, 0 AS A31, 0 AS A32, 0 AS A33, 0 AS A34, 0 AS A35, 0 AS A36, 0 AS A37, 0 AS A38, 0 AS A39, 0 AS A40, 0 AS A41, 0 AS A42, 0 AS A43, 0 AS A44, 0 AS 
A45, 0 AS A46, 0 AS A47, 0 AS A48, PRODUCAO_OS_ANTERIOR.CUSTO_EFETIVO, CONVERT(NUMERIC(5,2),100) AS PORC_VALOR, CONVERT(NUMERIC(5,2),100) AS PORC_QTDE, CAST((CASE WHEN ISNULL(PRODUCAO_OS_ANTERIOR.QTDE_A, 0) = 0 THEN 0 ELSE 
((PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO / PRODUCAO_OS_ANTERIOR.QTDE_A ) + PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO ) END ) AS NUMERIC(20,6)) AS CUSTO_CHEIO, PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO, 
PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO, PRODUCAO_OS_ANTERIOR.TIMESTAMP, PRODUCAO_OS_ANTERIOR.ITEM_IMPRESSAO, PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_TAREFAS.RECURSO_PRODUTIVO, PRODUCAO_TAREFAS.FASE_PRODUCAO, 
PRODUCAO_TAREFAS.SETOR_PRODUCAO, PRODUCAO_ORDEM_SERVICO.DATA AS DATA_SERVICO, PRODUCAO_ORDEM_SERVICO.CONFERIDO_POR, PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO_PARALELA, PRODUCAO_ORDEM_SERVICO.FILIAL, 
PRODUCAO_ORDEM_SERVICO.NF_SAIDA, PRODUCAO_ORDEM_SERVICO.SERIE_NF, PRODUCAO_ORDEM_SERVICO.NF_ENTRADA, PRODUCAO_ORDEM_SERVICO.INDICADOR_TIPO_MOV, PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR, 
PRODUCAO_ORDEM_SERVICO.SERIE_NF_ENTRADA, PRODUCAO_RECURSOS.NOME_CLIFOR, PRODUTOS.DESC_PRODUTO, PRODUTO_CORES.DESC_COR_PRODUTO,PRODUTOS.GRADE, ISNULL(PRODUTOS_INDICADOR_CFOP.INDICADOR_CFOP, CASE WHEN 
ISNULL(FILIAIS.INDICA_CFOP_SOMENTE_REVENDA, 0) = 1 AND PRODUTOS.INDICADOR_CFOP = 10 THEN 11 ELSE PRODUTOS.INDICADOR_CFOP END) AS INDICADOR_CFOP,PRODUTOS.CLASSIF_FISCAL, PRODUTOS.UNIDADE, PRODUTOS.TRIBUT_ORIGEM, 
PRODUTOS.TRIBUT_ICMS, PRODUTOS.CONTA_CONTABIL, PRODUTOS_TAMANHOS.NUMERO_TAMANHOS, PRODUCAO_OS_ANTERIOR.CUSTO_MATERIAL_TERCEIRO FROM PRODUCAO_OS_ANTERIOR PRODUCAO_OS_ANTERIOR INNER JOIN PRODUCAO_OS_TAREFAS 
PRODUCAO_OS_TAREFAS ON (((PRODUCAO_OS_ANTERIOR.TAREFA = PRODUCAO_OS_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_OS_TAREFAS.ORDEM_SERVICO ) AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO = 
PRODUCAO_OS_TAREFAS.ORDEM_PRODUCAO ) AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUCAO_OS_TAREFAS.PRODUTO ) AND PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUCAO_OS_TAREFAS.COR_PRODUTO INNER JOIN DBO.PRODUTOS PRODUTOS ON PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTOS.PRODUTO INNER JOIN DBO.PRODUTO_CORES PRODUTO_CORES ON PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUTO_CORES.COR_PRODUTO AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTO_CORES.PRODUTO INNER JOIN PRODUCAO_ORDEM_SERVICO PRODUCAO_ORDEM_SERVICO ON PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO INNER JOIN PRODUCAO_TAREFAS PRODUCAO_TAREFAS ON (PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR=PRODUCAO_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO=PRODUCAO_TAREFAS.ORDEM_PRODUCAO) INNER JOIN PRODUCAO_RECURSOS PRODUCAO_RECURSOS ON PRODUCAO_TAREFAS.RECURSO_PRODUTIVO = PRODUCAO_RECURSOS.RECURSO_PRODUTIVO INNER JOIN PRODUCAO_FASE PRODUCAO_FASE ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_FASE.FASE_PRODUCAO INNER JOIN PRODUCAO_SETOR PRODUCAO_SETOR ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_SETOR.FASE_PRODUCAO AND PRODUCAO_TAREFAS.SETOR_PRODUCAO = PRODUCAO_SETOR.SETOR_PRODUCAO INNER JOIN FILIAIS ON FILIAIS.FILIAL = @P1 LEFT JOIN PRODUTOS_INDICADOR_CFOP ON PRODUTOS_INDICADOR_CFOP.PRODUTO = PRODUCAO_OS_ANTERIOR.PRODUTO AND PRODUTOS_INDICADOR_CFOP.FILIAL = FILIAIS.FILIAL JOIN PRODUTOS_TAMANHOS ON (PRODUTOS.GRADE=PRODUTOS_TAMANHOS.GRADE) WHERE Producao_ordem_servico.ORDEM_SERVICO like ''574571'' AND  IsNull(Producao_ordem_servico.NF_ENTRADA,'''')='''' AND IsNull(Producao_ordem_servico.SERIE_NF_ENTRADA,'''')=''''  AND (PRODUCAO_ORDEM_SERVICO.ACERTO_ENTRADA = 0) AND(PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR = (@P2 ) ) ORDER BY PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO',N'@P1 varchar(9),@P2 varchar(17)','DR VAREJO','ATHENA CONFECÇÕES'




exec sp_executesql N'
/* lx005108spk  CursorAdapter: cur_v_entradas_00_retorno_beneficiamento_os(Alias: v_entradas_00_retorno_beneficiamento_os)  */
SELECT PRODUCAO_RECURSOS.DESC_RECURSO, PRODUCAO_FASE.DESC_FASE_PRODUCAO, PRODUCAO_SETOR.DESC_SETOR_PRODUCAO, PRODUCAO_OS_ANTERIOR.TAREFA, PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO, PRODUCAO_OS_ANTERIOR.COR_ANTERIOR, PRODUCAO_OS_ANTERIOR.QTDE_A, PRODUCAO_OS_ANTERIOR.A1, PRODUCAO_OS_ANTERIOR.A2, PRODUCAO_OS_ANTERIOR.A3, PRODUCAO_OS_ANTERIOR.A4, PRODUCAO_OS_ANTERIOR.A5, PRODUCAO_OS_ANTERIOR.A6, PRODUCAO_OS_ANTERIOR.A7, PRODUCAO_OS_ANTERIOR.A8, PRODUCAO_OS_ANTERIOR.A9, PRODUCAO_OS_ANTERIOR.A10, PRODUCAO_OS_ANTERIOR.A11, PRODUCAO_OS_ANTERIOR.A12, PRODUCAO_OS_ANTERIOR.A13, PRODUCAO_OS_ANTERIOR.A14, PRODUCAO_OS_ANTERIOR.A15, PRODUCAO_OS_ANTERIOR.A16, 0 AS A17, 0 AS A18, 0 AS A19, 0 AS A20, 0 AS A21, 0 AS A22, 0 AS A23, 0 AS A24, 0 AS A25, 0 AS A26, 0 AS A27, 0 AS A28, 0 AS A29, 0 AS A30, 0 AS A31, 0 AS A32, 0 AS 
A33, 0 AS A34, 0 AS A35, 0 AS A36, 0 AS A37, 0 AS A38, 0 AS A39, 0 AS A40, 0 AS A41, 0 AS A42, 0 AS A43, 0 AS A44, 0 AS A45, 0 AS A46, 0 AS A47, 0 AS A48, PRODUCAO_OS_ANTERIOR.CUSTO_EFETIVO, 
CAST((CASE WHEN ISNULL(PRODUCAO_OS_ANTERIOR.QTDE_A, 0) = 0 THEN 0 ELSE ((PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO / PRODUCAO_OS_ANTERIOR.QTDE_A ) + PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO ) END ) 
AS NUMERIC(15,5)) AS CUSTO_CHEIO, PRODUCAO_OS_ANTERIOR.DESCONTO_APLICADO, PRODUCAO_OS_ANTERIOR.VALOR_CREDITADO, PRODUCAO_OS_ANTERIOR.TIMESTAMP, PRODUCAO_OS_ANTERIOR.ITEM_IMPRESSAO, 
PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_TAREFAS.RECURSO_PRODUTIVO, PRODUCAO_TAREFAS.FASE_PRODUCAO, PRODUCAO_TAREFAS.SETOR_PRODUCAO, PRODUCAO_ORDEM_SERVICO.DATA AS DATA_SERVICO, 
PRODUCAO_ORDEM_SERVICO.CONFERIDO_POR, PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO_PARALELA, PRODUCAO_ORDEM_SERVICO.FILIAL, PRODUCAO_ORDEM_SERVICO.NF_SAIDA, PRODUCAO_ORDEM_SERVICO.SERIE_NF, 
PRODUCAO_ORDEM_SERVICO.NF_ENTRADA, PRODUCAO_ORDEM_SERVICO.INDICADOR_TIPO_MOV, PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR, PRODUCAO_ORDEM_SERVICO.SERIE_NF_ENTRADA, 
PRODUCAO_RECURSOS.NOME_CLIFOR, PRODUTOS.DESC_PRODUTO, PRODUTO_CORES.DESC_COR_PRODUTO, PRODUTOS.GRADE, ISNULL(PRODUTOS_INDICADOR_CFOP.INDICADOR_CFOP, (CASE WHEN 
ISNULL(FILIAIS.INDICA_CFOP_SOMENTE_REVENDA, 0) = 1 AND PRODUTOS.INDICADOR_CFOP = 10 THEN 11 ELSE PRODUTOS.INDICADOR_CFOP END)) AS INDICADOR_CFOP,PRODUTOS.CLASSIF_FISCAL, PRODUTOS.UNIDADE, 
PRODUTOS.TRIBUT_ORIGEM, PRODUTOS.TRIBUT_ICMS, DBO.FX_CTB_BUSCA_CONTA_ITEM(''E'', ''P'', @P1, @P2, PRODUTOS.PRODUTO, @P3, PRODUTOS.CONTA_CONTABIL) AS CONTA_CONTABIL, 
PRODUCAO_OS_ANTERIOR.CUSTO_MATERIAL_TERCEIRO 
FROM PRODUCAO_OS_ANTERIOR PRODUCAO_OS_ANTERIOR 
INNER JOIN PRODUCAO_OS_TAREFAS PRODUCAO_OS_TAREFAS ON (((PRODUCAO_OS_ANTERIOR.TAREFA = PRODUCAO_OS_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_OS_TAREFAS.ORDEM_SERVICO ) AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO = PRODUCAO_OS_TAREFAS.ORDEM_PRODUCAO ) AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUCAO_OS_TAREFAS.PRODUTO ) AND PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUCAO_OS_TAREFAS.COR_PRODUTO 
INNER JOIN DBO.PRODUTOS PRODUTOS ON PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTOS.PRODUTO 
INNER JOIN DBO.PRODUTO_CORES PRODUTO_CORES ON PRODUCAO_OS_ANTERIOR.COR_PRODUTO = PRODUTO_CORES.COR_PRODUTO AND PRODUCAO_OS_ANTERIOR.PRODUTO = PRODUTO_CORES.PRODUTO 
INNER JOIN PRODUCAO_ORDEM_SERVICO PRODUCAO_ORDEM_SERVICO ON PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO = PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO 
INNER JOIN PRODUCAO_TAREFAS PRODUCAO_TAREFAS ON (PRODUCAO_OS_ANTERIOR.TAREFA_ANTERIOR=PRODUCAO_TAREFAS.TAREFA AND PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO=PRODUCAO_TAREFAS.ORDEM_PRODUCAO) 
INNER JOIN PRODUCAO_RECURSOS PRODUCAO_RECURSOS ON PRODUCAO_TAREFAS.RECURSO_PRODUTIVO = PRODUCAO_RECURSOS.RECURSO_PRODUTIVO 
INNER JOIN PRODUCAO_FASE PRODUCAO_FASE ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_FASE.FASE_PRODUCAO 
INNER JOIN PRODUCAO_SETOR PRODUCAO_SETOR ON PRODUCAO_TAREFAS.FASE_PRODUCAO = PRODUCAO_SETOR.FASE_PRODUCAO AND PRODUCAO_TAREFAS.SETOR_PRODUCAO = PRODUCAO_SETOR.SETOR_PRODUCAO 
INNER JOIN FILIAIS ON FILIAIS.FILIAL = @P4 
LEFT JOIN PRODUTOS_INDICADOR_CFOP ON PRODUTOS_INDICADOR_CFOP.PRODUTO = PRODUTOS.PRODUTO AND PRODUTOS_INDICADOR_CFOP.FILIAL = FILIAIS.FILIAL 
WHERE (PRODUCAO_ORDEM_SERVICO.ACERTO_ENTRADA = 1) AND(PRODUCAO_ORDEM_SERVICO.BENEFICIADOR_TAREFA_ANTERIOR = (@P5 ) AND PRODUCAO_ORDEM_SERVICO.NF_ENTRADA = (@P6 ) ) AND PRODUCAO_ORDEM_SERVICO.SERIE_NF_ENTRADA = (@P7 ) ORDER BY PRODUCAO_ORDEM_SERVICO.ORDEM_SERVICO, PRODUCAO_OS_ANTERIOR.ORDEM_PRODUCAO, PRODUCAO_OS_ANTERIOR.PRODUTO, PRODUCAO_OS_ANTERIOR.COR_PRODUTO',N'@P1 varchar(1),@P2 int,@P3 varchar(6),@P4 varchar(9),@P5 varchar(17),@P6 varchar(4),@P7 varchar(3)','E',240,'240.01','DR VAREJO','ATHENA CONFECÇÕES','1337','101'





--- CABEÇAÇHO
exec sp_executesql N'INSERT INTO ENTRADAS (NF_ENTRADA,NOME_CLIFOR,EMISSAO,FILIAL,EMPRESA,AGRUPAMENTO_ITENS,COD_TRANSACAO,NATUREZA,CONDICAO_PGTO,RECEBIMENTO,NF_FATURA,SERIE_NF_ENTRADA,TABELA_FILHA,TRANSF_FILIAL,TIPO_ENTRADAS,TRANSPORTADORA_A_PAGAR,MOEDA,MOEDA_COMPRA,DATA_DIGITACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,DATA_FATURAMENTO_RELATIVO,UTILIZA_DIAS_FIXOS_FORNECEDOR,NOME_CLIFOR_TRIANGULAR,SERIE_NF,NUMERO_ENTRADA,FATURA_NOME_CLIFOR,FATURA_SERIE,FATURA_NUMERO,DIFERENCA_VALOR,QTDE_TOTAL,VALOR_TOTAL,FRETE_A_PAGAR,IMPORTACAO_IMPOSTO,IMPORTACAO_ICMS,IMPORTACAO_IPI,IMPORTACAO_ALFANDEGA,IMPORTACAO_OUTRAS_DESPESAS,IMPORTACAO_FRETE,IMPORTACAO_SEGURO,IMPORTACAO_DESEMBARACO,PORC_DESCONTO,PORC_ENCARGO,COMISSAO_VALOR,COMISSAO_VALOR_GERENTE,VALOR_IMPOSTO_AGREGAR,VALOR_SUB_ITENS,CAMBIO_NA_DATA,ESPECIE_SERIE,NOTA_CANCELADA,COD_CLIFOR_SACADO,IMPORTACAO_TX_CAPATAZIA,PROTOCOLO_AUTORIZACAO_NFE,CHAVE_NFE,MOTIVO_CANCELAMENTO_NFE,FIN_EMISSAO_NFE,DATA_AUTORIZACAO_NFE,INDICA_PRESENCA_COMPRADOR) 
VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 ,@P39 ,@P40 ,@P41 ,@P42 ,@P43 ,@P44 ,@P45 ,@P46 ,@P47 ,@P48 ,@P49 ,@P50 ,@P51 ,@P52 ,@P53 ,@P54 ,@P55 ,@P56 ,@P57 ,@P58 )',N'@P1 varchar(15),@P2 varchar(25),@P3 datetime,@P4 varchar(25),@P5 int,@P6 smallint,@P7 varchar(23),@P8 varchar(15),@P9 varchar(3),@P10 datetime,@P11 bit,@P12 varchar(6),@P13 varchar(18),@P14 bit,@P15 varchar(25),@P16 varchar(25),@P17 varchar(6),@P18 varchar(6),@P19 datetime,@P20 varchar(15),@P21 varchar(15),@P22 datetime,@P23 bit,@P24 varchar(25),@P25 varchar(6),@P26 int,@P27 varchar(25),@P28 varchar(6),@P29 varchar(15),@P30 bit,@P31 numeric(10,3),@P32 numeric(15,5),@P33 tinyint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 numeric(14,2),@P38 numeric(14,2),@P39 numeric(14,2),@P40 numeric(14,2),@P41 numeric(14,2),@P42 numeric(13,10),@P43 numeric(13,10),@P44 numeric(14,2),@P45 numeric(14,2),@P46 numeric(14,2),@P47 numeric(14,2),@P48 numeric(15,6),@P49 int,@P50 bit,@P51 varchar(6),@P52 numeric(14,2),@P53 varchar(15),@P54 varchar(44),@P55 varchar(255),@P56 tinyint,@P57 datetime,@P58 tinyint','1337           ','ATHENA CONFECÇÕES        ','2015-05-25 00:00:00','DR VAREJO                ',1,3,'ENTRADAS_108           ','240.01         ','000','2015-05-25 00:00:00',0,'101   ','ENTRADAS_NF       ',0,'BENEFICIAMENTO           ','STA TRANSPORTES          ','R$    ','R$    ','2015-05-25 00:00:00','000001         ','8007           ',NULL,0,'ATHENA CONFECÇÕES        ',NULL,NULL,NULL,NULL,NULL,0,150.000,319.50000,1,0,0,0,0,0,0,0,0,0,0,0,0,0,319.50,1.000000,3,0,'601266',0,'123150022216993','23150410884866000166551010000013371806455211','',0,'2015-04-30 21:43:25',0


---- ITENS
exec sp_executesql N'INSERT INTO ENTRADAS_ITEM (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,DESCRICAO_ITEM,QTDE_ITEM,PRECO_UNITARIO,CODIGO_ITEM,DESCONTO_ITEM,VALOR_ITEM,COD_TABELA_FILHA,TRIBUT_ICMS,TRIBUT_ORIGEM,UNIDADE,CLASSIF_FISCAL,CODIGO_FISCAL_OPERACAO,PESO,CONTA_CONTABIL,FAIXA,INDICADOR_CFOP,PORCENTAGEM_ITEM_RATEIO,ID_EXCECAO_IMPOSTO,REFERENCIA,TIMESTAMP,VALOR_ENCARGOS,VALOR_DESCONTOS,VALOR_ENCARGOS_IMPORTACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,VALOR_ENCARGOS_ADUANEIROS,PORC_ITEM_RATEIO_FRETE,ITEM_NFE,MPADRAO_SEGURO_ITEM,MPADRAO_FRETE_ITEM,MPADRAO_ENCARGO_ITEM,ORIGEM_ITEM,PRECO_UNITARIO_ORIGINAL) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 varchar(80),@P7 numeric(9,3),@P8 numeric(15,5),@P9 varchar(50),@P10 numeric(15,5),@P11 numeric(14,2),@P12 varchar(1),@P13 varchar(3),@P14 varchar(3),@P15 varchar(5),@P16 varchar(10),@P17 varchar(4),@P18 numeric(9,5),@P19 varchar(20),@P20 varchar(1),@P21 tinyint,@P22 numeric(13,10),@P23 int,@P24 varchar(50),@P25 varchar(25),@P26 numeric(14,2),@P27 numeric(14,2),@P28 numeric(14,2),@P29 varchar(15),@P30 varchar(15),@P31 numeric(14,2),@P32 numeric(13,10),@P33 smallint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 varchar(1),@P38 numeric(15,5)','ATHENA CONFECÇÕES        ','1337           ','101   ','0001',1,'OS: 574571 - OP: 84220 - SOUTIEN DE BOJO EM SATINETE                            ',30.000,2.13000,'57457184220                                       ',0,63.90,'O','90 ','0  ','PÇ   ','6212.10.00','1902',0,'11401               ','1',10,20.0000000000,1029,'42256                                             ','ÆÆÆÆÆÆÆÆÆÆÆÆÆ2Ø34111     ',0,0,0,'000001         ','8007           ',0,20.0000000000,1,0,0,0,'P',2.13000
exec sp_executesql N'INSERT INTO ENTRADAS_ITEM (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,DESCRICAO_ITEM,QTDE_ITEM,PRECO_UNITARIO,CODIGO_ITEM,DESCONTO_ITEM,VALOR_ITEM,COD_TABELA_FILHA,TRIBUT_ICMS,TRIBUT_ORIGEM,UNIDADE,CLASSIF_FISCAL,CODIGO_FISCAL_OPERACAO,PESO,CONTA_CONTABIL,FAIXA,INDICADOR_CFOP,PORCENTAGEM_ITEM_RATEIO,ID_EXCECAO_IMPOSTO,REFERENCIA,TIMESTAMP,VALOR_ENCARGOS,VALOR_DESCONTOS,VALOR_ENCARGOS_IMPORTACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,VALOR_ENCARGOS_ADUANEIROS,PORC_ITEM_RATEIO_FRETE,ITEM_NFE,MPADRAO_SEGURO_ITEM,MPADRAO_FRETE_ITEM,MPADRAO_ENCARGO_ITEM,ORIGEM_ITEM,PRECO_UNITARIO_ORIGINAL) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 varchar(80),@P7 numeric(9,3),@P8 numeric(15,5),@P9 varchar(50),@P10 numeric(15,5),@P11 numeric(14,2),@P12 varchar(1),@P13 varchar(3),@P14 varchar(3),@P15 varchar(5),@P16 varchar(10),@P17 varchar(4),@P18 numeric(9,5),@P19 varchar(20),@P20 varchar(1),@P21 tinyint,@P22 numeric(13,10),@P23 int,@P24 varchar(50),@P25 varchar(25),@P26 numeric(14,2),@P27 numeric(14,2),@P28 numeric(14,2),@P29 varchar(15),@P30 varchar(15),@P31 numeric(14,2),@P32 numeric(13,10),@P33 smallint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 varchar(1),@P38 numeric(15,5)','ATHENA CONFECÇÕES        ','1337           ','101   ','0002',1,'OS: 574849 - OP: 84220 - SOUTIEN DE BOJO EM SATINETE                            ',30.000,2.13000,'57484984220                                       ',0,63.90,'O','90 ','0  ','PÇ   ','6212.10.00','1902',0,'11401               ','1',10,20.0000000000,1029,'42256                                             ','ÆÆÆÆÆÆÆÆÆÆÆÆÆ2Ø34111     ',0,0,0,'000001         ','8007           ',0,20.0000000000,2,0,0,0,'P',2.13000
exec sp_executesql N'INSERT INTO ENTRADAS_ITEM (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,DESCRICAO_ITEM,QTDE_ITEM,PRECO_UNITARIO,CODIGO_ITEM,DESCONTO_ITEM,VALOR_ITEM,COD_TABELA_FILHA,TRIBUT_ICMS,TRIBUT_ORIGEM,UNIDADE,CLASSIF_FISCAL,CODIGO_FISCAL_OPERACAO,PESO,CONTA_CONTABIL,FAIXA,INDICADOR_CFOP,PORCENTAGEM_ITEM_RATEIO,ID_EXCECAO_IMPOSTO,REFERENCIA,TIMESTAMP,VALOR_ENCARGOS,VALOR_DESCONTOS,VALOR_ENCARGOS_IMPORTACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,VALOR_ENCARGOS_ADUANEIROS,PORC_ITEM_RATEIO_FRETE,ITEM_NFE,MPADRAO_SEGURO_ITEM,MPADRAO_FRETE_ITEM,MPADRAO_ENCARGO_ITEM,ORIGEM_ITEM,PRECO_UNITARIO_ORIGINAL) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 varchar(80),@P7 numeric(9,3),@P8 numeric(15,5),@P9 varchar(50),@P10 numeric(15,5),@P11 numeric(14,2),@P12 varchar(1),@P13 varchar(3),@P14 varchar(3),@P15 varchar(5),@P16 varchar(10),@P17 varchar(4),@P18 numeric(9,5),@P19 varchar(20),@P20 varchar(1),@P21 tinyint,@P22 numeric(13,10),@P23 int,@P24 varchar(50),@P25 varchar(25),@P26 numeric(14,2),@P27 numeric(14,2),@P28 numeric(14,2),@P29 varchar(15),@P30 varchar(15),@P31 numeric(14,2),@P32 numeric(13,10),@P33 smallint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 varchar(1),@P38 numeric(15,5)','ATHENA CONFECÇÕES        ','1337           ','101   ','0003',1,'OS: 575031 - OP: 84220 - SOUTIEN DE BOJO EM SATINETE                            ',30.000,2.13000,'57503184220                                       ',0,63.90,'O','90 ','0  ','PÇ   ','6212.10.00','1902',0,'11401               ','1',10,20.0000000000,1029,'42256                                             ','ÆÆÆÆÆÆÆÆÆÆÆÆÆ2Ø34111     ',0,0,0,'000001         ','8007           ',0,20.0000000000,3,0,0,0,'P',2.13000
exec sp_executesql N'INSERT INTO ENTRADAS_ITEM (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,DESCRICAO_ITEM,QTDE_ITEM,PRECO_UNITARIO,CODIGO_ITEM,DESCONTO_ITEM,VALOR_ITEM,COD_TABELA_FILHA,TRIBUT_ICMS,TRIBUT_ORIGEM,UNIDADE,CLASSIF_FISCAL,CODIGO_FISCAL_OPERACAO,PESO,CONTA_CONTABIL,FAIXA,INDICADOR_CFOP,PORCENTAGEM_ITEM_RATEIO,ID_EXCECAO_IMPOSTO,REFERENCIA,TIMESTAMP,VALOR_ENCARGOS,VALOR_DESCONTOS,VALOR_ENCARGOS_IMPORTACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,VALOR_ENCARGOS_ADUANEIROS,PORC_ITEM_RATEIO_FRETE,ITEM_NFE,MPADRAO_SEGURO_ITEM,MPADRAO_FRETE_ITEM,MPADRAO_ENCARGO_ITEM,ORIGEM_ITEM,PRECO_UNITARIO_ORIGINAL) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 varchar(80),@P7 numeric(9,3),@P8 numeric(15,5),@P9 varchar(50),@P10 numeric(15,5),@P11 numeric(14,2),@P12 varchar(1),@P13 varchar(3),@P14 varchar(3),@P15 varchar(5),@P16 varchar(10),@P17 varchar(4),@P18 numeric(9,5),@P19 varchar(20),@P20 varchar(1),@P21 tinyint,@P22 numeric(13,10),@P23 int,@P24 varchar(50),@P25 varchar(25),@P26 numeric(14,2),@P27 numeric(14,2),@P28 numeric(14,2),@P29 varchar(15),@P30 varchar(15),@P31 numeric(14,2),@P32 numeric(13,10),@P33 smallint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 varchar(1),@P38 numeric(15,5)','ATHENA CONFECÇÕES        ','1337           ','101   ','0004',1,'OS: 575363 - OP: 84220 - SOUTIEN DE BOJO EM SATINETE                            ',30.000,2.13000,'57536384220                                       ',0,63.90,'O','90 ','0  ','PÇ   ','6212.10.00','1902',0,'11401               ','1',10,20.0000000000,1029,'42256                                             ','ÆÆÆÆÆÆÆÆÆÆÆÆÆ2Ø34111     ',0,0,0,'000001         ','8007           ',0,20.0000000000,4,0,0,0,'P',2.13000
exec sp_executesql N'INSERT INTO ENTRADAS_ITEM (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,DESCRICAO_ITEM,QTDE_ITEM,PRECO_UNITARIO,CODIGO_ITEM,DESCONTO_ITEM,VALOR_ITEM,COD_TABELA_FILHA,TRIBUT_ICMS,TRIBUT_ORIGEM,UNIDADE,CLASSIF_FISCAL,CODIGO_FISCAL_OPERACAO,PESO,CONTA_CONTABIL,FAIXA,INDICADOR_CFOP,PORCENTAGEM_ITEM_RATEIO,ID_EXCECAO_IMPOSTO,REFERENCIA,TIMESTAMP,VALOR_ENCARGOS,VALOR_DESCONTOS,VALOR_ENCARGOS_IMPORTACAO,RATEIO_FILIAL,RATEIO_CENTRO_CUSTO,VALOR_ENCARGOS_ADUANEIROS,PORC_ITEM_RATEIO_FRETE,ITEM_NFE,MPADRAO_SEGURO_ITEM,MPADRAO_FRETE_ITEM,MPADRAO_ENCARGO_ITEM,ORIGEM_ITEM,PRECO_UNITARIO_ORIGINAL) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 ,@P19 ,@P20 ,@P21 ,@P22 ,@P23 ,@P24 ,@P25 ,@P26 ,@P27 ,@P28 ,@P29 ,@P30 ,@P31 ,@P32 ,@P33 ,@P34 ,@P35 ,@P36 ,@P37 ,@P38 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 varchar(80),@P7 numeric(9,3),@P8 numeric(15,5),@P9 varchar(50),@P10 numeric(15,5),@P11 numeric(14,2),@P12 varchar(1),@P13 varchar(3),@P14 varchar(3),@P15 varchar(5),@P16 varchar(10),@P17 varchar(4),@P18 numeric(9,5),@P19 varchar(20),@P20 varchar(1),@P21 tinyint,@P22 numeric(13,10),@P23 int,@P24 varchar(50),@P25 varchar(25),@P26 numeric(14,2),@P27 numeric(14,2),@P28 numeric(14,2),@P29 varchar(15),@P30 varchar(15),@P31 numeric(14,2),@P32 numeric(13,10),@P33 smallint,@P34 numeric(14,2),@P35 numeric(14,2),@P36 numeric(14,2),@P37 varchar(1),@P38 numeric(15,5)','ATHENA CONFECÇÕES        ','1337           ','101   ','0005',1,'OS: 575364 - OP: 84220 - SOUTIEN DE BOJO EM SATINETE                            ',30.000,2.13000,'57536484220                                       ',0,63.90,'O','90 ','0  ','PÇ   ','6212.10.00','1902',0,'11401               ','1',10,20.0000000000,1029,'42256                                             ','ÆÆÆÆÆÆÆÆÆÆÆÆÆ2Ø34111     ',0,0,0,'000001         ','8007           ',0,20.0000000000,5,0,0,0,'P',2.13000
exec sp_executesql N'INSERT INTO ENTRADAS_IMPOSTO (NOME_CLIFOR,NF_ENTRADA,SERIE_NF_ENTRADA,ITEM_IMPRESSAO,SUB_ITEM_TAMANHO,AGREGA_APOS_DESCONTO,TAXA_IMPOSTO,VALOR_IMPOSTO,BASE_IMPOSTO,TAXA_IMPOSTO_ESPELHO,VALOR_IMPOSTO_ESPELHO,BASE_IMPOSTO_ESPELHO,AGREGA_APOS_ENCARGO,ID_IMPOSTO,INCIDENCIA,TAXA_IMPOSTO_CALC,VALOR_IMPOSTO_CALC,BASE_IMPOSTO_CALC) VALUES (@P1 ,@P2 ,@P3 ,@P4 ,@P5 ,@P6 ,@P7 ,@P8 ,@P9 ,@P10 ,@P11 ,@P12 ,@P13 ,@P14 ,@P15 ,@P16 ,@P17 ,@P18 )',N'@P1 varchar(25),@P2 varchar(15),@P3 varchar(6),@P4 varchar(4),@P5 int,@P6 bit,@P7 numeric(8,5),@P8 numeric(14,2),@P9 numeric(14,2),@P10 numeric(8,5),@P11 numeric(14,2),@P12 numeric(14,2),@P13 bit,@P14 tinyint,@P15 tinyint,@P16 numeric(8,5),@P17 numeric(14,2),@P18 numeric(14,2)','ATHENA CONFECÇÕES        ','1337           ','101   ','0001',1,0,0,0,0,0,0,0,0,2,1,0,0,0


select * from drvarejo.dbo.ENTRADAS_ITEM WHERE NF_ENTRADA='1337' AND SERIE_NF_ENTRADA='101'

select * from HOMOLOGACAO.dbo.ENTRADAS_ITEM WHERE NF_ENTRADA='1337' AND SERIE_NF_ENTRADA='101'

select * from PRODUCAO_ORDEM_SERVICO
WHERE NF_SAIDA='001337' AND SERIE_NF='101' 

---------------------------------------------------------
update PRODUCAO_ORDEM_SERVICO
set NF_ENTRADA='1337', SERIE_NF_ENTRADA='101', ACERTO_ENTRADA='1'
WHERE NF_SAIDA='001337' AND SERIE_NF='101'


UPDATE PRODUCAO_OS_ANTERIOR
SET PRODUCAO_OS_ANTERIOR.ITEM_IMPRESSAO=ENTRADAS_ITEM.ITEM_IMPRESSAO
FROM ENTRADAS_ITEM
JOIN PRODUCAO_OS_ANTERIOR ON PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO=SUBSTRING(ENTRADAS_ITEM.CODIGO_ITEM,1,6)
WHERE ENTRADAS_ITEM.NF_ENTRADA = '1337' AND ENTRADAS_ITEM.SERIE_NF_ENTRADA='101'

---------------------------------------------------------------


SELECT * FROM PRODUCAO_OS_ANTERIOR
WHERE ORDEM_SERVICO='575031'

UPDATE PRODUCAO_OS_ANTERIOR
SET PRODUCAO_OS_ANTERIOR.ITEM_IMPRESSAO=ENTRADAS_ITEM.ITEM_IMPRESSAO
FROM ENTRADAS_ITEM
JOIN PRODUCAO_OS_ANTERIOR ON PRODUCAO_OS_ANTERIOR.ORDEM_SERVICO=SUBSTRING(ENTRADAS_ITEM.CODIGO_ITEM,1,6)
WHERE ENTRADAS_ITEM.NF_ENTRADA = '1337' AND ENTRADAS_ITEM.SERIE_NF_ENTRADA='101'

 ORDEM_SERVICO='575031'


SELECT * FROM HOMOLOGACAO.dbo.PRODUCAO_OS_ANTERIOR
WHERE ORDEM_SERVICO='575031'






