exec sp_executesql N'
/* lx005102spk  CursorAdapter: CUR_V_ENTRADAS_00_FAT_ITENS(Alias: v_entradas_00_fat_itens)  */
SELECT FATURAMENTO_ITEM.FILIAL, FATURAMENTO_ITEM.NF_SAIDA, FATURAMENTO_ITEM.SERIE_NF, FATURAMENTO_ITEM.QTDE_RETORNAR_BENEFICIAMENTO AS QTDE_RETORNO, FATURAMENTO_ITEM.QTDE_RETORNAR_BENEFICIAMENTO AS QTDE_DISPONIVEL, CAST((FATURAMENTO_ITEM.QTDE_RETORNAR_BENEFICIAMENTO * FATURAMENTO_ITEM.MPADRAO_PRECO_UNITARIO ) AS NUMERIC(14,2)) AS VALOR_RETORNO, FATURAMENTO_ITEM.ITEM_IMPRESSAO, FATURAMENTO_ITEM.ITEM_IMPRESSAO AS ITEM, FATURAMENTO_ITEM.SUB_ITEM_TAMANHO, FATURAMENTO.EMISSAO, FATURAMENTO_ITEM.CODIGO_ITEM, FATURAMENTO_ITEM.DESCRICAO_ITEM, FATURAMENTO_ITEM.MPADRAO_PRECO_UNITARIO AS PRECO_UNITARIO, FATURAMENTO_ITEM.DESCONTO_ITEM, FATURAMENTO_ITEM.UNIDADE, FATURAMENTO_ITEM.CLASSIF_FISCAL, FATURAMENTO_ITEM.TRIBUT_ORIGEM, FATURAMENTO_ITEM.TRIBUT_ORIGEM, FATURAMENTO_ITEM.CONTA_CONTABIL, FATURAMENTO_ITEM.INDICADOR_CFOP, FATURAMENTO_ITEM.TRIBUT_ICMS, FATURAMENTO_ITEM.UNIDADE, CONVERT(DECIMAL, 1) AS FATOR_CONVERSAO_UNIDADE, DBO.FX_PRODUCAO_PRECO((CAST(DBO.FX_PRODUCAO_PRECO(FATURAMENTO_ITEM.TIMESTAMP, ''F'') AS NUMERIC(14,2)) * POWER((CASE WHEN ISNULL(FATURAMENTO.CAMBIO_NA_DATA, 0) = 0 THEN 1 ELSE FATURAMENTO.CAMBIO_NA_DATA END ), (CASE WHEN DBO.FX_PARAMETRO(''CAMBIO_NA_MOEDA_PADRAO'') = ''.F.'' THEN -1 ELSE 1 END ))), ''T'') AS TIMESTAMP, FATURAMENTO_ITEM.COMISSAO_ITEM, FATURAMENTO_ITEM.COMISSAO_ITEM_GERENTE, REPRESENTANTES.COD_REPRESENTANTE, REPRESENTANTES2.COD_REPRESENTANTE AS COD_REPRESENTANTE_GERENTE, FATURAMENTO_ITEM.REFERENCIA, FATURAMENTO_ITEM.REFERENCIA_ITEM, FATURAMENTO_ITEM.REFERENCIA_PEDIDO, TRIBUT_ICMS.DESCRICAO AS TRIBUT_ICMS_DESCRICAO, TRIBUT_ORIGEM.DESCRICAO AS TRIBUT_ORIGEM_DESCRICAO, CTB_CONTA_PLANO.DESC_CONTA, CLASSIF_FISCAL.DESC_CLASSIFICACAO, CTB_LX_INDICADOR_CFOP.DESCRICAO_INDICADOR_CFOP, FATURAMENTO.PORC_ENCARGO, FATURAMENTO.PORC_DESCONTO, CONVERT(BIT, 1) AS PORC_DESCONTO_DIGITADO, FATURAMENTO.CODIGO_LOCAL_ENTREGA, FATURAMENTO.NOME_CLIFOR_ENTREGA, FATURAMENTO.REPRESENTANTE, FATURAMENTO.GERENTE, FATURAMENTO_ITEM.FAIXA, FATURAMENTO_ITEM.COD_TABELA_FILHA, FATURAMENTO.AGRUPAMENTO_ITENS, FATURAMENTO_ITEM.CODIGO_FISCAL_OPERACAO AS CFOP, ISNULL(CASE WHEN CONVERT(INT, @P1)=241 THEN CTB_LX_NATUREZAS_OPERACAO.CFOP_RETORNO_DEVOLUCAO ELSE CTB_LX_NATUREZAS_OPERACAO.CFOP_RETORNO_SIMBOLICO END, SPACE(4)) AS CODIGO_FISCAL_OPERACAO, FATURAMENTO.NOME_CLIFOR AS TERCEIRO_SAIDA,  CAST('''' AS CHAR(15)) NATUREZA, CAST('''' AS CHAR(10)) ITEM_COMPOSICAO FROM FATURAMENTO_ITEM INNER JOIN FATURAMENTO ON FATURAMENTO_ITEM.FILIAL = FATURAMENTO.FILIAL AND FATURAMENTO_ITEM.NF_SAIDA = FATURAMENTO.NF_SAIDA AND FATURAMENTO_ITEM.SERIE_NF = FATURAMENTO.SERIE_NF INNER JOIN TRIBUT_ICMS ON FATURAMENTO_ITEM.TRIBUT_ICMS = TRIBUT_ICMS.TRIBUT_ICMS INNER JOIN CTB_LX_INDICADOR_CFOP ON FATURAMENTO_ITEM.INDICADOR_CFOP = CTB_LX_INDICADOR_CFOP.INDICADOR_CFOP INNER JOIN CLASSIF_FISCAL ON FATURAMENTO_ITEM.CLASSIF_FISCAL = CLASSIF_FISCAL.CLASSIF_FISCAL INNER JOIN TRIBUT_ORIGEM ON TRIBUT_ORIGEM.TRIBUT_ORIGEM = FATURAMENTO_ITEM.TRIBUT_ORIGEM INNER JOIN CTB_LX_NATUREZAS_OPERACAO ON CTB_LX_NATUREZAS_OPERACAO.CODIGO_FISCAL_OPERACAO = FATURAMENTO_ITEM.CODIGO_FISCAL_OPERACAO INNER JOIN NATUREZAS_SAIDAS ON FATURAMENTO.NATUREZA_SAIDA = NATUREZAS_SAIDAS.NATUREZA_SAIDA INNER JOIN CTB_LX_TIPO_OPERACAO ON NATUREZAS_SAIDAS.CTB_TIPO_OPERACAO = CTB_LX_TIPO_OPERACAO.CTB_TIPO_OPERACAO LEFT JOIN CTB_CONTA_PLANO ON FATURAMENTO_ITEM.CONTA_CONTABIL = CTB_CONTA_PLANO.CONTA_CONTABIL LEFT JOIN REPRESENTANTES ON FATURAMENTO.REPRESENTANTE = REPRESENTANTES.REPRESENTANTE LEFT JOIN REPRESENTANTES AS REPRESENTANTES2 ON FATURAMENTO.GERENTE = REPRESENTANTES2.REPRESENTANTE INNER JOIN FILIAIS ON FATURAMENTO.FILIAL = FILIAIS.FILIAL WHERE  FATURAMENTO.NOME_CLIFOR = ''CARLOS ALBERTO DA SILVA G'' AND  Ctb_lx_tipo_operacao.TIPO_OPERACAO = ''R''  AND FATURAMENTO.SERIE_NF NOT IN ( @P2, @P3 )  AND FATURAMENTO.FILIAL = ''DR VAREJO'' AND  Faturamento.nf_saida = ''0056705'' AND  Faturamento.serie_nf = ''55'' AND  Faturamento.COD_TRANSACAO IN (''FATURAMENTO_022'', ''FATURAMENTO_030'', ''FATURAMENTO_037'', ''FATURAMENTO_052'') AND FATURAMENTO_ITEM.QTDE_RETORNAR_BENEFICIAMENTO > 0',N'@P1 int,@P2 varchar(2),@P3 varchar(2)',242,'E1','E1'

select QTDE_RETORNAR_BENEFICIAMENTO,* from FATURAMENTO_ITEM
WHERE NF_SAIDA='0056705' AND SERIE_NF='55'

UPDATE FATURAMENTO_ITEM
SET QTDE_RETORNAR_BENEFICIAMENTO=QTDE_ITEM
WHERE NF_SAIDA IN ('0056705','0056704','0057623','0058692','0060522') AND SERIE_NF='55' AND QTDE_RETORNAR_BENEFICIAMENTO=0

