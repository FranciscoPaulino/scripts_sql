UPDATE MATERIAIS_CORES
SET CODIGO_EXPORTACAO=MC.CODIGO_EXPORTACAO
FROM (
SELECT ROW_NUMBER() OVER(ORDER BY MATERIAL DESC) AS ID_LINHA,
CODIGO_EXPORTACAO=REPLICATE('0',(13-LEN(ROW_NUMBER() OVER(ORDER BY MATERIAL DESC))))+CAST(ROW_NUMBER() OVER(ORDER BY MATERIAL DESC) AS CHAR(10)),
MATERIAL,COR_MATERIAL 
FROM MATERIAIS_CORES
) AS MC
WHERE MATERIAIS_CORES.MATERIAL=MC.MATERIAL AND MATERIAIS_CORES.COR_MATERIAL=MC.COR_MATERIAL




SELECT * 
FROM MATERIAIS_CORES
ORDER BY CODIGO_EXPORTACAO


UPDATE SEQUENCIAIS
SET SEQUENCIA='0000000028006'
WHERE TABELA_COLUNA ='MATERIAIS_CORES.CODIGO_EXPORTACAO'


INSERT INTO DRLINKEDSERVER.DRLINGERIE.DBO.SEQUENCIAIS (TABELA_COLUNA,DESCRICAO,SEQUENCIA,TAMANHO)
SELECT TABELA_COLUNA,DESCRICAO,SEQUENCIA,TAMANHO FROM SEQUENCIAIS WHERE TABELA_COLUNA='MATERIAIS_CORES.CODIGO_EXPORTACAO'




SELECT CODIGO_EXPORTACAO,COUNT(*) FROM MATERIAIS_CORES
GROUP BY CODIGO_EXPORTACAO
HAVING COUNT(*)>1


SELECT * FROM MATERIAIS_CORES
WHERE CODIGO_EXPORTACAO IN(
'0000000031302',
'0000000031078',
'0000000030217',
'0000000031164',
'0000000030601',
'0000000028550',
'0000000029537',
'0000000029125',
'0000000028889',
'0000000029150',
'0000000029818',
'0000000031196',
'0000000030025',
'0000000030044',
'0000000028600',
'0000000030049',
'0000000029419',
'0000000029807',
'0000000029399',
'0000000031033',
'0000000028102',
'0000000029266',
'0000000028188',
'0000000029171',
'0000000029505',
'0000000003876',
'0000000029198',
'0000000030616',
'0000000028304',
'0000000030459',
'0000000028520',
'0000000032111',
'0000000031474',
'0000000029290',
'0000000029137',
'0000000028265',
'0000000031009',
'0000000028303',
'0000000008166',     
'0000000029189',
'0000000031190',
'0000000030027',
'0000000031222',
'0000000029868',
'0000000030215',
'0000000030627',
'0000000028784',
'0000000030445',
'0000000003903',
'0000000029139',
'0000000029900',
'0000000029363',
'0000000030104',
'0000000029306',
'0000000029566',
'0000000028605',
'0000000029190',
'0000000029938',
'0000000029766',
'0000000031247',
'0000000030460',
'0000000029617',
'0000000030057',
'0000000030643',
'0000000029961',
'0000000029916',
'0000000031483',
'0000000029276',
'0000000030452',
'0000000030105',
'0000000028624',
'0000000028748',
'0000000029663',
'0000000031259',
'0000000029960',
'0000000029221',
'0000000029087',
'0000000029252',
'0000000029247',
'0000000029713',
'0000000029557',
'0000000029601',
'0000000028519',
'0000000031108',
'0000000028190',
'0000000003881',
'0000000029311',
'0000000029151',
'0000000029884',
'0000000029552',
'0000000030269',
'0000000029098',
'0000000029112',
'0000000031071',
'0000000031092',
'0000000031208',
'0000000031235',
'0000000030457',
'0000000029862',
'0000000030237',
'0000000028556',
'0000000031135',
'0000000029074',
'0000000029876',
'0000000030617',
'0000000031074',
'0000000029597',
'0000000030567',
'0000000029763',
'0000000003900',
'0000000029800',
'0000000030463',
'0000000029879',
'0000000029563',
'0000000031475',
'0000000029924',
'0000000029187',
'0000000003882',
'0000000029665',
'0000000031032',
'0000000029838',
'0000000029841',
'0000000005894',
'0000000029647',
'0000000029124',
'0000000028244',
'0000000030642',
'0000000028992',
'0000000030228',
'0000000029387',
'0000000029315',
'0000000031482',
'0000000030626',
'0000000029191',
'0000000030444',
'0000000029975',
'0000000028623',
'0000000030585',
'0000000031258',
'0000000028257',
'0000000029894',
'0000000030453',
'0000000030089',
'0000000030247',
'0000000030961',
'0000000032123',
'0000000029138',
'0000000030239',
'0000000031234',
'0000000029883',
'0000000029974',
'0000000031294',
'0000000029099',
'0000000029113',
'0000000031086',
'0000000029917',
'0000000029514',
'0000000029528',
'0000000031090',
'0000000031471',
'0000000031057',
'0000000029517',
'0000000028183',
'0000000028548',
'0000000029501',
'0000000029796',
'0000000031091',
'0000000030079',
'0000000028579',
'0000000029954',
'0000000029101',
'0000000029604',
'0000000028745',
'0000000029289',
'0000000029947',
'0000000030462',
'0000000031174',
'0000000028180',
'0000000031123',
'0000000003854',
'0000000031422',
'0000000029764',
'0000000008167',     
'0000000030097',
'0000000031274',
'0000000028238',
'0000000029254',
'0000000032117',
'0000000030092',
'0000000031093',
'0000000003921',
'0000000031020',
'0000000031007',
'0000000029051',
'0000000031178',
'0000000029499',
'0000000030645',
'0000000003893',
'0000000029811',
'0000000031107',
'0000000029560',
'0000000030194',
'0000000031220',
'0000000029219',
'0000000028640',
'0000000028514',
'0000000030241',
'0000000029040',
'0000000029381',
'0000000029751',
'0000000028010',
'0000000028267',
'0000000031233',
'0000000030658',
'0000000029062',
'0000000028607',
'0000000031275',
'0000000032106',
'0000000031162',
'0000000030603',
'0000000029845',
'0000000030405',
'0000000032115',
'0000000014372',     
'0000000029612',
'0000000029540',
'0000000029937',
'0000000028602',
'0000000029902',
'0000000029331',
'0000000029240',
'0000000029307',
'0000000030096',
'0000000029912',
'0000000031246',
'0000000030101',
'0000000030461',
'0000000028429',
'0000000029569',
'0000000031221',
'0000000031479',
'0000000031106',
'0000000029946',
'0000000029977',
'0000000030447',
'0000000029531',
'0000000028055',
'0000000031273',
'0000000029759',
'0000000029962',
'0000000030584',
'0000000028040',
'0000000028606',
'0000000031421',
'0000000029765',
'0000000029304',
'0000000029073',
'0000000031109',
'0000000031179',
'0000000029088',
'0000000029957',
'0000000030644',
'0000000029915',
'0000000032125',
'0000000029633',
'0000000003631',
'0000000029703',
'0000000030170',
'0000000030587',
'0000000029278',
'0000000029885',
'0000000029976',
'0000000029872',
'0000000029253',
'0000000030455',
'0000000030187',
'0000000029250',
'0000000030659',
'0000000029623',
'0000000029882',
'0000000031005',
'0000000030172',
'0000000030409',
'0000000029277',
'0000000029863',
'0000000029043',
'0000000029384',
'0000000029864',
'0000000030566',
'0000000028518',
'0000000029525',
'0000000031134',
'0000000029745',
'0000000029410',
'0000000030100',
'0000000029061',
'0000000029161',
'0000000029771',
'0000000028549',
'0000000003850',
'0000000029897',
'0000000028601',
'0000000029901',
'0000000029925',
'0000000029149',
'0000000029673',
'0000000029218',
'0000000028874',
'0000000029407',
'0000000008169',     
'0000000030600',
'0000000029536',
'0000000029717',
'0000000029855',
'0000000031122',
'0000000028747',
'0000000029167',
'0000000031163',
'0000000030088',
'0000000031180',
'0000000028269',
'0000000031146',
'0000000004492',
'0000000028210',
'0000000031058',
'0000000031470',
'0000000003923',
'0000000031081',
'0000000030268',
'0000000030408',
'0000000028264',
'0000000028604',
'0000000030045',
'0000000031045',
'0000000031396',
'0000000029639',
'0000000029803',
'0000000030078',
'0000000029709',
'0000000003872',     
'0000000029610',
'0000000029202',
'0000000029333',
'0000000030284',
'0000000030259',
'0000000029188',
'0000000031034',
'0000000029063',
'0000000029288',
'0000000032119',
'0000000029050',
'0000000030230',
'0000000008168',     
'0000000003890',
'0000000031209',
'0000000032107',
'0000000029680',
'0000000029075',
'0000000029945',
'0000000030093',
'0000000029936',
'0000000030959',
'0000000003913',
'0000000028603',
'0000000029699',
'0000000030660',
'0000000029265',
'0000000005893',
'0000000028200',
'0000000029643',
'0000000029933',
'0000000031257',
'0000000029611',
'0000000028302',
'0000000029628',
'0000000029903',
'0000000028751',
'0000000003910',     
'0000000031046',
'0000000028517',
'0000000028619',
'0000000029264',
'0000000029521',
'0000000031269',
'0000000029383',
'0000000029609',
'0000000029404',
'0000000031466',
'0000000028754',
'0000000032120',
'0000000029163',
'0000000028551',
'0000000029126',
'0000000005895',
'0000000031465',
'0000000029100',
'0000000029186',
'0000000030628',
'0000000028276',
'0000000029963',
'0000000029664',
'0000000031478',
'0000000029086',
'0000000029683',
'0000000030602',
'0000000030219',
'0000000029114',
'0000000030277',
'0000000030235',
'0000000029220',
'0000000031056',
'0000000030586',
'0000000029834',
'0000000029655',
'0000000030629',
'0000000029851',
'0000000029669',
'0000000031195',
'0000000029513',
'0000000030050',
'0000000028627',
'0000000028039',
'0000000029723',
'0000000029792',
'0000000029420',
'0000000031194',
'0000000029175',
'0000000028266',
'0000000032112',
'0000000031395',
'0000000029986',
'0000000003898',
'0000000031245',
'0000000031210',
'0000000030624',
'0000000030458',
'0000000029926',
'0000000029692')
ORDER BY CODIGO_EXPORTACAO




UPDATE MATERIAIS_CORES
SET CODIGO_EXPORTACAO=NULL
WHERE CODIGO_EXPORTACAO IN(
'0000000031302',
'0000000031078',
'0000000030217',
'0000000031164',
'0000000030601',
'0000000028550',
'0000000029537',
'0000000029125',
'0000000028889',
'0000000029150',
'0000000029818',
'0000000031196',
'0000000030025',
'0000000030044',
'0000000028600',
'0000000030049',
'0000000029419',
'0000000029807',
'0000000029399',
'0000000031033',
'0000000028102',
'0000000029266',
'0000000028188',
'0000000029171',
'0000000029505',
'0000000003876',
'0000000029198',
'0000000030616',
'0000000028304',
'0000000030459',
'0000000028520',
'0000000032111',
'0000000031474',
'0000000029290',
'0000000029137',
'0000000028265',
'0000000031009',
'0000000028303',
'0000000008166',     
'0000000029189',
'0000000031190',
'0000000030027',
'0000000031222',
'0000000029868',
'0000000030215',
'0000000030627',
'0000000028784',
'0000000030445',
'0000000003903',
'0000000029139',
'0000000029900',
'0000000029363',
'0000000030104',
'0000000029306',
'0000000029566',
'0000000028605',
'0000000029190',
'0000000029938',
'0000000029766',
'0000000031247',
'0000000030460',
'0000000029617',
'0000000030057',
'0000000030643',
'0000000029961',
'0000000029916',
'0000000031483',
'0000000029276',
'0000000030452',
'0000000030105',
'0000000028624',
'0000000028748',
'0000000029663',
'0000000031259',
'0000000029960',
'0000000029221',
'0000000029087',
'0000000029252',
'0000000029247',
'0000000029713',
'0000000029557',
'0000000029601',
'0000000028519',
'0000000031108',
'0000000028190',
'0000000003881',
'0000000029311',
'0000000029151',
'0000000029884',
'0000000029552',
'0000000030269',
'0000000029098',
'0000000029112',
'0000000031071',
'0000000031092',
'0000000031208',
'0000000031235',
'0000000030457',
'0000000029862',
'0000000030237',
'0000000028556',
'0000000031135',
'0000000029074',
'0000000029876',
'0000000030617',
'0000000031074',
'0000000029597',
'0000000030567',
'0000000029763',
'0000000003900',
'0000000029800',
'0000000030463',
'0000000029879',
'0000000029563',
'0000000031475',
'0000000029924',
'0000000029187',
'0000000003882',
'0000000029665',
'0000000031032',
'0000000029838',
'0000000029841',
'0000000005894',
'0000000029647',
'0000000029124',
'0000000028244',
'0000000030642',
'0000000028992',
'0000000030228',
'0000000029387',
'0000000029315',
'0000000031482',
'0000000030626',
'0000000029191',
'0000000030444',
'0000000029975',
'0000000028623',
'0000000030585',
'0000000031258',
'0000000028257',
'0000000029894',
'0000000030453',
'0000000030089',
'0000000030247',
'0000000030961',
'0000000032123',
'0000000029138',
'0000000030239',
'0000000031234',
'0000000029883',
'0000000029974',
'0000000031294',
'0000000029099',
'0000000029113',
'0000000031086',
'0000000029917',
'0000000029514',
'0000000029528',
'0000000031090',
'0000000031471',
'0000000031057',
'0000000029517',
'0000000028183',
'0000000028548',
'0000000029501',
'0000000029796',
'0000000031091',
'0000000030079',
'0000000028579',
'0000000029954',
'0000000029101',
'0000000029604',
'0000000028745',
'0000000029289',
'0000000029947',
'0000000030462',
'0000000031174',
'0000000028180',
'0000000031123',
'0000000003854',
'0000000031422',
'0000000029764',
'0000000008167',     
'0000000030097',
'0000000031274',
'0000000028238',
'0000000029254',
'0000000032117',
'0000000030092',
'0000000031093',
'0000000003921',
'0000000031020',
'0000000031007',
'0000000029051',
'0000000031178',
'0000000029499',
'0000000030645',
'0000000003893',
'0000000029811',
'0000000031107',
'0000000029560',
'0000000030194',
'0000000031220',
'0000000029219',
'0000000028640',
'0000000028514',
'0000000030241',
'0000000029040',
'0000000029381',
'0000000029751',
'0000000028010',
'0000000028267',
'0000000031233',
'0000000030658',
'0000000029062',
'0000000028607',
'0000000031275',
'0000000032106',
'0000000031162',
'0000000030603',
'0000000029845',
'0000000030405',
'0000000032115',
'0000000014372',     
'0000000029612',
'0000000029540',
'0000000029937',
'0000000028602',
'0000000029902',
'0000000029331',
'0000000029240',
'0000000029307',
'0000000030096',
'0000000029912',
'0000000031246',
'0000000030101',
'0000000030461',
'0000000028429',
'0000000029569',
'0000000031221',
'0000000031479',
'0000000031106',
'0000000029946',
'0000000029977',
'0000000030447',
'0000000029531',
'0000000028055',
'0000000031273',
'0000000029759',
'0000000029962',
'0000000030584',
'0000000028040',
'0000000028606',
'0000000031421',
'0000000029765',
'0000000029304',
'0000000029073',
'0000000031109',
'0000000031179',
'0000000029088',
'0000000029957',
'0000000030644',
'0000000029915',
'0000000032125',
'0000000029633',
'0000000003631',
'0000000029703',
'0000000030170',
'0000000030587',
'0000000029278',
'0000000029885',
'0000000029976',
'0000000029872',
'0000000029253',
'0000000030455',
'0000000030187',
'0000000029250',
'0000000030659',
'0000000029623',
'0000000029882',
'0000000031005',
'0000000030172',
'0000000030409',
'0000000029277',
'0000000029863',
'0000000029043',
'0000000029384',
'0000000029864',
'0000000030566',
'0000000028518',
'0000000029525',
'0000000031134',
'0000000029745',
'0000000029410',
'0000000030100',
'0000000029061',
'0000000029161',
'0000000029771',
'0000000028549',
'0000000003850',
'0000000029897',
'0000000028601',
'0000000029901',
'0000000029925',
'0000000029149',
'0000000029673',
'0000000029218',
'0000000028874',
'0000000029407',
'0000000008169',     
'0000000030600',
'0000000029536',
'0000000029717',
'0000000029855',
'0000000031122',
'0000000028747',
'0000000029167',
'0000000031163',
'0000000030088',
'0000000031180',
'0000000028269',
'0000000031146',
'0000000004492',
'0000000028210',
'0000000031058',
'0000000031470',
'0000000003923',
'0000000031081',
'0000000030268',
'0000000030408',
'0000000028264',
'0000000028604',
'0000000030045',
'0000000031045',
'0000000031396',
'0000000029639',
'0000000029803',
'0000000030078',
'0000000029709',
'0000000003872',     
'0000000029610',
'0000000029202',
'0000000029333',
'0000000030284',
'0000000030259',
'0000000029188',
'0000000031034',
'0000000029063',
'0000000029288',
'0000000032119',
'0000000029050',
'0000000030230',
'0000000008168',     
'0000000003890',
'0000000031209',
'0000000032107',
'0000000029680',
'0000000029075',
'0000000029945',
'0000000030093',
'0000000029936',
'0000000030959',
'0000000003913',
'0000000028603',
'0000000029699',
'0000000030660',
'0000000029265',
'0000000005893',
'0000000028200',
'0000000029643',
'0000000029933',
'0000000031257',
'0000000029611',
'0000000028302',
'0000000029628',
'0000000029903',
'0000000028751',
'0000000003910',     
'0000000031046',
'0000000028517',
'0000000028619',
'0000000029264',
'0000000029521',
'0000000031269',
'0000000029383',
'0000000029609',
'0000000029404',
'0000000031466',
'0000000028754',
'0000000032120',
'0000000029163',
'0000000028551',
'0000000029126',
'0000000005895',
'0000000031465',
'0000000029100',
'0000000029186',
'0000000030628',
'0000000028276',
'0000000029963',
'0000000029664',
'0000000031478',
'0000000029086',
'0000000029683',
'0000000030602',
'0000000030219',
'0000000029114',
'0000000030277',
'0000000030235',
'0000000029220',
'0000000031056',
'0000000030586',
'0000000029834',
'0000000029655',
'0000000030629',
'0000000029851',
'0000000029669',
'0000000031195',
'0000000029513',
'0000000030050',
'0000000028627',
'0000000028039',
'0000000029723',
'0000000029792',
'0000000029420',
'0000000031194',
'0000000029175',
'0000000028266',
'0000000032112',
'0000000031395',
'0000000029986',
'0000000003898',
'0000000031245',
'0000000031210',
'0000000030624',
'0000000030458',
'0000000029926',
'0000000029692')


BEGIN TRAN
COMMIT

UPDATE MATERIAIS_CORES
SET CODIGO_EXPORTACAO=MC.CODIGO_EXPORTACAO
FROM (
SELECT CODIGO_EXPORTACAO=REPLICATE('0',(13-LEN(CAST('0000000032126' AS INT)+ROW_NUMBER() OVER(ORDER BY MATERIAL))))+CAST(CAST('0000000032126' AS INT)+ROW_NUMBER() OVER(ORDER BY MATERIAL) AS CHAR(10)),
MATERIAL,COR_MATERIAL 
FROM MATERIAIS_CORES WHERE CODIGO_EXPORTACAO IS NULL
) AS MC
WHERE MATERIAIS_CORES.MATERIAL=MC.MATERIAL AND MATERIAIS_CORES.COR_MATERIAL=MC.COR_MATERIAL




FROM (
SELECT CODIGO_EXPORTACAO=REPLICATE('0',(13-LEN(CAST('0000000022338' AS INT)+ROW_NUMBER() OVER(ORDER BY MATERIAL))))+CAST(CAST('0000000022338' AS INT)+ROW_NUMBER() OVER(ORDER BY MATERIAL) AS CHAR(10)),
MATERIAL,COR_MATERIAL 
FROM MATERIAIS_CORES WHERE CODIGO_EXPORTACAO IS NULL
) AS MC
WHERE MATERIAIS_CORES.MATERIAL=MC.MATERIAL AND MATERIAIS_CORES.COR_MATERIAL=MC.COR_MATERIAL


SELECT MAX(CODIGO_EXPORTACAO) FROM MATERIAIS_CORES


UPDATE SEQUENCIAIS
SET SEQUENCIA='0000000034237'
WHERE TABELA_COLUNA='MATERIAIS_CORES.CODIGO_EXPORTACAO'

SELECT * FROM SEQUENCIAIS
WHERE TABELA_COLUNA='MATERIAIS_CORES.CODIGO_EXPORTACAO'
