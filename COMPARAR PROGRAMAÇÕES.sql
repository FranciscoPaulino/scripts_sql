
SELECT * FROM (
SELECT 'PRIMEIRA' AS COMPARAR,PROGRAMACAO,
PRODUTO,
COR_PRODUTO,
ENTREGA_INICIAL,
QTDE_PROGRAMADA,
QTDE_GERADA,
ENTREGA_FINAL
P1,
P2,
P3,
P4,
P5,
P6,
P7,
P8,
P9,
P10,
P11,
P12,
P13,
P14,
P15,
P16,
S1,
S2,
S3,
S4,
S5,
S6,
S7,
S8,
S9,
S10,
S11,
S12,
S13,
S14,
S15,
S16
FROM PRODUCAO_PROG_PROD
WHERE PROGRAMACAO='NEC ATE 25 01 JULIETE EM'

UNION ALL

SELECT 'SEGUNDA',PROGRAMACAO,
PRODUTO,
COR_PRODUTO,
ENTREGA_INICIAL,
QTDE_PROGRAMADA,
QTDE_GERADA,
ENTREGA_FINAL,
P1,
P2,
P3,
P4,
P5,
P6,
P7,
P8,
P9,
P10,
P11,
P12,
P13,
P14,
P15,
P16,
S1,
S2,
S3,
S4,
S5,
S6,
S7,
S8,
S9,
S10,
S11,
S12,
S13,
S14,
S15,
S16
FROM PRODUCAO_PROG_PROD
WHERE PROGRAMACAO='NEC ATÉ 2ª SEM AGOSTO 476'
) AS PROGRAMACAO_FINAL



select * from VENDAS_PRODUTO
where PRODUTO='57363' and COR_PRODUTO='nn315'



SELECT 'SEGUNDA' AS ORDEM,PROGRAMACAO,
PRODUTO,
COR_PRODUTO,
ENTREGA_INICIAL,
QTDE_PROGRAMADA,
QTDE_GERADA,
ENTREGA_FINAL,
P1,
P2,
P3,
P4,
P5,
P6,
P7,
P8,
P9,
P10,
P11,
P12,
P13,
P14,
P15,
P16
FROM PRODUCAO_PROG_PROD S
WHERE PROGRAMACAO='FURO 25JAN EM 27JAN' AND 
NOT EXISTS (SELECT 'PRIMEIRA' AS ORDEM,PROGRAMACAO,
PRODUTO,
COR_PRODUTO,
ENTREGA_INICIAL,
QTDE_PROGRAMADA,
QTDE_GERADA,
ENTREGA_FINAL,
P1,
P2,
P3,
P4,
P5,
P6,
P7,
P8,
P9,
P10,
P11,
P12,
P13,
P14,
P15,
P16
FROM PRODUCAO_PROG_PROD P
WHERE P.PROGRAMACAO='NEC ATÉ 2ª SEM AGOSTO 476' 
AND P.PRODUTO=S.PRODUTO
AND P.COR_PRODUTO=S.COR_PRODUTO 
AND P.QTDE_PROGRAMADA=S.QTDE_PROGRAMADA 
)


SP_HELP PRODUCAO_PROG_PROD




SELECT PRODUTOS.GRADE,PRIMEIRO_PRODUTO=PRIMEIRA.PRODUTO,PRIMEIRO_COR_PRODUTO=PRIMEIRA.COR_PRODUTO,
O1=ISNULL(PRIMEIRA.O1,0),O2=ISNULL(PRIMEIRA.O2,0),O3=ISNULL(PRIMEIRA.O3,0),O4=ISNULL(PRIMEIRA.O4,0),
O5=ISNULL(PRIMEIRA.O5,0),O6=ISNULL(PRIMEIRA.O6,0),O7=ISNULL(PRIMEIRA.O7,0),O8=ISNULL(PRIMEIRA.O8,0),
O9=ISNULL(PRIMEIRA.O9,0),O10=ISNULL(PRIMEIRA.O10,0),O11=ISNULL(PRIMEIRA.O11,0),O12=ISNULL(PRIMEIRA.O12,0),
O13=ISNULL(PRIMEIRA.O13,0),O14=ISNULL(PRIMEIRA.O14,0),O15=ISNULL(PRIMEIRA.O15,0),O16=ISNULL(PRIMEIRA.O16,0),
QTDE_ORIGINAL=ISNULL(PRIMEIRA.QTDE_PROGRAMADA,0),
SEGUNDA.*,
D1=ISNULL(SEGUNDA.P1,0)-ISNULL(PRIMEIRA.P1,0), 
D2=ISNULL(SEGUNDA.P2,0)-ISNULL(PRIMEIRA.P2,0), 
D3=ISNULL(SEGUNDA.P3,0)-ISNULL(PRIMEIRA.P3,0), 
D4=ISNULL(SEGUNDA.P4,0)-ISNULL(PRIMEIRA.P4,0), 
D5=ISNULL(SEGUNDA.P5,0)-ISNULL(PRIMEIRA.P5,0), 
D6=ISNULL(SEGUNDA.P6,0)-ISNULL(PRIMEIRA.P6,0), 
D7=ISNULL(SEGUNDA.P7,0)-ISNULL(PRIMEIRA.P7,0), 
D8=ISNULL(SEGUNDA.P8,0)-ISNULL(PRIMEIRA.P8,0), 
D9=ISNULL(SEGUNDA.P9,0)-ISNULL(PRIMEIRA.P9,0), 
D10=ISNULL(SEGUNDA.P10,0)-ISNULL(PRIMEIRA.P10,0), 
D11=ISNULL(SEGUNDA.P11,0)-ISNULL(PRIMEIRA.P11,0), 
D12=ISNULL(SEGUNDA.P12,0)-ISNULL(PRIMEIRA.P12,0), 
D13=ISNULL(SEGUNDA.P13,0)-ISNULL(PRIMEIRA.P13,0), 
D14=ISNULL(SEGUNDA.P14,0)-ISNULL(PRIMEIRA.P14,0), 
D15=ISNULL(SEGUNDA.P15,0)-ISNULL(PRIMEIRA.P15,0), 
D16=ISNULL(SEGUNDA.P16,0)-ISNULL(PRIMEIRA.P16,0), 
QTDE_DIFERENCA=
ISNULL(SEGUNDA.P1,0)-ISNULL(PRIMEIRA.P1,0)+ 
ISNULL(SEGUNDA.P2,0)-ISNULL(PRIMEIRA.P2,0)+ 
ISNULL(SEGUNDA.P3,0)-ISNULL(PRIMEIRA.P3,0)+ 
ISNULL(SEGUNDA.P4,0)-ISNULL(PRIMEIRA.P4,0)+ 
ISNULL(SEGUNDA.P5,0)-ISNULL(PRIMEIRA.P5,0)+ 
ISNULL(SEGUNDA.P6,0)-ISNULL(PRIMEIRA.P6,0)+ 
ISNULL(SEGUNDA.P7,0)-ISNULL(PRIMEIRA.P7,0)+ 
ISNULL(SEGUNDA.P8,0)-ISNULL(PRIMEIRA.P8,0)+ 
ISNULL(SEGUNDA.P9,0)-ISNULL(PRIMEIRA.P9,0)+ 
ISNULL(SEGUNDA.P10,0)-ISNULL(PRIMEIRA.P10,0)+ 
ISNULL(SEGUNDA.P11,0)-ISNULL(PRIMEIRA.P11,0)+ 
ISNULL(SEGUNDA.P12,0)-ISNULL(PRIMEIRA.P12,0)+ 
ISNULL(SEGUNDA.P13,0)-ISNULL(PRIMEIRA.P13,0)+ 
ISNULL(SEGUNDA.P14,0)-ISNULL(PRIMEIRA.P14,0)+ 
ISNULL(SEGUNDA.P15,0)-ISNULL(PRIMEIRA.P15,0)+ 
ISNULL(SEGUNDA.P16,0)-ISNULL(PRIMEIRA.P16,0) 
FROM (SELECT 'PRIMEIRA' AS COMPARAR,PROGRAMACAO,
PRODUTO,COR_PRODUTO,ENTREGA_INICIAL,QTDE_PROGRAMADA,QTDE_GERADA,
ENTREGA_FINAL,O1=P1,O2=P2,O3=P3,O4=P4,O5=P5,O6=P6,O7=P7,O8=P8,O9=P9,
O10=P10,O11=P11,O12=P12,O13=P13,O14=P14,O15=P15,O16=P16,
P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16
FROM PRODUCAO_PROG_PROD
WHERE PROGRAMACAO='NEC ATE 25 01 JULIETE EM'
) AS PRIMEIRA
RIGHT JOIN 
(SELECT 'SEGUNDA' AS COMPARAR,PROGRAMACAO,
PRODUTO,COR_PRODUTO,ENTREGA_INICIAL,QTDE_PROGRAMADA,QTDE_GERADA,
ENTREGA_FINAL,P1,P2,P3,P4,P5,P6,P7,P8,P9,P10,P11,P12,P13,P14,P15,P16
FROM PRODUCAO_PROG_PROD
WHERE PROGRAMACAO='NEC ATÉ 2ª SEM AGOSTO 476'
) AS SEGUNDA ON SEGUNDA.PRODUTO=PRIMEIRA.PRODUTO AND SEGUNDA.COR_PRODUTO=PRIMEIRA.COR_PRODUTO 
JOIN PRODUTOS ON PRODUTOS.PRODUTO=SEGUNDA.PRODUTO 
WHERE ISNULL(SEGUNDA.P1,0)-ISNULL(PRIMEIRA.P1,0)+ 
ISNULL(SEGUNDA.P2,0)-ISNULL(PRIMEIRA.P2,0)+ 
ISNULL(SEGUNDA.P3,0)-ISNULL(PRIMEIRA.P3,0)+ 
ISNULL(SEGUNDA.P4,0)-ISNULL(PRIMEIRA.P4,0)+ 
ISNULL(SEGUNDA.P5,0)-ISNULL(PRIMEIRA.P5,0)+ 
ISNULL(SEGUNDA.P6,0)-ISNULL(PRIMEIRA.P6,0)+ 
ISNULL(SEGUNDA.P7,0)-ISNULL(PRIMEIRA.P7,0)+ 
ISNULL(SEGUNDA.P8,0)-ISNULL(PRIMEIRA.P8,0)+ 
ISNULL(SEGUNDA.P9,0)-ISNULL(PRIMEIRA.P9,0)+ 
ISNULL(SEGUNDA.P10,0)-ISNULL(PRIMEIRA.P10,0)+ 
ISNULL(SEGUNDA.P11,0)-ISNULL(PRIMEIRA.P11,0)+ 
ISNULL(SEGUNDA.P12,0)-ISNULL(PRIMEIRA.P12,0)+ 
ISNULL(SEGUNDA.P13,0)-ISNULL(PRIMEIRA.P13,0)+ 
ISNULL(SEGUNDA.P14,0)-ISNULL(PRIMEIRA.P14,0)+ 
ISNULL(SEGUNDA.P15,0)-ISNULL(PRIMEIRA.P15,0)+ 
ISNULL(SEGUNDA.P16,0)-ISNULL(PRIMEIRA.P16,0) <> 0 
