select * from PRODUTOS_PRECOS
WHERE CODIGO_TAB_PRECO='LO' AND 
NOT EXISTS(
SELECT * FROM PRODUTOS
WHERE PRODUTO IN(
'V40667',
'V42667',
'V45656',
'V42656',
'V42515.1',
'V42515',
'V45574',
'V45520',
'V42253',
'V45253',
'V45160',
'V40164',
'V42659',
'V40659',
'V41502',
'V45502',
'V40572',
'V42572',
'V1233',
'V42903.1',
'V41903.1',
'V40903',
'V47902.1',
'V42574',
'V4250',
'VSL12401',
'VBX12401',
'VBX12404',
'VSL12404',
'VSL12408',
'VSG12408',
'VSG10401',
'VBX10401',
'VSG10402',
'VBX10402',
'VSG10404',
'VBX10404',
'V51356K5',
'V51356K6',
'V51356K7',
'V51356K8',
'V45554',
'V45554.1',
'V51554',
'V52667',
'V51667',
'V57656',
'V51656',
'V52515',
'V51515',
'V54574',
'V51520',
'V51253',
'V52253',
'V51160',
'V52164',
'V52659',
'V51659',
'V54502',
'V57502',
'V50572',
'V51572',
'V2084',
'V51903',
'V57903.1',
'V52903.1',
'V52902',
'V51574',
'V5250'
)
)




DROP TABLE #PRODUTOS_LOJINHA_PRECO
/* Criando a tabela com os meus atributos da planilha */
create table #PRODUTOS_LOJINHA_PRECO(
PRODUTO varchar(15),    PRECO NUMERIC(14,2)
)


/* Comando para importar a planilha na tabela */

INSERT INTO #PRODUTOS_LOJINHA_PRECO (PRODUTO,PRECO)
SELECT  F1,CONVERT(NUMERIC(14,2),F2)
FROM OPENROWSET ('Microsoft.Ace.OLEDB.12.0'
,'Excel 12.0; Database=c:\temp\PRODUTOS_LOJINHA_PRECO.XLSx; Extended Properties=''EXCEL 12.0;HDR=NO;IMEX=1'
,'SELECT * FROM [Tabela de preços$]')


-- PREÇO DIFERENTE
SELECT B.PRODUTO,PRECO_LINX=B.PRECO1,PRECO_PLANILHA=A.PRECO FROM #PRODUTOS_LOJINHA_PRECO A
JOIN PRODUTOS_PRECOS B ON B.PRODUTO=A.PRODUTO COLLATE Latin1_General_CI_AS 
WHERE B.CODIGO_TAB_PRECO='LO' AND B.PRECO1<>A.PRECO


-- NÃO EXISTE NA TABELA DE PREÇOS
SELECT * FROM #PRODUTOS_LOJINHA_PRECO A
WHERE EXISTS(SELECT * FROM PRODUTOS_PRECOS WHERE PRODUTO=A.PRODUTO COLLATE SQL_Latin1_General_CP1_CI_AS )



